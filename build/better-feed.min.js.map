{"version":3,"sources":["webpack:///better-feed.min.js","webpack:///webpack/bootstrap 089771b078c4b9b6ee91","webpack:///./src/js/better-feed.js","webpack:///./src/styles/common.less?7c5a","webpack:///./src/styles/common.less","webpack:///./~/css-loader/lib/css-base.js","webpack:///./src/styles/fa-exchange.svg","webpack:///./~/style-loader/addStyles.js","webpack:///./src/js/base/modules.js","webpack:///./src/js/utils/for-select.js","webpack:///./src/js/utils/matches.js","webpack:///./src/js/utils/current-user-id.js","webpack:///./src/js/utils/i-am.js","webpack:///./src/js/utils/api.js","webpack:///./src/js/utils/userpics.js","webpack:///./src/js/utils/bf-root.js","webpack:///./src/styles/default-userpic-50.png","webpack:///./src/js/utils/html.js","webpack:///./src/js/utils/is-array.js","webpack:///./src/js/utils/html-tpl.js","webpack:///./src/js/utils/escape-html.js","webpack:///./src/js/utils/doc-loaded.js","webpack:///./src/js/base/settings.js","webpack:///./src/js/utils/message-rpc.js","webpack:///./src/js/modules/common.js","webpack:///./src/js/utils/closest-parent.js","webpack:///./src/js/utils/on-history.js","webpack:///./src/js/modules/settings-link.js","webpack:///./src/js/utils/lightbox.js","webpack:///./src/js/modules/moon.js","webpack:///./src/js/modules/switch-accounts.js","webpack:///./src/js/utils/cross-local-storage.js","webpack:///./src/js/modules/no-read-more.js","webpack:///./src/js/modules/comment-clouds.js","webpack:///./src/styles/comment-clouds.less?f7f7","webpack:///./src/styles/comment-clouds.less","webpack:///./src/js/modules/hide-arabic.js","webpack:///./src/js/modules/hanging-punct.js","webpack:///./src/js/utils/text-walk.js","webpack:///./src/js/modules/show-timestamps.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_asyncToGenerator","fn","gen","apply","this","arguments","Promise","resolve","reject","step","key","arg","info","value","error","done","then","err","start","settings","_this","_modules","startObserver","msg","Messenger","on","toJSON","_ref3","regeneratorRuntime","mark","_callee","o","iAm","wrap","_context","prev","next","IAm","ready","sent","saveProps","Settings","location","reload","stop","_x","checkUpdates","now","Date","oldVersion","localStorage","xhr","XMLHttpRequest","open","responseType","onload","tags","response","length","newVersion","confirm","alert","e","send","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","push","Array","isArray","Object","TypeError","_currentUserId","_iAm","_iAm2","_docLoaded","_docLoaded2","_settings","_settings2","_messageRpc","_messageRpc2","test","pathname","MutationObserver","userId","console","window","warn","__BetterFeed","all","docLoaded","_ref","_ref2","bf2Props","content","locals","list","toString","result","item","join","mediaQuery","alreadyImportedModules","addStylesToDom","styles","options","domStyle","stylesInDom","refs","j","parts","addStyle","listToStyles","newStyles","css","media","sourceMap","part","insertStyleElement","styleElement","head","getHeadElement","lastStyleElementInsertedAtTop","styleElementsInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","Error","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","document","createElement","type","createLinkElement","linkElement","rel","update","remove","singleton","styleIndex","singletonCounter","singletonElement","applyToSingletonTag","bind","URL","createObjectURL","revokeObjectURL","Blob","btoa","updateLink","href","applyToTag","newObj","index","styleSheet","cssText","replaceText","cssNode","createTextNode","childNodes","setAttribute","unescape","encodeURIComponent","JSON","stringify","blob","oldSrc","memoize","memo","isOldIE","self","navigator","userAgent","toLowerCase","getElementsByTagName","newList","mayRemove","textStore","replacement","filter","Boolean","_classCallCheck","instance","Constructor","registerModule","name","enabledByDefault","alwaysEnabled","Module","registeredModules","set","aSettings","forEach","isModuleEnabled","_initiate","observer","mutations","mutation","_loop","l","node","addedNodes","nodeType","Node","ELEMENT_NODE","_trigger","observe","body","childList","subtree","defineProperty","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","prototype","_forSelect","_forSelect2","Map","requiredModules","active","_watchers","_initiators","callback","selector","n","_matches","_matches2","foo","nodeList","querySelectorAll","nodes","slice","unshift","matchesMethod","HTMLElement","getUserIdToken","cookieName","cookieValue","getItem","split","payload","parse","atob","authToken","sitesProps","freefeed.net","cookies","gamma.freefeed.net","siteDomain","hostname","some","cName","_getUserIdToken","_getUserIdToken2","_interopRequireWildcard","hasOwnProperty","_defineProperty","_api","api","_userpics","uPics","_html","_html2","prefsName","me","myID","myScreenName","friends","readers","banIds","_savePropsQueue","_savingPropsNow","_savingIndicator","username","flags","ME","FRIEND","READER","s","_saveProps","json","nulls","k","abrupt","shift","put","user","frontendPreferences","get","resp","users","screenName","setPic","profilePictureMediumUrl","subscribers","map","it","path","token","apiURL","setRequestHeader","del","post","anonFormPost","apiRoot","getPic","picRegistry","has","picLoad","pic","defaultPic","fetch","status","data","_bfRoot","_bfRoot2","bfRoot","myRoot","currentScript","pr","src","h","tagName","attrs","children","el","tagParts","tn","createDocumentFragment","className","chStart","_typeof","_isArray2","_htmlTpl","isSafeHTML","append","insertAdjacentHTML","constructor","_isArray","safeHTML","text","SafeHTML","html","tpl","_len","args","_key","reduce","acc","a","_escapeHtml2","_escapeHtml","replace","readyState","setTimeout","addEventListener","trustedData","hideAliens","commentCloudsMode","v","_this2","nextRequestId","responseAction","parentWindow","parentOrigin","__responders","__listeners","defaultWindow","defaultOrigin","event","_event$data","action","requestId","source","origin","delete","postMessage","sendEx","getCommentAuthor","commentNode","author","dataset","authorLink","querySelector","getAttribute","substr","getPostAuthor","postNode","isArabic","_closestParent","_closestParent2","_onHistory","_onHistory2","init","isHomePage","isBestOf","classList","toggle","button","contains","reactLink","CSS","escape","preventDefault","blur","click","add","watch","postId","match","postAuthor","u","postBody","firstComment","textContent","userName","commentAuthor","commProps","t0","whoIs","closestParent","element","withSelf","native","closest","Element","listeners","oldPushState","history","pushState","oldReplaceState","replaceState","state","title","url","showSettings","Lightbox","showContent","frameborder","_lightbox","_lightbox2","version","link","modal","_container","shadow","contentEl","hide","innerHTML","currentMoonPhase","getTime","newMoon","month","drawMoonPhase","phase","moonEl","lightEl","radius","xRadius","Math","abs","cos","PI","removeAttribute","moonXML","setInterval","round","_taggedTemplateLiteral","strings","raw","freeze","addAccountClicked","style","display","CSS_PREFIX","removeAccount","_callee6","_ref9","_context6","readAccList","ls","ACC_LIST_KEY","t1","lb","genHtml","t2","showSwitchDialog","_callee3","form","_context3","_templateObject","elements","password","_callee2","d","_context2","addAccount","_templateObject2","t3","t4","_ref5","userPic","deleter","data-username","t5","t6","t7","_templateObject3","t8","_ref6","_callee4","_context4","_ref7","_callee5","_context5","_x2","accountClicked","_ref10","_callee7","_context7","setItem","_x3","_crossLocalStorage","_crossLocalStorage2","clickHandlers","handler","LS","t","frameSrc","random","frameOrigin","_class","iframe","contentWindow","usersWithAvatars","withAvatars","sheet","insertRule","_textWalk","_textWalk2","helper","re","userNames","lastUserName","nextElementSibling","actions","nodeValue","textWalk","TEXT_NODE","createEvent","initEvent","dispatchEvent"],"mappings":"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","file":"better-feed.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\t// import \"./modules/ani-gifs\";\n\t\n\t\n\t__webpack_require__(1);\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _currentUserId = __webpack_require__(9);\n\t\n\tvar _iAm = __webpack_require__(10);\n\t\n\tvar _iAm2 = _interopRequireDefault(_iAm);\n\t\n\tvar _docLoaded = __webpack_require__(19);\n\t\n\tvar _docLoaded2 = _interopRequireDefault(_docLoaded);\n\t\n\tvar _settings = __webpack_require__(20);\n\t\n\tvar _settings2 = _interopRequireDefault(_settings);\n\t\n\tvar _messageRpc = __webpack_require__(21);\n\t\n\tvar _messageRpc2 = _interopRequireDefault(_messageRpc);\n\t\n\t__webpack_require__(22);\n\t\n\t__webpack_require__(25);\n\t\n\t__webpack_require__(27);\n\t\n\t__webpack_require__(28);\n\t\n\t__webpack_require__(30);\n\t\n\t__webpack_require__(31);\n\t\n\t__webpack_require__(34);\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(37);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tif (!/^\\/(attachments\\/|files\\/|bookmarklet|v\\d\\/)/.test(location.pathname)) {\n\t    if (!MutationObserver || !Promise) {\n\t        console.error(\"Can not start BetterFeed: MutationObserver & Promise not supported\");\n\t    } else if (_currentUserId.userId === null) {\n\t        console.error(\"Can not start BetterFeed: user not logged in\");\n\t    } else if (\"__BetterFeed\" in window) {\n\t        console.warn(\"BetterFeed already started\");\n\t    } else {\n\t        window.__BetterFeed = true;\n\t        Promise.all([_iAm2.default.ready, _docLoaded2.default]).then(function (_ref) {\n\t            var _ref2 = _slicedToArray(_ref, 1),\n\t                iAm = _ref2[0];\n\t\n\t            start(new _settings2.default(iAm.bf2Props));\n\t        });\n\t    }\n\t}\n\t\n\t/**\r\n\t * @param {Settings} settings\r\n\t */\n\tfunction start(settings) {\n\t    var _this = this;\n\t\n\t    (0, _modules.startObserver)(settings);\n\t\n\t    var msg = new _messageRpc2.default();\n\t\n\t    msg.on(\"getSettings\", function () {\n\t        return settings.toJSON();\n\t    });\n\t\n\t    msg.on(\"saveSettings\", function () {\n\t        var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(o) {\n\t            var iAm;\n\t            return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                while (1) {\n\t                    switch (_context.prev = _context.next) {\n\t                        case 0:\n\t                            _context.next = 2;\n\t                            return _iAm2.default.ready;\n\t\n\t                        case 2:\n\t                            iAm = _context.sent;\n\t                            _context.next = 5;\n\t                            return iAm.saveProps(new _settings2.default(o));\n\t\n\t                        case 5:\n\t                            location.reload(true);\n\t\n\t                        case 6:\n\t                        case \"end\":\n\t                            return _context.stop();\n\t                    }\n\t                }\n\t            }, _callee, _this);\n\t        }));\n\t\n\t        return function (_x) {\n\t            return _ref3.apply(this, arguments);\n\t        };\n\t    }());\n\t\n\t    msg.on(\"checkUpdates\", checkUpdates);\n\t}\n\t\n\tfunction checkUpdates() {\n\t    var now = Date.now();\n\t    var oldVersion = (\"v2.18.5\");\n\t    localStorage[\"bf2-next-update\"] = now + 3600 * 1000;\n\t    var xhr = new XMLHttpRequest();\n\t    xhr.open('GET', 'https://api.github.com/repos/davidmz/BetterFeed2/tags?page=1&per_page=1');\n\t    xhr.responseType = \"json\";\n\t    xhr.onload = function () {\n\t        try {\n\t            var tags = xhr.response;\n\t            if (tags.length === 1 && \"name\" in tags[0]) {\n\t                var newVersion = tags[0][\"name\"];\n\t                localStorage[\"bf2-version\"] = newVersion;\n\t                localStorage[\"bf2-next-update\"] = now + 24 * 3600 * 1000;\n\t                if (newVersion !== oldVersion) {\n\t                    if (confirm(\"\\u0414\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u0430 \\u043D\\u043E\\u0432\\u0430\\u044F \\u0432\\u0435\\u0440\\u0441\\u0438\\u044F: \" + newVersion + \". \\u041E\\u043D\\u0430 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0443\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0430 \\u043F\\u043E\\u0441\\u043B\\u0435 \\u043F\\u0435\\u0440\\u0435\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u044B.\\n\\n\\u041F\\u0435\\u0440\\u0435\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0443 \\u0441\\u0435\\u0439\\u0447\\u0430\\u0441?\")) {\n\t                        location.reload(true);\n\t                    }\n\t                } else {\n\t                    alert(\"\\u0423 \\u0432\\u0430\\u0441 \\u0443\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0430 \\u043F\\u043E\\u0441\\u043B\\u0435\\u0434\\u043D\\u044F\\u044F \\u0432\\u0435\\u0440\\u0441\\u0438\\u044F (\" + newVersion + \")\");\n\t                }\n\t            }\n\t        } catch (e) {}\n\t    };\n\t    xhr.send();\n\t}\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(2);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(5)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\", function() {\n\t\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(3)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".bf2-lightbox-container{left:0;top:0;width:100%;height:100%;position:fixed;z-index:10}.bf2-lightbox-shadow{left:0;top:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.5)}.bf2-lightbox-content{position:relative;border:1px solid #000;background-color:#ccc;box-shadow:0 0 50px rgba(0,0,0,.5)}.bf2-settings-lightbox .bf2-lightbox-content{width:90vw;height:90vh;max-width:800px}.bf2-settings-lightbox .bf2-lightbox-content iframe{left:0;top:0;width:100%;height:100%}.bf2-access-token-lightbox .bf2-lightbox-content{background-color:#fff;max-width:90vw;padding:2em}.bf2-access-token-lightbox .bf2-lightbox-content button{padding:.25em 2em;cursor:pointer}.bf2-access-token-lightbox .bf2-lightbox-content .bf2-access-token{word-wrap:break-word;font-family:monospace;color:#069;background-color:#eee;padding:1em}.bf2-green{padding:1em}.bf2-via-names{font-size:12px}.bf2-hide-aliens-cont{font-size:14px;font-weight:400;margin-left:1em;display:none}.bf2-homepage .bf2-hide-aliens-cont{display:inline}.bf2-hide-aliens .bf2-alien-post{display:none}.bf2-saving-settings-indicator{position:fixed;top:.66em;right:1em;background:#f66;color:#fff;padding:.25em 1em;border-radius:4px;z-index:100}.bf2-animated-gif{position:relative;display:inline-block}.bf2-animated-gif:after{content:\\\"\\\\25B6   GIF\\\";position:absolute;bottom:3px;right:4px;background-color:#069;color:#eee;font-weight:700;padding:.1em .4em;border-radius:3px;font-size:11px;line-height:normal}.arrow-span{padding:0 .2em}.bf2-moon{width:18px;height:18px;margin-left:4px;margin-bottom:10px}.bf2-moon-shadow{fill:#666}.bf2-moon-light{fill:#f5eed9}.bf2-moon-cont{display:inline-block}.bf2-switch-acc{color:#ccc;cursor:pointer;text-align:center}.bf2-switch-acc:hover{background-color:#eee;color:#000}.bf2-switch-acc__icon{display:inline-block;background:url(\" + __webpack_require__(4) + \") no-repeat;background-size:contain;width:14px;height:14px;opacity:.4}.bf2-switch-account-box .bf2-lightbox-content{width:360px;height:auto;cursor:auto;border:1px solid #000;box-shadow:1px 1px 10px rgba(0,0,0,.5);background-color:#fff;padding:1em}.bf2-switch-dlg-header{font-size:120%}.bf2-switch-dlg-accounts{margin:1em 0}.bf2-switch-dlg-account{cursor:pointer;font-weight:700;border:1px solid #ddd;margin:.5em 0;position:relative}.bf2-switch-dlg-account.-current,.bf2-switch-dlg-account:hover{background-color:#eee}.bf2-switch-dlg-account.-current{cursor:not-allowed}.bf2-switch-dlg-account.-current .bf2-switch-dlg-del{display:none}.bf2-switch-dlg-upic{width:50px;height:50px;margin-right:1em;border-right:1px solid #ddd}.bf2-switch-dlg-new-form{display:none}.bf2-switch-dlg-del{position:absolute;right:0;top:50%;width:20px;height:20px;line-height:20px;text-align:center;margin-top:-10px}.bf2-switch-dlg-del:hover{color:#c00}.box{clear:both}.bf2-lightboxed-images .image-attachments a{cursor:zoom-in}.bf2-search-highlight{background-color:#ffff80}.bf2-hp-pre:empty{display:none}.bf2-hp-pre-\\\\({margin-right:.13em}.bf2-hp-\\\\({margin-left:-.13em}.bf2-hp-pre-«{margin-right:.2em}.bf2-hp-«{margin-left:-.2em}.bf2-hp-pre-\\\\\\\"{margin-right:.2em}.bf2-hp-\\\\\\\"{margin-left:-.2em}.bf2-hp-pre-“{margin-right:.33em}.bf2-hp-“{margin-left:-.33em}.bf2-hp-pre--{margin-right:.1em}.bf2-hp--{margin-left:-.1em}\", \"\"]);\n\t\n\t// exports\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\r\n\t// css base code, injected by the css-loader\r\n\tmodule.exports = function() {\r\n\t\tvar list = [];\r\n\t\r\n\t\t// return the list of modules as css string\r\n\t\tlist.toString = function toString() {\r\n\t\t\tvar result = [];\r\n\t\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar item = this[i];\r\n\t\t\t\tif(item[2]) {\r\n\t\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.push(item[1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result.join(\"\");\r\n\t\t};\r\n\t\r\n\t\t// import a list of modules into the list\r\n\t\tlist.i = function(modules, mediaQuery) {\r\n\t\t\tif(typeof modules === \"string\")\r\n\t\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\t\tvar alreadyImportedModules = {};\r\n\t\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar id = this[i][0];\r\n\t\t\t\tif(typeof id === \"number\")\r\n\t\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t\t}\r\n\t\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\t\tvar item = modules[i];\r\n\t\t\t\t// skip already imported module\r\n\t\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.push(item);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn list;\r\n\t};\r\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjxzdmcgd2lkdGg9IjE3OTIiIGhlaWdodD0iMTc5MiIgdmlld0JveD0iMCAwIDE3OTIgMTc5MiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgICA8cGF0aCBkPSJNMTc5MiAxMTg0djE5MnEwIDEzLTkuNSAyMi41dC0yMi41IDkuNWgtMTM3NnYxOTJxMCAxMy05LjUgMjIuNXQtMjIuNSA5LjVxLTEyIDAtMjQtMTBsLTMxOS0zMjBxLTktOS05LTIyIDAtMTQgOS0yM2wzMjAtMzIwcTktOSAyMy05IDEzIDAgMjIuNSA5LjV0OS41IDIyLjV2MTkyaDEzNzZxMTMgMCAyMi41IDkuNXQ5LjUgMjIuNXptMC01NDRxMCAxNC05IDIzbC0zMjAgMzIwcS05IDktMjMgOS0xMyAwLTIyLjUtOS41dC05LjUtMjIuNXYtMTkyaC0xMzc2cS0xMyAwLTIyLjUtOS41dC05LjUtMjIuNXYtMTkycTAtMTMgOS41LTIyLjV0MjIuNS05LjVoMTM3NnYtMTkycTAtMTQgOS0yM3QyMy05cTEyIDAgMjQgMTBsMzE5IDMxOXE5IDkgOSAyM3oiLz4NCjwvc3ZnPg==\"\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\n\t\tAuthor Tobias Koppers @sokra\n\t*/\n\tvar stylesInDom = {},\n\t\tmemoize = function(fn) {\n\t\t\tvar memo;\n\t\t\treturn function () {\n\t\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\t\t\treturn memo;\n\t\t\t};\n\t\t},\n\t\tisOldIE = memoize(function() {\n\t\t\treturn /msie [6-9]\\b/.test(self.navigator.userAgent.toLowerCase());\n\t\t}),\n\t\tgetHeadElement = memoize(function () {\n\t\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\n\t\t}),\n\t\tsingletonElement = null,\n\t\tsingletonCounter = 0,\n\t\tstyleElementsInsertedAtTop = [];\n\t\n\tmodule.exports = function(list, options) {\n\t\tif(false) {\n\t\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t\t}\n\t\n\t\toptions = options || {};\n\t\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t\t// tags it will allow on a page\n\t\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\n\t\n\t\t// By default, add <style> tags to the bottom of <head>.\n\t\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\n\t\n\t\tvar styles = listToStyles(list);\n\t\taddStylesToDom(styles, options);\n\t\n\t\treturn function update(newList) {\n\t\t\tvar mayRemove = [];\n\t\t\tfor(var i = 0; i < styles.length; i++) {\n\t\t\t\tvar item = styles[i];\n\t\t\t\tvar domStyle = stylesInDom[item.id];\n\t\t\t\tdomStyle.refs--;\n\t\t\t\tmayRemove.push(domStyle);\n\t\t\t}\n\t\t\tif(newList) {\n\t\t\t\tvar newStyles = listToStyles(newList);\n\t\t\t\taddStylesToDom(newStyles, options);\n\t\t\t}\n\t\t\tfor(var i = 0; i < mayRemove.length; i++) {\n\t\t\t\tvar domStyle = mayRemove[i];\n\t\t\t\tif(domStyle.refs === 0) {\n\t\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\n\t\t\t\t\t\tdomStyle.parts[j]();\n\t\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\t\n\tfunction addStylesToDom(styles, options) {\n\t\tfor(var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\t\t\tif(domStyle) {\n\t\t\t\tdomStyle.refs++;\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t\t}\n\t\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar parts = [];\n\t\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t\t}\n\t\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction listToStyles(list) {\n\t\tvar styles = [];\n\t\tvar newStyles = {};\n\t\tfor(var i = 0; i < list.length; i++) {\n\t\t\tvar item = list[i];\n\t\t\tvar id = item[0];\n\t\t\tvar css = item[1];\n\t\t\tvar media = item[2];\n\t\t\tvar sourceMap = item[3];\n\t\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\t\t\tif(!newStyles[id])\n\t\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\n\t\t\telse\n\t\t\t\tnewStyles[id].parts.push(part);\n\t\t}\n\t\treturn styles;\n\t}\n\t\n\tfunction insertStyleElement(options, styleElement) {\n\t\tvar head = getHeadElement();\n\t\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\n\t\tif (options.insertAt === \"top\") {\n\t\t\tif(!lastStyleElementInsertedAtTop) {\n\t\t\t\thead.insertBefore(styleElement, head.firstChild);\n\t\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\t\thead.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\n\t\t\t} else {\n\t\t\t\thead.appendChild(styleElement);\n\t\t\t}\n\t\t\tstyleElementsInsertedAtTop.push(styleElement);\n\t\t} else if (options.insertAt === \"bottom\") {\n\t\t\thead.appendChild(styleElement);\n\t\t} else {\n\t\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t\t}\n\t}\n\t\n\tfunction removeStyleElement(styleElement) {\n\t\tstyleElement.parentNode.removeChild(styleElement);\n\t\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\n\t\tif(idx >= 0) {\n\t\t\tstyleElementsInsertedAtTop.splice(idx, 1);\n\t\t}\n\t}\n\t\n\tfunction createStyleElement(options) {\n\t\tvar styleElement = document.createElement(\"style\");\n\t\tstyleElement.type = \"text/css\";\n\t\tinsertStyleElement(options, styleElement);\n\t\treturn styleElement;\n\t}\n\t\n\tfunction createLinkElement(options) {\n\t\tvar linkElement = document.createElement(\"link\");\n\t\tlinkElement.rel = \"stylesheet\";\n\t\tinsertStyleElement(options, linkElement);\n\t\treturn linkElement;\n\t}\n\t\n\tfunction addStyle(obj, options) {\n\t\tvar styleElement, update, remove;\n\t\n\t\tif (options.singleton) {\n\t\t\tvar styleIndex = singletonCounter++;\n\t\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\n\t\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\n\t\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\n\t\t} else if(obj.sourceMap &&\n\t\t\ttypeof URL === \"function\" &&\n\t\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\t\ttypeof Blob === \"function\" &&\n\t\t\ttypeof btoa === \"function\") {\n\t\t\tstyleElement = createLinkElement(options);\n\t\t\tupdate = updateLink.bind(null, styleElement);\n\t\t\tremove = function() {\n\t\t\t\tremoveStyleElement(styleElement);\n\t\t\t\tif(styleElement.href)\n\t\t\t\t\tURL.revokeObjectURL(styleElement.href);\n\t\t\t};\n\t\t} else {\n\t\t\tstyleElement = createStyleElement(options);\n\t\t\tupdate = applyToTag.bind(null, styleElement);\n\t\t\tremove = function() {\n\t\t\t\tremoveStyleElement(styleElement);\n\t\t\t};\n\t\t}\n\t\n\t\tupdate(obj);\n\t\n\t\treturn function updateStyle(newObj) {\n\t\t\tif(newObj) {\n\t\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\n\t\t\t\t\treturn;\n\t\t\t\tupdate(obj = newObj);\n\t\t\t} else {\n\t\t\t\tremove();\n\t\t\t}\n\t\t};\n\t}\n\t\n\tvar replaceText = (function () {\n\t\tvar textStore = [];\n\t\n\t\treturn function (index, replacement) {\n\t\t\ttextStore[index] = replacement;\n\t\t\treturn textStore.filter(Boolean).join('\\n');\n\t\t};\n\t})();\n\t\n\tfunction applyToSingletonTag(styleElement, index, remove, obj) {\n\t\tvar css = remove ? \"\" : obj.css;\n\t\n\t\tif (styleElement.styleSheet) {\n\t\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\n\t\t} else {\n\t\t\tvar cssNode = document.createTextNode(css);\n\t\t\tvar childNodes = styleElement.childNodes;\n\t\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\n\t\t\tif (childNodes.length) {\n\t\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\n\t\t\t} else {\n\t\t\t\tstyleElement.appendChild(cssNode);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction applyToTag(styleElement, obj) {\n\t\tvar css = obj.css;\n\t\tvar media = obj.media;\n\t\n\t\tif(media) {\n\t\t\tstyleElement.setAttribute(\"media\", media)\n\t\t}\n\t\n\t\tif(styleElement.styleSheet) {\n\t\t\tstyleElement.styleSheet.cssText = css;\n\t\t} else {\n\t\t\twhile(styleElement.firstChild) {\n\t\t\t\tstyleElement.removeChild(styleElement.firstChild);\n\t\t\t}\n\t\t\tstyleElement.appendChild(document.createTextNode(css));\n\t\t}\n\t}\n\t\n\tfunction updateLink(linkElement, obj) {\n\t\tvar css = obj.css;\n\t\tvar sourceMap = obj.sourceMap;\n\t\n\t\tif(sourceMap) {\n\t\t\t// http://stackoverflow.com/a/26603875\n\t\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t\t}\n\t\n\t\tvar blob = new Blob([css], { type: \"text/css\" });\n\t\n\t\tvar oldSrc = linkElement.href;\n\t\n\t\tlinkElement.href = URL.createObjectURL(blob);\n\t\n\t\tif(oldSrc)\n\t\t\tURL.revokeObjectURL(oldSrc);\n\t}\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.registeredModules = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.registerModule = registerModule;\n\texports.startObserver = startObserver;\n\t\n\tvar _forSelect = __webpack_require__(7);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar registeredModules = exports.registeredModules = new Map(); // name → module\n\t\n\tvar Module = function () {\n\t    function Module(name) {\n\t        var enabledByDefault = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\t        var alwaysEnabled = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t        _classCallCheck(this, Module);\n\t\n\t        this.name = name;\n\t        this.alwaysEnabled = alwaysEnabled;\n\t        this.enabledByDefault = enabledByDefault;\n\t        this.requiredModules = [];\n\t        /**\r\n\t         * Флаг, позволяющий отключить активность модуля, даже если он разрешён в настройках.\r\n\t         * Например, если фронтенд или браузер не поддерживает необходимые фичи.\r\n\t         * @type {boolean}\r\n\t         */\n\t        this.active = true;\n\t        this._watchers = [];\n\t        this._initiators = [];\n\t    }\n\t\n\t    _createClass(Module, [{\n\t        key: \"init\",\n\t        value: function init(callback) {\n\t            this._initiators.push(callback);\n\t        }\n\t    }, {\n\t        key: \"watch\",\n\t        value: function watch(selector, callback) {\n\t            this._watchers.push({ selector: selector, callback: callback });\n\t        }\n\t    }, {\n\t        key: \"required\",\n\t        value: function required(name) {\n\t            this.requiredModules.push(name);\n\t        }\n\t    }, {\n\t        key: \"_initiate\",\n\t        value: function _initiate(settings) {\n\t            if (!this.active) {\n\t                return;\n\t            }\n\t            this._initiators.forEach(function (c) {\n\t                return c(settings);\n\t            });\n\t            this._watchers.forEach(function (_ref) {\n\t                var selector = _ref.selector,\n\t                    callback = _ref.callback;\n\t                return (0, _forSelect2.default)(document.body, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }, {\n\t        key: \"_trigger\",\n\t        value: function _trigger(node) {\n\t            if (!this.active) {\n\t                return;\n\t            }\n\t            this._watchers.forEach(function (_ref2) {\n\t                var selector = _ref2.selector,\n\t                    callback = _ref2.callback;\n\t                return (0, _forSelect2.default)(node, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Module;\n\t}();\n\t\n\tfunction registerModule(name) {\n\t    var enabledByDefault = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\t    var alwaysEnabled = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t    var m = new Module(name, enabledByDefault, alwaysEnabled);\n\t    registeredModules.set(name, m);\n\t    return m;\n\t}\n\t\n\tvar settings = null;\n\t/**\r\n\t *\r\n\t * @param {Settings} aSettings\r\n\t */\n\tfunction startObserver(aSettings) {\n\t    if (settings) {\n\t        return;\n\t    }\n\t    settings = aSettings;\n\t\n\t    registeredModules.forEach(function (m) {\n\t        if (settings.isModuleEnabled(m)) {\n\t            m._initiate(settings);\n\t        }\n\t    });\n\t\n\t    var observer = new MutationObserver(function (mutations) {\n\t        mutations.forEach(function (mutation) {\n\t            var _loop = function _loop(i, l) {\n\t                var node = mutation.addedNodes[i];\n\t                if (node.nodeType == Node.ELEMENT_NODE) {\n\t                    registeredModules.forEach(function (m) {\n\t                        if (settings.isModuleEnabled(m)) {\n\t                            m._trigger(node, settings);\n\t                        }\n\t                    });\n\t                }\n\t            };\n\t\n\t            for (var i = 0, l = mutation.addedNodes.length; i < l; i++) {\n\t                _loop(i, l);\n\t            }\n\t        });\n\t    });\n\t\n\t    observer.observe(document.body, { childList: true, subtree: true });\n\t}\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _matches = __webpack_require__(8);\n\t\n\tvar _matches2 = _interopRequireDefault(_matches);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\r\n\t * @param {Document|DocumentFragment|Element} node\r\n\t * @param {string} selector\r\n\t * @param {function(Node)} [foo]\r\n\t */\n\texports.default = function (node, selector, foo) {\n\t    if (node === null) return [];\n\t    var nodeList = node.querySelectorAll(selector);\n\t    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\n\t    if ((0, _matches2.default)(node, selector)) nodes.unshift(node);\n\t    if (foo) {\n\t        for (var i = 0, l = nodes.length; i < l; i++) {\n\t            foo(nodes[i]);\n\t        }\n\t    }\n\t    return nodes;\n\t};\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (node, selector) {\n\t  return node[matchesMethod](selector);\n\t};\n\t\n\tvar matchesMethod = \"matches\" in HTMLElement.prototype ? \"matches\" : \"msMatchesSelector\";\n\t\n\t/**\r\n\t *\r\n\t * @param {HTMLElement} node\r\n\t * @param {String} selector\r\n\t * @return {Boolean}\r\n\t */\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar userId = exports.userId = null;\n\tvar authToken = exports.authToken = null;\n\t\n\tvar sitesProps = {\n\t    \"freefeed.net\": {\n\t        cookies: [\"freefeedBETA_authToken\", \"freefeed_authToken\"]\n\t    },\n\t    \"gamma.freefeed.net\": {\n\t        cookies: [\"freefeed_authToken\"]\n\t    }\n\t};\n\t\n\tvar siteDomain = exports.siteDomain = location.hostname;\n\tvar cookieName = exports.cookieName = \"freefeedBETA_authToken\";\n\t\n\tif (siteDomain in sitesProps) {\n\t    sitesProps[siteDomain].cookies.some(function (cName) {\n\t        var _getUserIdToken = getUserIdToken(cName);\n\t\n\t        var _getUserIdToken2 = _slicedToArray(_getUserIdToken, 2);\n\t\n\t        exports.userId = userId = _getUserIdToken2[0];\n\t        exports.authToken = authToken = _getUserIdToken2[1];\n\t\n\t        exports.cookieName = cookieName = cName;\n\t        return userId !== null;\n\t    });\n\t}\n\t\n\t/**\r\n\t *\r\n\t * @param {string} cookieName\r\n\t * @return {Array.<string>} [userId, token]\r\n\t */\n\tfunction getUserIdToken(cookieName) {\n\t    var cookieValue = localStorage.getItem(cookieName);\n\t    if (cookieValue !== null) {\n\t        var parts = cookieValue.split(\".\");\n\t        if (parts.length === 3) {\n\t            try {\n\t                var payload = JSON.parse(atob(parts[1]));\n\t                if (\"userId\" in payload) {\n\t                    return [payload[\"userId\"], cookieValue];\n\t                }\n\t            } catch (e) {}\n\t        }\n\t    }\n\t    return [null, null];\n\t}\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _api = __webpack_require__(11);\n\t\n\tvar api = _interopRequireWildcard(_api);\n\t\n\tvar _userpics = __webpack_require__(12);\n\t\n\tvar uPics = _interopRequireWildcard(_userpics);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar prefsName = \"me.davidmz.BetterFeed2\";\n\t\n\tvar IAm = function () {\n\t    function IAm() {\n\t        _classCallCheck(this, IAm);\n\t\n\t        this.me = null;\n\t        this.myID = null;\n\t        this.myScreenName = null;\n\t        this.friends = [];\n\t        this.readers = [];\n\t        this.banIds = [];\n\t        this.bf2Props = {};\n\t\n\t        this._savePropsQueue = [];\n\t        this._savingPropsNow = false;\n\t        this._savingIndicator = (0, _html2.default)(\".bf2-saving-settings-indicator\", \"Saving settings…\");\n\t    }\n\t\n\t    _createClass(IAm, [{\n\t        key: 'whoIs',\n\t        value: function whoIs(username) {\n\t            var flags = 0;\n\t            if (username === this.me) flags |= IAm.ME;\n\t            if (this.friends.indexOf(username) !== -1) flags |= IAm.FRIEND;\n\t            if (this.readers.indexOf(username) !== -1) flags |= IAm.READER;\n\t            return flags;\n\t        }\n\t    }, {\n\t        key: 'isBanned',\n\t        value: function isBanned(userId) {\n\t            return this.banIds.indexOf(userId) !== -1;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Settings} s\r\n\t         */\n\t\n\t    }, {\n\t        key: 'saveProps',\n\t        value: function saveProps(s) {\n\t            this._savePropsQueue.push(s.toJSON());\n\t            return this._saveProps();\n\t        }\n\t\n\t        /**\r\n\t         * Последовательное сохранение настроек по очереди\r\n\t         * @private\r\n\t         */\n\t\n\t    }, {\n\t        key: '_saveProps',\n\t        value: function () {\n\t            var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t                var json, nulls, k;\n\t                return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                    while (1) {\n\t                        switch (_context.prev = _context.next) {\n\t                            case 0:\n\t                                if (!this._savingPropsNow) {\n\t                                    _context.next = 2;\n\t                                    break;\n\t                                }\n\t\n\t                                return _context.abrupt('return');\n\t\n\t                            case 2:\n\t\n\t                                document.body.appendChild(this._savingIndicator);\n\t                                this._savingPropsNow = true;\n\t\n\t                            case 4:\n\t                                if (!(this._savePropsQueue.length > 0)) {\n\t                                    _context.next = 11;\n\t                                    break;\n\t                                }\n\t\n\t                                json = this._savePropsQueue.shift(), nulls = {};\n\t\n\t                                for (k in json) {\n\t                                    if (json.hasOwnProperty(k)) nulls[k] = null;\n\t                                }_context.next = 9;\n\t                                return api.put('/v1/users/' + this.myID, JSON.stringify({ user: { frontendPreferences: _defineProperty({}, prefsName, json) } }));\n\t\n\t                            case 9:\n\t                                _context.next = 4;\n\t                                break;\n\t\n\t                            case 11:\n\t                                this._savingPropsNow = false;\n\t                                document.body.removeChild(this._savingIndicator);\n\t\n\t                            case 13:\n\t                            case 'end':\n\t                                return _context.stop();\n\t                        }\n\t                    }\n\t                }, _callee, this);\n\t            }));\n\t\n\t            function _saveProps() {\n\t                return _ref.apply(this, arguments);\n\t            }\n\t\n\t            return _saveProps;\n\t        }()\n\t    }]);\n\t\n\t    return IAm;\n\t}();\n\t\n\texports.default = IAm;\n\t\n\t\n\tIAm.ME = 1 << 0;\n\tIAm.FRIEND = 1 << 1;\n\tIAm.READER = 1 << 2;\n\t\n\tIAm.ready = null;\n\t\n\tIAm.update = function () {\n\t    IAm.ready = api.get('/v2/users/whoami').then(function (resp) {\n\t        var iAm = new IAm();\n\t        iAm.me = resp.users.username;\n\t        iAm.myID = resp.users.id;\n\t        iAm.myScreenName = resp.users.screenName;\n\t        uPics.setPic(resp.users.username, resp.users.profilePictureMediumUrl);\n\t        iAm.friends = resp.subscribers.map(function (it) {\n\t            uPics.setPic(it.username, it.profilePictureMediumUrl);\n\t            return it.username;\n\t        });\n\t        iAm.readers = resp.users.subscribers.map(function (it) {\n\t            uPics.setPic(it.username, it.profilePictureMediumUrl);\n\t            return it.username;\n\t        });\n\t        iAm.banIds = resp.users.banIds;\n\t        iAm.bf2Props = resp.users.frontendPreferences[prefsName] || {};\n\t\n\t        return iAm;\n\t    });\n\t};\n\t\n\tIAm.update();\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.get = get;\n\texports.put = put;\n\texports.del = del;\n\texports.post = post;\n\texports.anonFormPost = anonFormPost;\n\t\n\tvar _currentUserId = __webpack_require__(9);\n\t\n\tvar apiRoot = \"https://freefeed.net\";\n\t\n\tfunction get(path) {\n\t    var token = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : _currentUserId.authToken;\n\t\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('GET', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('X-Authentication-Token', token);\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send();\n\t    });\n\t}\n\t\n\tfunction put(path, body) {\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('PUT', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('X-Authentication-Token', _currentUserId.authToken);\n\t        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send(body);\n\t    });\n\t}\n\t\n\tfunction del(path, body) {\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('DELETE', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('X-Authentication-Token', _currentUserId.authToken);\n\t        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send(body);\n\t    });\n\t}\n\t\n\tfunction post(path, body) {\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('POST', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('X-Authentication-Token', _currentUserId.authToken);\n\t        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send(body);\n\t    });\n\t}\n\t\n\tfunction anonFormPost(path, body) {\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('POST', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send(body);\n\t    });\n\t}\n\t\n\tfunction apiURL(path) {\n\t    return apiRoot + path + (path.indexOf(\"?\") !== -1 ? \"&\" : \"?\") + \"_initiator=betterfeed2\";\n\t}\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.defaultPic = undefined;\n\t\n\tvar picLoad = function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(username) {\n\t        var resp;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        _context.next = 2;\n\t                        return fetch(\"https://davidmz.me/frfrfr/uinfo/upic?username=\" + username);\n\t\n\t                    case 2:\n\t                        _context.next = 4;\n\t                        return _context.sent.json();\n\t\n\t                    case 4:\n\t                        resp = _context.sent;\n\t                        return _context.abrupt(\"return\", resp.status === \"ok\" && resp.data !== \"\" ? resp.data : defaultPic);\n\t\n\t                    case 6:\n\t                    case \"end\":\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this);\n\t    }));\n\t\n\t    return function picLoad(_x) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\texports.getPic = getPic;\n\texports.setPic = setPic;\n\t\n\tvar _bfRoot = __webpack_require__(13);\n\t\n\tvar _bfRoot2 = _interopRequireDefault(_bfRoot);\n\t\n\t__webpack_require__(14);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar defaultPic = exports.defaultPic = _bfRoot2.default + \"/build/default-userpic-50.png\";\n\tvar picRegistry = new Map();\n\t\n\tfunction getPic(username) {\n\t    if (!picRegistry.has(username)) {\n\t        picRegistry.set(username, picLoad(username));\n\t    }\n\t    return picRegistry.get(username);\n\t}\n\t\n\tfunction setPic(username, pic) {\n\t    picRegistry.set(username, Promise.resolve(pic && pic !== \"\" ? pic : defaultPic));\n\t}\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tvar myRoot = \"https://davidmz.me/betterfeed-cdn/\" + localStorage['bf2-version'];\n\tif (document.currentScript) {\n\t    var pr = document.currentScript.src.split(\"/\");\n\t    myRoot = pr.slice(0, pr.length - 2).join(\"/\");\n\t}\n\t\n\texports.default = myRoot;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"default-userpic-50.png\";\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\texports.default = h;\n\t\n\tvar _isArray = __webpack_require__(16);\n\t\n\tvar _isArray2 = _interopRequireDefault(_isArray);\n\t\n\tvar _htmlTpl = __webpack_require__(17);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\r\n\t * h(\"tag.class\", {attr: val}, child)\r\n\t * h(\"tag.class\", child)\r\n\t * h(\"tag.class\", {attr: val})\r\n\t * h(\"tag.class\")\r\n\t * h(\".class\") // div\r\n\t * h(\"$\") // document fragment\r\n\t *\r\n\t * Класс, заданный через атрибуты, перекрывает классы из строки тегов\r\n\t *\r\n\t * @param {String} tagName - tag или tag.class1.class2 (поддерживаются только классы)\r\n\t * @param {Object} [attrs]\r\n\t * @param {Node|string|Array} [children]\r\n\t * @return {HTMLElement}\r\n\t */\n\tfunction h(tagName, attrs, children) {\n\t    var i, k;\n\t    var tagParts = tagName.split(\".\");\n\t    var tn = tagParts.shift() || \"div\";\n\t    var el;\n\t    if (tn === \"$\") {\n\t        el = document.createDocumentFragment();\n\t    } else {\n\t        el = document.createElement(tn);\n\t        if (tagParts.length > 0) {\n\t            el.className = tagParts.join(\" \");\n\t        }\n\t    }\n\t\n\t    var chStart = 1;\n\t    if (arguments.length > 1 && (typeof attrs === \"undefined\" ? \"undefined\" : _typeof(attrs)) === \"object\" && !(attrs instanceof Node) && !(0, _isArray2.default)(attrs) && !(0, _htmlTpl.isSafeHTML)(attrs)) {\n\t        for (k in attrs) {\n\t            if (attrs.hasOwnProperty(k)) el.setAttribute(k, attrs[k]);\n\t        }chStart = 2;\n\t    }\n\t\n\t    if (arguments.length > chStart) {\n\t        for (i = chStart; i < arguments.length; i++) {\n\t            append(el, arguments[i]);\n\t        }\n\t    }\n\t    return el;\n\t};\n\t\n\tfunction append(el, it) {\n\t    if (it instanceof Node) {\n\t        el.appendChild(it);\n\t    } else if ((0, _isArray2.default)(it)) {\n\t        it.forEach(append.bind(null, el));\n\t    } else if (typeof it === \"string\") {\n\t        el.appendChild(document.createTextNode(it));\n\t    } else if ((0, _htmlTpl.isSafeHTML)(it)) {\n\t        el.insertAdjacentHTML('beforeEnd', it.toString());\n\t    }\n\t}\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\texports.default = Array.isArray || function (arr) {\n\t    return Object.prototype.toString.call(arr) == '[object Array]';\n\t};\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.safeHTML = safeHTML;\n\texports.isSafeHTML = isSafeHTML;\n\texports.html = html;\n\t\n\tvar _escapeHtml = __webpack_require__(18);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar SafeHTML = function () {\n\t    function SafeHTML(text) {\n\t        _classCallCheck(this, SafeHTML);\n\t\n\t        this.text = text;\n\t    }\n\t\n\t    _createClass(SafeHTML, [{\n\t        key: \"toString\",\n\t        value: function toString() {\n\t            return this.text;\n\t        }\n\t    }]);\n\t\n\t    return SafeHTML;\n\t}();\n\t\n\tfunction safeHTML(text) {\n\t    return new SafeHTML(text);\n\t}\n\t\n\tfunction isSafeHTML(h) {\n\t    return h instanceof SafeHTML;\n\t}\n\t\n\tfunction html(tpl) {\n\t    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t        args[_key - 1] = arguments[_key];\n\t    }\n\t\n\t    return safeHTML(tpl.reduce(function (acc, part, i) {\n\t        var a = args[i - 1];\n\t        return acc + (isSafeHTML(a) ? a : (0, _escapeHtml2.default)(a)) + part;\n\t    }));\n\t}\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function () {\n\t  var s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n\t\n\t  return s.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\n\t};\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = new Promise(function (resolve) {\n\t    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n\t        setTimeout(resolve, 0);\n\t    } else {\n\t        document.addEventListener(\"DOMContentLoaded\", resolve);\n\t    }\n\t});\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Settings = function () {\n\t    function Settings() {\n\t        var _this = this;\n\t\n\t        var o = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t        var trustedData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\t\n\t        _classCallCheck(this, Settings);\n\t\n\t        this.modules = new Map();\n\t        _modules.registeredModules.forEach(function (m) {\n\t            if (!m.alwaysEnabled) {\n\t                _this.modules.set(m.name, m.enabledByDefault);\n\t            }\n\t        });\n\t\n\t        this.hideAliens = false;\n\t        this.commentCloudsMode = 2;\n\t\n\t        // инициализация из объекта\n\t        if (o) {\n\t            (o.modules || []).forEach(function (_ref) {\n\t                var _ref2 = _slicedToArray(_ref, 2),\n\t                    k = _ref2[0],\n\t                    v = _ref2[1];\n\t\n\t                if (trustedData || _this.modules.has(k)) {\n\t                    _this.modules.set(k, !!v);\n\t                }\n\t            });\n\t            this.hideAliens = !!o.hideAliens;\n\t            if (o.commentCloudsMode === 1 || o.commentCloudsMode === 2) {\n\t                this.commentCloudsMode = o.commentCloudsMode;\n\t            }\n\t        }\n\t    }\n\t\n\t    _createClass(Settings, [{\n\t        key: \"toJSON\",\n\t        value: function toJSON() {\n\t            var o = { modules: [] };\n\t            this.modules.forEach(function (v, k) {\n\t                return o.modules.push([k, v]);\n\t            });\n\t            o.hideAliens = this.hideAliens;\n\t            o.commentCloudsMode = this.commentCloudsMode;\n\t            return o;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Module} m\r\n\t         * @return {boolean}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"isModuleEnabled\",\n\t        value: function isModuleEnabled(m) {\n\t            var _this2 = this;\n\t\n\t            return m && (m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name)) && !m.requiredModules.map(function (name) {\n\t                return _modules.registeredModules.get(name);\n\t            }).some(function (m) {\n\t                return !_this2.isModuleEnabled(m);\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Settings;\n\t}();\n\t\n\texports.default = Settings;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nextRequestId = 1;\n\t\n\tvar responseAction = \"@response\";\n\t\n\tvar Messenger = function () {\n\t    function Messenger() {\n\t        var _this = this;\n\t\n\t        var parentWindow = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t        var parentOrigin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n\t\n\t        _classCallCheck(this, Messenger);\n\t\n\t        this.__responders = new Map();\n\t        this.__listeners = new Map();\n\t\n\t        this.defaultWindow = parentWindow;\n\t        this.defaultOrigin = parentOrigin;\n\t\n\t        window.addEventListener('message', function (event) {\n\t            if (_typeof(event.data) !== \"object\") {\n\t                return;\n\t            }\n\t            //noinspection UnnecessaryLocalVariableJS\n\t            var _event$data = event.data,\n\t                action = _event$data.action,\n\t                requestId = _event$data.requestId,\n\t                value = _event$data.value,\n\t                source = event.source,\n\t                origin = event.origin;\n\t\n\t\n\t            if (action === responseAction && _this.__responders.has(requestId)) {\n\t                _this.__responders.get(requestId)(value);\n\t                _this.__responders.delete(requestId);\n\t            } else if (_this.__listeners.has(action)) {\n\t                var resp = _this.__listeners.get(action)(value);\n\t                source.postMessage({ action: responseAction, requestId: requestId, value: resp }, origin);\n\t            }\n\t        });\n\t    }\n\t\n\t    /**\r\n\t     *\r\n\t     * @param {String} action\r\n\t     * @param {*} value\r\n\t     * @return {Promise}\r\n\t     */\n\t\n\t\n\t    _createClass(Messenger, [{\n\t        key: \"send\",\n\t        value: function send(action) {\n\t            var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\t\n\t            return this.sendEx(this.defaultWindow, this.defaultOrigin, action, value);\n\t        }\n\t\n\t        /**\r\n\t         *\r\n\t         * @param {Window} window\r\n\t         * @param {String} origin\r\n\t         * @param {String} action\r\n\t         * @param {*} value\r\n\t         * @return {Promise}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"sendEx\",\n\t        value: function sendEx(window, origin, action) {\n\t            var _this2 = this;\n\t\n\t            var value = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\t\n\t            return new Promise(function (resolve) {\n\t                var requestId = nextRequestId++;\n\t                _this2.__responders.set(requestId, resolve);\n\t                window.postMessage({ action: action, requestId: requestId, value: value }, origin);\n\t            });\n\t        }\n\t\n\t        /**\r\n\t         *\r\n\t         * @param {String} action\r\n\t         * @param {function} callback\r\n\t         */\n\t\n\t    }, {\n\t        key: \"on\",\n\t        value: function on(action, callback) {\n\t            this.__listeners.set(action, callback);\n\t        }\n\t    }]);\n\t\n\t    return Messenger;\n\t}();\n\t\n\texports.default = Messenger;\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _closestParent = __webpack_require__(23);\n\t\n\tvar _closestParent2 = _interopRequireDefault(_closestParent);\n\t\n\tvar _onHistory = __webpack_require__(24);\n\t\n\tvar _onHistory2 = _interopRequireDefault(_onHistory);\n\t\n\tvar _forSelect = __webpack_require__(7);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tvar _iAm = __webpack_require__(10);\n\t\n\tvar _iAm2 = _interopRequireDefault(_iAm);\n\t\n\tvar _currentUserId = __webpack_require__(9);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"common\", true, true);\n\t\n\t_module.init(function () {\n\t    (0, _onHistory2.default)(function (location) {\n\t        var isHomePage = location.pathname === \"/\";\n\t        var isBestOf = location.pathname === \"/filter/best_of\";\n\t        document.body.classList.toggle(\"bf2-homepage\", isHomePage);\n\t        document.body.classList.toggle(\"bf2-best-of\", isBestOf);\n\t        document.body.classList.toggle(\"bf2-aggregate-page\", isHomePage || isBestOf);\n\t    });\n\t\n\t    document.addEventListener(\"click\", function (e) {\n\t        if (e.button == 0 && e.target.classList.contains(\"bf2-user-link\")) {\n\t            //noinspection JSUnresolvedVariable\n\t            var reactLink = document.querySelector(\"a:not(.bf2-user-link)[href=\\\"\" + CSS.escape(e.target.getAttribute(\"href\")) + \"\\\"]\");\n\t            if (reactLink) {\n\t                e.preventDefault();\n\t                e.target.blur();\n\t                reactLink.click();\n\t            }\n\t        }\n\t    });\n\t\n\t    if (_currentUserId.siteDomain === \"gamma.freefeed.net\") {\n\t        document.body.classList.add(\"bf2-gamma-frontend\");\n\t    }\n\t});\n\t\n\t// Свойства постов\n\t_module.watch(\".timeline-post, .single-post\", function (node) {\n\t    // ID поста\n\t    var postId = node.querySelector(\".post-timestamp\").getAttribute(\"href\").match(/^\\/.+?\\/([\\w-]+)/)[1];\n\t    node.id = \"post-\" + postId;\n\t    node.dataset.postId = postId;\n\t\n\t    // Автор поста\n\t    var postAuthor = node.querySelector(\".post-author\").getAttribute(\"href\").substr(1);\n\t    node.dataset.postAuthor = postAuthor;\n\t    node.classList.add(\"bf2-post-from-\" + postAuthor);\n\t\n\t    // Адресаты поста\n\t    (0, _forSelect2.default)(node, \".post-recipient\").map(function (a) {\n\t        return a.getAttribute(\"href\").substr(1);\n\t    }).filter(function (u) {\n\t        return u !== postAuthor;\n\t    }).forEach(function (u) {\n\t        return node.classList.add(\"bf2-post-to-\" + u);\n\t    });\n\t\n\t    // Язык поста\n\t    var postBody = node.querySelector(\".post-text\");\n\t    var firstComment = node.querySelector(\".comment-body\");\n\t    if (isArabic(postBody.textContent) || firstComment && isArabic(firstComment.textContent)) {\n\t        node.classList.add(\"bf2-lang-arabic\");\n\t    }\n\t});\n\t\n\t// User cards\n\t_module.watch(\".user-card .display-name\", function (node) {\n\t    (0, _closestParent2.default)(node, \".user-card\").dataset.userName = node.getAttribute(\"href\").substr(1);\n\t});\n\t\n\t// Свойства комментариев\n\t_module.watch(\".comment\", function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(node) {\n\t        var commentAuthor, postAuthor, commProps, type;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        commentAuthor = getCommentAuthor(node);\n\t\n\t                        if (commentAuthor) {\n\t                            _context.next = 3;\n\t                            break;\n\t                        }\n\t\n\t                        return _context.abrupt(\"return\");\n\t\n\t                    case 3:\n\t                        postAuthor = getPostAuthor((0, _closestParent2.default)(node, \".post\"));\n\t\n\t                        if (postAuthor) {\n\t                            _context.next = 6;\n\t                            break;\n\t                        }\n\t\n\t                        return _context.abrupt(\"return\");\n\t\n\t                    case 6:\n\t                        commProps = [];\n\t\n\t\n\t                        commProps.push(\"from\");\n\t\n\t                        if (postAuthor === commentAuthor) {\n\t                            commProps.push(\"from-post-author\");\n\t                        }\n\t\n\t                        _context.next = 11;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 11:\n\t                        _context.t0 = commentAuthor;\n\t                        type = _context.sent.whoIs(_context.t0);\n\t\n\t                        if (type & _iAm2.default.ME) {\n\t                            commProps.push(\"from-me\");\n\t                        } else if (type & _iAm2.default.FRIEND) {\n\t                            commProps.push(\"from-friend\");\n\t                        } else if (type & _iAm2.default.READER) {\n\t                            commProps.push(\"from-reader\");\n\t                        }\n\t\n\t                        node.dataset.commProps = commProps.join(\" \");\n\t\n\t                    case 15:\n\t                    case \"end\":\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, undefined);\n\t    }));\n\t\n\t    return function (_x) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}());\n\t\n\tfunction getCommentAuthor(commentNode) {\n\t    var author = commentNode.dataset[\"author\"];\n\t    if (!author) {\n\t        var authorLink = commentNode.querySelector(\".comment-body > .user-name-wrapper > a\");\n\t        if (authorLink) {\n\t            author = authorLink.getAttribute(\"href\").substr(1);\n\t            commentNode.dataset[\"author\"] = author;\n\t        }\n\t    }\n\t    return author;\n\t}\n\t\n\tfunction getPostAuthor(postNode) {\n\t    var author = postNode.dataset[\"author\"];\n\t    if (!author) {\n\t        var authorLink = postNode.querySelector(\".post-header a.post-author\");\n\t        if (authorLink) {\n\t            author = authorLink.getAttribute(\"href\").substr(1);\n\t            postNode.dataset[\"author\"] = author;\n\t        }\n\t    }\n\t    return author;\n\t}\n\t\n\t/**\r\n\t *\r\n\t * @param {string} text\r\n\t * @return {boolean}\r\n\t */\n\tfunction isArabic(text) {\n\t    return (/[\\u0600-\\u06ff\\u0700-\\u077f\\u08A0-\\u08ff]/.test(text)\n\t    );\n\t}\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = closestParent;\n\t\n\tvar _matches = __webpack_require__(8);\n\t\n\tvar _matches2 = _interopRequireDefault(_matches);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar native = !!Element.prototype.closest;\n\t\n\t/**\r\n\t *\r\n\t * @param {Element|null} element\r\n\t * @param {string} selector\r\n\t * @param {boolean} [withSelf]\r\n\t * @return {Element|null}\r\n\t */\n\tfunction closestParent(element, selector) {\n\t    var withSelf = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t    if (element === null) return null;\n\t    var p = withSelf ? element : element.parentNode;\n\t    if (native && p) return p.closest(selector);\n\t\n\t    if (p && p.nodeType == Node.ELEMENT_NODE) {\n\t        return (0, _matches2.default)(p, selector) ? p : closestParent(p, selector);\n\t    }\n\t    return null;\n\t};\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\texports.default = function (callback) {\n\t    listeners.push(callback);\n\t    callback(location);\n\t};\n\t\n\tvar listeners = [];\n\t\n\tvar oldPushState = history.pushState.bind(history),\n\t    oldReplaceState = history.replaceState.bind(history);\n\t\n\thistory.pushState = function (state, title, url) {\n\t    oldPushState(state, title, url);\n\t    listeners.forEach(function (c) {\n\t        return c(location);\n\t    });\n\t};\n\t\n\thistory.replaceState = function (state, title, url) {\n\t    oldReplaceState(state, title, url);\n\t    listeners.forEach(function (c) {\n\t        return c(location);\n\t    });\n\t};\n\t\n\twindow.addEventListener(\"popstate\", function () {\n\t    return listeners.forEach(function (c) {\n\t        return c(location);\n\t    });\n\t});\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tvar _bfRoot = __webpack_require__(13);\n\t\n\tvar _bfRoot2 = _interopRequireDefault(_bfRoot);\n\t\n\tvar _lightbox = __webpack_require__(26);\n\t\n\tvar _lightbox2 = _interopRequireDefault(_lightbox);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar version = (\"v2.18.5\");\n\t\n\tvar _module = (0, _modules.registerModule)(\"settings-link\", true, true);\n\t\n\t_module.watch(\".sidebar\", function (node) {\n\t    if (node.querySelector(\".bf2-sidebar-box\")) {\n\t        return;\n\t    }\n\t\n\t    var link = (0, _html2.default)(\"a\", \"BetterFeed settings\");\n\t    var html = (0, _html2.default)(\".bf2-sidebar-box.box\", (0, _html2.default)(\".box-header-groups\", \"Add-ons\"), (0, _html2.default)(\".box-body\", (0, _html2.default)(\"ul\", (0, _html2.default)(\"li\", link))), (0, _html2.default)(\".box-footer\", version));\n\t\n\t    node.insertBefore(html, null);\n\t\n\t    link.addEventListener(\"click\", showSettings);\n\t});\n\t\n\tfunction showSettings() {\n\t    var url = _bfRoot2.default + '/src/html/settings.html?origin=' + encodeURIComponent(location.origin);\n\t\n\t    if (/iPhone|iPad/.test(navigator.userAgent)) {\n\t        window.open(url, \"_blank\");\n\t        return;\n\t    }\n\t\n\t    new _lightbox2.default(\"bf2-settings-lightbox\").showContent((0, _html2.default)(\"iframe\", { src: url, frameborder: \"0\" }));\n\t}\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Lightbox = function () {\n\t    /**\r\n\t     * @param {string} className\r\n\t     * @param {boolean} modal\r\n\t     */\n\t    function Lightbox() {\n\t        var _this = this;\n\t\n\t        var className = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n\t        var modal = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\t\n\t        _classCallCheck(this, Lightbox);\n\t\n\t        this._container = (0, _html2.default)(\".bf2-lightbox-container\");\n\t        if (className !== \"\") {\n\t            this._container.classList.add(className);\n\t        }\n\t        var shadow = this._container.appendChild((0, _html2.default)(\".bf2-lightbox-shadow\"));\n\t        /** @var {HTMLElement} */\n\t        this.contentEl = shadow.appendChild((0, _html2.default)(\".bf2-lightbox-content\"));\n\t        shadow.addEventListener(\"click\", function (e) {\n\t            if (e.target === shadow && !modal) {\n\t                _this.hide();\n\t            }\n\t        });\n\t    }\n\t\n\t    /**\r\n\t     * @param {HTMLElement|string} el\r\n\t     */\n\t\n\t\n\t    _createClass(Lightbox, [{\n\t        key: \"showContent\",\n\t        value: function showContent(el) {\n\t            if (typeof el === \"string\") {\n\t                this.contentEl.innerHTML = el;\n\t            } else {\n\t                this.contentEl.innerHTML = \"\";\n\t                this.contentEl.appendChild(el);\n\t            }\n\t            document.body.appendChild(this._container);\n\t        }\n\t    }, {\n\t        key: \"hide\",\n\t        value: function hide() {\n\t            this.contentEl.innerHTML = \"\";\n\t            this._container.parentNode.removeChild(this._container);\n\t        }\n\t    }]);\n\t\n\t    return Lightbox;\n\t}();\n\t\n\texports.default = Lightbox;\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"moon\");\n\t\n\t//noinspection HtmlUnknownAttribute \n\tvar moonXML = \"<svg class=\\\"bf2-moon\\\" viewBox=\\\"-4 -4 108 108\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" version=\\\"1.1\\\">\\n        <circle class=\\\"bf2-moon-shadow\\\" cx=\\\"50\\\" cy=\\\"50\\\" r=\\\"54\\\"></circle>\\n        <path class=\\\"bf2-moon-light\\\" d=\\\"M 50 0 a 30 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z\\\"></path>\\n    </svg>\";\n\t\n\t_module.watch(\"h1\", function (node) {\n\t    node.appendChild((0, _html2.default)(\".bf2-moon-cont\")).innerHTML = moonXML;\n\t    drawMoonPhase(currentMoonPhase());\n\t    setInterval(function () {\n\t        return drawMoonPhase(currentMoonPhase());\n\t    }, 1000 * 3600);\n\t});\n\t\n\tvar newMoon = new Date(\"Thu Apr 07 2016 14:22:37 GMT+0300\").getTime(),\n\t    month = Math.round(86400 * 29.53058812 * 1000);\n\t\n\tfunction currentMoonPhase() {\n\t    return (new Date().getTime() - newMoon) / month % 1;\n\t}\n\t\n\t// phase = [0..1], 0 = 1 = новолуние, 0.5 = полнолуние\n\tfunction drawMoonPhase(phase) {\n\t    var moonEl = document.querySelector(\".bf2-moon\");\n\t    if (!moonEl) {\n\t        return;\n\t    }\n\t    var lightEl = moonEl.querySelector(\".bf2-moon-light\");\n\t    var radius = 50;\n\t    var xRadius = radius * Math.abs(Math.cos(2 * Math.PI * phase));\n\t\n\t    var path = void 0;\n\t    if (phase < 0.25) {\n\t        path = \"M 50 0 a \" + xRadius + \" 50 0 0 1 0 100 a 50 50 0 0 0 0 -100 Z\";\n\t    } else if (phase < 0.5) {\n\t        path = \"M 50 0 a \" + xRadius + \" 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z\";\n\t    } else if (phase < 0.75) {\n\t        path = \"M 50 0 a 50 50 0 0 0 0 100 a \" + xRadius + \" 50 0 0 0 0 -100 Z\";\n\t    } else {\n\t        path = \"M 50 0 a 50 50 0 0 0 0 100 a \" + xRadius + \" 50 0 0 1 0 -100 Z\";\n\t    }\n\t    lightEl.setAttribute(\"d\", path);\n\t\n\t    if (Math.abs(0.5 - phase) < 0.05) {\n\t        moonEl.parentNode.setAttribute(\"title\", \"Achtung Vollmond!\");\n\t    } else {\n\t        moonEl.parentNode.removeAttribute(\"title\");\n\t    }\n\t}\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar showSwitchDialog = function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        lb = new _lightbox2.default(\"bf2-switch-account-box\");\n\t                        lb.showContent(\"<p>Loading\\u2026</p>\");\n\t                        _context.t0 = lb;\n\t                        _context.next = 5;\n\t                        return genHtml();\n\t\n\t                    case 5:\n\t                        _context.t1 = _context.sent;\n\t\n\t                        _context.t0.showContent.call(_context.t0, _context.t1);\n\t\n\t                    case 7:\n\t                    case \"end\":\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this);\n\t    }));\n\t\n\t    return function showSwitchDialog() {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar genHtml = function () {\n\t    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n\t        var _this = this;\n\t\n\t        var _ref3, me, form;\n\t\n\t        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n\t            while (1) {\n\t                switch (_context3.prev = _context3.next) {\n\t                    case 0:\n\t                        _context3.next = 2;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 2:\n\t                        _ref3 = _context3.sent;\n\t                        me = _ref3.me;\n\t                        form = (0, _html2.default)(\"form.\" + CSS_PREFIX + \"new-form\", (0, _htmlTpl.html)(_templateObject));\n\t\n\t                        form.addEventListener(\"submit\", function (e) {\n\t                            e.preventDefault();\n\t                            var username = form.elements['username'].value;\n\t                            var password = form.elements['password'].value;\n\t                            _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n\t                                var d, u, authToken;\n\t                                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t                                    while (1) {\n\t                                        switch (_context2.prev = _context2.next) {\n\t                                            case 0:\n\t                                                _context2.next = 2;\n\t                                                return api.anonFormPost(\"/v1/session\", \"username=\" + encodeURIComponent(username) + \"&password=\" + encodeURIComponent(password));\n\t\n\t                                            case 2:\n\t                                                d = _context2.sent;\n\t\n\t                                                if (!d.err) {\n\t                                                    _context2.next = 6;\n\t                                                    break;\n\t                                                }\n\t\n\t                                                alert(d.err);\n\t                                                return _context2.abrupt(\"return\");\n\t\n\t                                            case 6:\n\t                                                //noinspection UnnecessaryLocalVariableJS\n\t                                                u = d.users.username, authToken = d.authToken;\n\t                                                _context2.next = 9;\n\t                                                return addAccount(u, authToken);\n\t\n\t                                            case 9:\n\t                                                _context2.t0 = lb;\n\t                                                _context2.next = 12;\n\t                                                return genHtml();\n\t\n\t                                            case 12:\n\t                                                _context2.t1 = _context2.sent;\n\t\n\t                                                _context2.t0.showContent.call(_context2.t0, _context2.t1);\n\t\n\t                                            case 14:\n\t                                            case \"end\":\n\t                                                return _context2.stop();\n\t                                        }\n\t                                    }\n\t                                }, _callee2, _this);\n\t                            }))();\n\t                        });\n\t\n\t                        _context3.t0 = _html2.default;\n\t                        _context3.t1 = (0, _htmlTpl.html)(_templateObject2, CSS_PREFIX);\n\t                        _context3.t2 = _html2.default;\n\t                        _context3.t3 = \".\" + CSS_PREFIX + \"accounts\";\n\t                        _context3.next = 12;\n\t                        return readAccList();\n\t\n\t                    case 12:\n\t                        _context3.t4 = function (_ref5) {\n\t                            var username = _ref5.username;\n\t\n\t                            var userPic = (0, _html2.default)(\"img.\" + CSS_PREFIX + \"upic\", { src: _userpics.defaultPic });\n\t                            (0, _userpics.getPic)(username).then(function (pic) {\n\t                                return userPic.src = pic;\n\t                            });\n\t                            var deleter = (0, _html2.default)(\".\" + CSS_PREFIX + \"del\", { title: \"Remove from list\" }, (0, _html2.default)(\"i.fa.fa-times-circle\"));\n\t                            return (0, _html2.default)(\".\" + CSS_PREFIX + \"account\" + (username === me ? \".-current\" : \"\"), { \"data-username\": username }, userPic, username, deleter);\n\t                        };\n\t\n\t                        _context3.t5 = _context3.sent.map(_context3.t4);\n\t                        _context3.t6 = (0, _context3.t2)(_context3.t3, _context3.t5);\n\t                        _context3.t7 = (0, _htmlTpl.html)(_templateObject3, CSS_PREFIX);\n\t                        _context3.t8 = form;\n\t                        return _context3.abrupt(\"return\", (0, _context3.t0)(\"\", _context3.t1, _context3.t6, _context3.t7, _context3.t8));\n\t\n\t                    case 18:\n\t                    case \"end\":\n\t                        return _context3.stop();\n\t                }\n\t            }\n\t        }, _callee3, this);\n\t    }));\n\t\n\t    return function genHtml() {\n\t        return _ref2.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar readAccList = function () {\n\t    var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n\t        var list;\n\t        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n\t            while (1) {\n\t                switch (_context4.prev = _context4.next) {\n\t                    case 0:\n\t                        _context4.next = 2;\n\t                        return ls.get(ACC_LIST_KEY);\n\t\n\t                    case 2:\n\t                        list = _context4.sent;\n\t\n\t                        if (list) {\n\t                            _context4.next = 10;\n\t                            break;\n\t                        }\n\t\n\t                        _context4.next = 6;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 6:\n\t                        _context4.t0 = _context4.sent.me;\n\t                        _context4.t1 = _currentUserId.authToken;\n\t                        _context4.t2 = {\n\t                            username: _context4.t0,\n\t                            token: _context4.t1\n\t                        };\n\t                        list = [_context4.t2];\n\t\n\t                    case 10:\n\t                        return _context4.abrupt(\"return\", list);\n\t\n\t                    case 11:\n\t                    case \"end\":\n\t                        return _context4.stop();\n\t                }\n\t            }\n\t        }, _callee4, this);\n\t    }));\n\t\n\t    return function readAccList() {\n\t        return _ref6.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar addAccount = function () {\n\t    var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(username, token) {\n\t        var list;\n\t        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n\t            while (1) {\n\t                switch (_context5.prev = _context5.next) {\n\t                    case 0:\n\t                        _context5.next = 2;\n\t                        return readAccList();\n\t\n\t                    case 2:\n\t                        list = _context5.sent;\n\t\n\t                        if (!list.some(function (a) {\n\t                            return a.username === username;\n\t                        })) {\n\t                            _context5.next = 5;\n\t                            break;\n\t                        }\n\t\n\t                        return _context5.abrupt(\"return\");\n\t\n\t                    case 5:\n\t                        list.push({ username: username, token: token });\n\t                        _context5.next = 8;\n\t                        return ls.set(ACC_LIST_KEY, list);\n\t\n\t                    case 8:\n\t                    case \"end\":\n\t                        return _context5.stop();\n\t                }\n\t            }\n\t        }, _callee5, this);\n\t    }));\n\t\n\t    return function addAccount(_x, _x2) {\n\t        return _ref7.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar accountClicked = function () {\n\t    var _ref10 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(el) {\n\t        var username, token;\n\t        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n\t            while (1) {\n\t                switch (_context7.prev = _context7.next) {\n\t                    case 0:\n\t                        username = el.dataset['username'];\n\t                        _context7.t0 = username;\n\t                        _context7.next = 4;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 4:\n\t                        _context7.t1 = _context7.sent.me;\n\t\n\t                        if (!(_context7.t0 === _context7.t1)) {\n\t                            _context7.next = 7;\n\t                            break;\n\t                        }\n\t\n\t                        return _context7.abrupt(\"return\");\n\t\n\t                    case 7:\n\t                        token = null;\n\t                        _context7.next = 10;\n\t                        return readAccList();\n\t\n\t                    case 10:\n\t                        _context7.t2 = function (a) {\n\t                            if (a.username === username) {\n\t                                token = a.token;\n\t                                return true;\n\t                            }\n\t                            return false;\n\t                        };\n\t\n\t                        _context7.sent.some(_context7.t2);\n\t\n\t                        if (token) {\n\t                            lb.showContent(\"Please wait\\u2026\");\n\t                            localStorage.setItem(_currentUserId.cookieName, token);\n\t                            location.reload();\n\t                        }\n\t\n\t                    case 13:\n\t                    case \"end\":\n\t                        return _context7.stop();\n\t                }\n\t            }\n\t        }, _callee7, this);\n\t    }));\n\t\n\t    return function accountClicked(_x3) {\n\t        return _ref10.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar _templateObject = _taggedTemplateLiteral([\"\\n        <p>Please enter username and password of your other account:</p>\\n        <p><input class=\\\"form-control\\\" type=\\\"text\\\" name=\\\"username\\\" placeholder=\\\"Username\\\" required></p>\\n        <p><input class=\\\"form-control\\\" type=\\\"password\\\" name=\\\"password\\\" placeholder=\\\"Password\\\" required></p>\\n        <p><button type=\\\"submit\\\" class=\\\"btn btn-default\\\">Add</button></p>\\n        \"], [\"\\n        <p>Please enter username and password of your other account:</p>\\n        <p><input class=\\\"form-control\\\" type=\\\"text\\\" name=\\\"username\\\" placeholder=\\\"Username\\\" required></p>\\n        <p><input class=\\\"form-control\\\" type=\\\"password\\\" name=\\\"password\\\" placeholder=\\\"Password\\\" required></p>\\n        <p><button type=\\\"submit\\\" class=\\\"btn btn-default\\\">Add</button></p>\\n        \"]),\n\t    _templateObject2 = _taggedTemplateLiteral([\"<div class=\\\"\", \"header\\\">Switch account to:</div>\"], [\"<div class=\\\"\", \"header\\\">Switch account to:</div>\"]),\n\t    _templateObject3 = _taggedTemplateLiteral([\"<div class=\\\"\", \"add-new\\\"><a><i class=\\\"fa fa-plus\\\"></i> Add new account</a></div>\"], [\"<div class=\\\"\", \"add-new\\\"><a><i class=\\\"fa fa-plus\\\"></i> Add new account</a></div>\"]);\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _crossLocalStorage = __webpack_require__(29);\n\t\n\tvar _crossLocalStorage2 = _interopRequireDefault(_crossLocalStorage);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tvar _htmlTpl = __webpack_require__(17);\n\t\n\tvar _lightbox = __webpack_require__(26);\n\t\n\tvar _lightbox2 = _interopRequireDefault(_lightbox);\n\t\n\tvar _iAm = __webpack_require__(10);\n\t\n\tvar _iAm2 = _interopRequireDefault(_iAm);\n\t\n\tvar _api = __webpack_require__(11);\n\t\n\tvar api = _interopRequireWildcard(_api);\n\t\n\tvar _userpics = __webpack_require__(12);\n\t\n\tvar _currentUserId = __webpack_require__(9);\n\t\n\tvar _closestParent = __webpack_require__(23);\n\t\n\tvar _closestParent2 = _interopRequireDefault(_closestParent);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"switch-accounts\");\n\t\n\tvar CSS_PREFIX = \"bf2-switch-dlg-\";\n\tvar ACC_LIST_KEY = \"bfAccounts-freefeed.net\";\n\tvar clickHandlers = [{ selector: \".\" + CSS_PREFIX + \"del\", handler: removeAccount }, { selector: \".\" + CSS_PREFIX + \"account\", handler: accountClicked }, { selector: \".\" + CSS_PREFIX + \"add-new\", handler: addAccountClicked }];\n\t\n\tvar ls = null;\n\t\n\t_module.init(function () {\n\t    ls = new _crossLocalStorage2.default();\n\t\n\t    document.body.addEventListener(\"click\", function (e) {\n\t        clickHandlers.some(function (h) {\n\t            var t = (0, _closestParent2.default)(e.target, h.selector, true);\n\t            if (t) {\n\t                e.preventDefault();\n\t                h.handler(t);\n\t                return true;\n\t            }\n\t            return false;\n\t        });\n\t    });\n\t});\n\t\n\t_module.watch(\".logged-in > .avatar, .logged-in > .userpic\", function (node) {\n\t    node.appendChild((0, _html2.default)(\".bf2-switch-acc\", { title: \"Switch account\" }, (0, _html2.default)(\"span.bf2-switch-acc__icon\"))).addEventListener(\"click\", showSwitchDialog);\n\t});\n\t\n\tvar lb = null;\n\t\n\tfunction addAccountClicked(el) {\n\t    el.style.display = \"none\";\n\t    document.body.querySelector(\".\" + CSS_PREFIX + \"new-form\").style.display = \"block\";\n\t}\n\t\n\tfunction removeAccount(el) {\n\t    var _this2 = this;\n\t\n\t    if (!confirm(\"Are you sure?\")) return Promise.resolve();\n\t    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {\n\t        var _ref9, me, username, list;\n\t\n\t        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n\t            while (1) {\n\t                switch (_context6.prev = _context6.next) {\n\t                    case 0:\n\t                        _context6.next = 2;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 2:\n\t                        _ref9 = _context6.sent;\n\t                        me = _ref9.me;\n\t                        username = (0, _closestParent2.default)(el, \".\" + CSS_PREFIX + \"account\").dataset['username'];\n\t\n\t                        if (!(username === me)) {\n\t                            _context6.next = 7;\n\t                            break;\n\t                        }\n\t\n\t                        return _context6.abrupt(\"return\");\n\t\n\t                    case 7:\n\t                        _context6.next = 9;\n\t                        return readAccList();\n\t\n\t                    case 9:\n\t                        _context6.t0 = function (a) {\n\t                            return a.username !== username;\n\t                        };\n\t\n\t                        list = _context6.sent.filter(_context6.t0);\n\t\n\t                        if (!(list.length === 1 && list[0].username === me)) {\n\t                            _context6.next = 16;\n\t                            break;\n\t                        }\n\t\n\t                        _context6.next = 14;\n\t                        return ls.set(ACC_LIST_KEY, null);\n\t\n\t                    case 14:\n\t                        _context6.next = 18;\n\t                        break;\n\t\n\t                    case 16:\n\t                        _context6.next = 18;\n\t                        return ls.set(ACC_LIST_KEY, list);\n\t\n\t                    case 18:\n\t                        _context6.t1 = lb;\n\t                        _context6.next = 21;\n\t                        return genHtml();\n\t\n\t                    case 21:\n\t                        _context6.t2 = _context6.sent;\n\t\n\t                        _context6.t1.showContent.call(_context6.t1, _context6.t2);\n\t\n\t                    case 23:\n\t                    case \"end\":\n\t                        return _context6.stop();\n\t                }\n\t            }\n\t        }, _callee6, _this2);\n\t    }))();\n\t}\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _messageRpc = __webpack_require__(21);\n\t\n\tvar _messageRpc2 = _interopRequireDefault(_messageRpc);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar frameSrc = \"https://davidmz.github.io/BetterFeed2/storage.html?_=\" + Math.random();\n\tvar frameOrigin = \"https://davidmz.github.io\";\n\t\n\tvar _class = function () {\n\t    function _class() {\n\t        _classCallCheck(this, _class);\n\t\n\t        this.iframe = document.createElement(\"iframe\");\n\t        this.iframe.src = frameSrc;\n\t        this.iframe.style.cssText = \"visibility: hidden;\\n            position: absolute;\\n            left: 0; top: 0;\\n            height:0; width:0;\\n            border: none;\";\n\t        // this.iframe.addEventListener(\"load\", e => console.log(e));\n\t        document.body.appendChild(this.iframe);\n\t        this.msg = new _messageRpc2.default(this.iframe.contentWindow, frameOrigin);\n\t    }\n\t\n\t    _createClass(_class, [{\n\t        key: \"get\",\n\t        value: function get(key) {\n\t            return this.msg.send(\"get\", key);\n\t        }\n\t    }, {\n\t        key: \"set\",\n\t        value: function set(key, value) {\n\t            return this.msg.send(\"set\", { key: key, value: value });\n\t        }\n\t    }]);\n\n\t    return _class;\n\t}();\n\n\texports.default = _class;\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _module = (0, _modules.registerModule)(\"no-read-more\", false);\n\t\n\t_module.watch(\"a.read-more\", function (a) {\n\t  return a.click();\n\t});\n\t\n\t_module.watch(\".expand-button > i\", function (a) {\n\t  return a.click();\n\t});\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tvar _userpics = __webpack_require__(12);\n\t\n\tvar _iAm = __webpack_require__(10);\n\t\n\tvar _iAm2 = _interopRequireDefault(_iAm);\n\t\n\t__webpack_require__(32);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"comment-clouds\");\n\t\n\tvar usersWithAvatars = new Map();\n\tvar withAvatars = false;\n\tvar style = null;\n\t\n\t_module.init(function (settings) {\n\t    style = document.head.appendChild((0, _html2.default)(\"style.bf2-comments-avatars\")).sheet;\n\t    withAvatars = settings.commentCloudsMode === 2;\n\t    if (withAvatars) {\n\t        document.body.classList.add(\"bf2-comments-with-avatars\");\n\t    }\n\t});\n\t\n\t_module.watch(\".comment[data-author]\", function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(node) {\n\t        var author, pic;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        if (!(node.querySelector(\".bf2-comment-ex\") || node.classList.contains(\"is-hidden\"))) {\n\t                            _context.next = 2;\n\t                            break;\n\t                        }\n\t\n\t                        return _context.abrupt(\"return\");\n\t\n\t                    case 2:\n\t                        if (!withAvatars) {\n\t                            _context.next = 20;\n\t                            break;\n\t                        }\n\t\n\t                        author = node.dataset[\"author\"];\n\t\n\t                        node.appendChild((0, _html2.default)(\".bf2-comment-avatar.bf2-comment-ex\"));\n\t\n\t                        if (usersWithAvatars.has(author)) {\n\t                            _context.next = 18;\n\t                            break;\n\t                        }\n\t\n\t                        usersWithAvatars.set(author, true);\n\t                        _context.t0 = _userpics.getPic;\n\t                        _context.t1 = author;\n\t\n\t                        if (_context.t1) {\n\t                            _context.next = 13;\n\t                            break;\n\t                        }\n\t\n\t                        _context.next = 12;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 12:\n\t                        _context.t1 = _context.sent.me;\n\t\n\t                    case 13:\n\t                        _context.t2 = _context.t1;\n\t                        _context.next = 16;\n\t                        return (0, _context.t0)(_context.t2);\n\t\n\t                    case 16:\n\t                        pic = _context.sent;\n\t\n\t                        style.insertRule(\".comment[data-author=\\\"\" + author + \"\\\"] .bf2-comment-avatar { background-image: url(\" + pic + \"); }\", 0);\n\t\n\t                    case 18:\n\t                        _context.next = 21;\n\t                        break;\n\t\n\t                    case 20:\n\t                        node.appendChild((0, _html2.default)(\"i.fa.fa-comment.icon.bf2-ico-bg.bf2-comment-ex\"));\n\t\n\t                    case 21:\n\t                    case \"end\":\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, undefined);\n\t    }));\n\t\n\t    return function (_x) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}());\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(33);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(5)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\", function() {\n\t\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(3)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".comment .comment-icon:not(.fa-stack){position:relative;top:-2px;left:-1px;z-index:1}.comment-likes .comment-likes-list{z-index:2}.bf2-ico-bg{position:absolute;top:0;left:0;color:#fff;display:none}.comment[data-comm-props~=from] .bf2-ico-bg{display:block}.comment[data-comm-props~=from-reader] .bf2-ico-bg{color:#ededed}.comment[data-comm-props~=from-friend] .bf2-ico-bg{color:#cef4fc}.comment[data-comm-props~=from-post-author] .bf2-ico-bg{color:#b5b5b5}.comment[data-comm-props~=from-me] .bf2-ico-bg{color:#ffd061}.comment.omit-bubble .bf2-ico-bg{display:none}.bf2-comment-avatar{position:absolute;width:16px;height:16px;background-size:cover;top:0;left:-4px;z-index:1;background-color:#fff;border-radius:50%;border:1px solid #ccc;box-sizing:content-box;pointer-events:none}.comment.omit-bubble .bf2-comment-avatar{display:none}.bf2-gamma-frontend .highlighted .bf2-comment-avatar{top:4px;left:3px}.bf2-comments-with-avatars .comment-time{margin-right:5px}.bf2-comments-with-avatars .feed-comment-dot:after{margin-top:1px}.bf2-comments-with-avatars .comment{margin-top:10px}.bf2-comments-with-avatars .bf2-likecomm-shift{left:-9px}.bf2-comments-with-avatars .likes{position:relative;left:-2px}.bf2-comments-with-avatars .likes .icon{margin-right:7px}.bf2-comments-with-avatars .fold-comments-sticky{z-index:2}.bf2-comments-with-avatars .fold-comments-sticky i{left:-2px}.bf2-gamma-frontend.bf2-comments-with-avatars .comment.highlighted{margin-top:6px}\", \"\"]);\n\t\n\t// exports\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"hide-arabic\", false);\n\t\n\tvar style = null;\n\t\n\t_module.init(function () {\n\t    style = document.head.appendChild((0, _html2.default)(\"style.bf2-hide-posts\")).sheet;\n\t    style.insertRule(\".bf2-aggregate-page .bf2-lang-arabic { display: none; }\", 0);\n\t});\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _textWalk = __webpack_require__(36);\n\t\n\tvar _textWalk2 = _interopRequireDefault(_textWalk);\n\t\n\tvar _escapeHtml = __webpack_require__(18);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tvar _matches = __webpack_require__(8);\n\t\n\tvar _matches2 = _interopRequireDefault(_matches);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"hanging-punct\");\n\t\n\tvar helper = void 0;\n\t\n\t_module.init(function () {\n\t    helper = document.createElement(\"div\");\n\t});\n\t\n\tvar re = /(^|\\s)([(«“-]|&quot;)/g;\n\t\n\t_module.watch(\".post-text, .comment-body\", function (node) {\n\t    if ((0, _matches2.default)(node, \".comment-body\")) {\n\t        var userNames = node.querySelectorAll(\".user-name-wrapper\");\n\t        var lastUserName = userNames[userNames.length - 1];\n\t        if (lastUserName && lastUserName.nextElementSibling) {\n\t            var actions = lastUserName.nextElementSibling;\n\t            (0, _textWalk2.default)(actions, function (node) {\n\t                if (node.nodeValue === \"(\") {\n\t                    node.nodeValue = \" (\";\n\t                }\n\t            });\n\t        }\n\t    }\n\t    (0, _textWalk2.default)(node, function (node) {\n\t        if (node.parentNode.classList.contains(\"bf2-hp\")) {\n\t            return;\n\t        }\n\t        var html = (0, _escapeHtml2.default)(node.nodeValue);\n\t        if (!re.test(html)) {\n\t            return;\n\t        }\n\t        html = html.replace(re, '<span class=\"bf2-hp bf2-hp-pre bf2-hp-pre-$2\">$1</span><span class=\"bf2-hp bf2-hp-$2\">$2</span>');\n\t        helper.innerHTML = html;\n\t        while (helper.firstChild) {\n\t            node.parentNode.insertBefore(helper.firstChild, node);\n\t        }\n\t        node.parentNode.removeChild(node);\n\t    });\n\t});\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = textWalk;\n\t/**\r\n\t *\r\n\t * @param {Node} node\r\n\t * @param {function} foo\r\n\t */\n\tfunction textWalk(node, foo) {\n\t    if (node.nodeType === Node.TEXT_NODE) {\n\t        foo(node);\n\t    } else if (node.nodeType === Node.ELEMENT_NODE) {\n\t        var c = node.firstChild;\n\t        while (c) {\n\t            var next = c.nextSibling;\n\t            textWalk(c, foo);\n\t            c = next;\n\t        }\n\t    }\n\t}\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _module = (0, _modules.registerModule)(\"show-timestamps\", false);\n\t\n\t_module.watch(\".post-lock-icon\", function (t) {\n\t    var event = document.createEvent(\"MouseEvents\");\n\t    event.initEvent(\"click\", true, true);\n\t    t.dispatchEvent(event);\n\t});\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// better-feed.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 089771b078c4b9b6ee91","import \"../styles/common.less\";\r\nimport {startObserver} from \"./base/modules\";\r\nimport {userId} from \"./utils/current-user-id\";\r\nimport IAm from \"./utils/i-am\";\r\nimport docLoaded from \"./utils/doc-loaded\";\r\nimport Settings from \"./base/settings\";\r\nimport Messenger from \"./utils/message-rpc\";\r\n\r\nimport \"./modules/common\";\r\nimport \"./modules/settings-link\";\r\n\r\n// import \"./modules/ani-gifs\";\r\nimport \"./modules/moon\";\r\nimport \"./modules/switch-accounts\";\r\nimport \"./modules/no-read-more\";\r\nimport \"./modules/comment-clouds\";\r\nimport \"./modules/hide-arabic\";\r\nimport \"./modules/hanging-punct\";\r\nimport \"./modules/show-timestamps\";\r\n\r\nif (!/^\\/(attachments\\/|files\\/|bookmarklet|v\\d\\/)/.test(location.pathname)) {\r\n    if (!MutationObserver || !Promise) {\r\n        console.error(\"Can not start BetterFeed: MutationObserver & Promise not supported\");\r\n    } else if (userId === null) {\r\n        console.error(\"Can not start BetterFeed: user not logged in\");\r\n    } else if (\"__BetterFeed\" in window) {\r\n        console.warn(\"BetterFeed already started\");\r\n    } else {\r\n        window.__BetterFeed = true;\r\n        Promise.all([IAm.ready, docLoaded]).then(([iAm])=> {\r\n            start(new Settings(iAm.bf2Props));\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * @param {Settings} settings\r\n */\r\nfunction start(settings) {\r\n    startObserver(settings);\r\n\r\n    const msg = new Messenger();\r\n\r\n    msg.on(\"getSettings\", () => settings.toJSON());\r\n\r\n    msg.on(\"saveSettings\", async(o) => {\r\n        const iAm = await IAm.ready;\r\n        await iAm.saveProps(new Settings(o));\r\n        location.reload(true);\r\n    });\r\n\r\n    msg.on(\"checkUpdates\", checkUpdates);\r\n}\r\n\r\nfunction checkUpdates() {\r\n    const now = Date.now();\r\n    const oldVersion = process.env.BF2_VERSION;\r\n    localStorage[\"bf2-next-update\"] = now + 3600 * 1000;\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open('GET', 'https://api.github.com/repos/davidmz/BetterFeed2/tags?page=1&per_page=1');\r\n    xhr.responseType = \"json\";\r\n    xhr.onload = () => {\r\n        try {\r\n            const tags = xhr.response;\r\n            if (tags.length === 1 && \"name\" in tags[0]) {\r\n                const newVersion = tags[0][\"name\"];\r\n                localStorage[\"bf2-version\"] = newVersion;\r\n                localStorage[\"bf2-next-update\"] = now + 24 * 3600 * 1000;\r\n                if (newVersion !== oldVersion) {\r\n                    if (confirm(`Доступна новая версия: ${newVersion}. Она будет установлена после перезагрузки страницы.\\n\\nПерезагрузить страницу сейчас?`)) {\r\n                        location.reload(true);\r\n                    }\r\n                } else {\r\n                    alert(`У вас установлена последняя версия (${newVersion})`);\r\n                }\r\n            }\r\n        } catch (e) {\r\n        }\r\n    };\r\n    xhr.send();\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/better-feed.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\", function() {\n\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles/common.less\n// module id = 1\n// module chunks = 0","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".bf2-lightbox-container{left:0;top:0;width:100%;height:100%;position:fixed;z-index:10}.bf2-lightbox-shadow{left:0;top:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.5)}.bf2-lightbox-content{position:relative;border:1px solid #000;background-color:#ccc;box-shadow:0 0 50px rgba(0,0,0,.5)}.bf2-settings-lightbox .bf2-lightbox-content{width:90vw;height:90vh;max-width:800px}.bf2-settings-lightbox .bf2-lightbox-content iframe{left:0;top:0;width:100%;height:100%}.bf2-access-token-lightbox .bf2-lightbox-content{background-color:#fff;max-width:90vw;padding:2em}.bf2-access-token-lightbox .bf2-lightbox-content button{padding:.25em 2em;cursor:pointer}.bf2-access-token-lightbox .bf2-lightbox-content .bf2-access-token{word-wrap:break-word;font-family:monospace;color:#069;background-color:#eee;padding:1em}.bf2-green{padding:1em}.bf2-via-names{font-size:12px}.bf2-hide-aliens-cont{font-size:14px;font-weight:400;margin-left:1em;display:none}.bf2-homepage .bf2-hide-aliens-cont{display:inline}.bf2-hide-aliens .bf2-alien-post{display:none}.bf2-saving-settings-indicator{position:fixed;top:.66em;right:1em;background:#f66;color:#fff;padding:.25em 1em;border-radius:4px;z-index:100}.bf2-animated-gif{position:relative;display:inline-block}.bf2-animated-gif:after{content:\\\"\\\\25B6   GIF\\\";position:absolute;bottom:3px;right:4px;background-color:#069;color:#eee;font-weight:700;padding:.1em .4em;border-radius:3px;font-size:11px;line-height:normal}.arrow-span{padding:0 .2em}.bf2-moon{width:18px;height:18px;margin-left:4px;margin-bottom:10px}.bf2-moon-shadow{fill:#666}.bf2-moon-light{fill:#f5eed9}.bf2-moon-cont{display:inline-block}.bf2-switch-acc{color:#ccc;cursor:pointer;text-align:center}.bf2-switch-acc:hover{background-color:#eee;color:#000}.bf2-switch-acc__icon{display:inline-block;background:url(\" + require(\"./fa-exchange.svg\") + \") no-repeat;background-size:contain;width:14px;height:14px;opacity:.4}.bf2-switch-account-box .bf2-lightbox-content{width:360px;height:auto;cursor:auto;border:1px solid #000;box-shadow:1px 1px 10px rgba(0,0,0,.5);background-color:#fff;padding:1em}.bf2-switch-dlg-header{font-size:120%}.bf2-switch-dlg-accounts{margin:1em 0}.bf2-switch-dlg-account{cursor:pointer;font-weight:700;border:1px solid #ddd;margin:.5em 0;position:relative}.bf2-switch-dlg-account.-current,.bf2-switch-dlg-account:hover{background-color:#eee}.bf2-switch-dlg-account.-current{cursor:not-allowed}.bf2-switch-dlg-account.-current .bf2-switch-dlg-del{display:none}.bf2-switch-dlg-upic{width:50px;height:50px;margin-right:1em;border-right:1px solid #ddd}.bf2-switch-dlg-new-form{display:none}.bf2-switch-dlg-del{position:absolute;right:0;top:50%;width:20px;height:20px;line-height:20px;text-align:center;margin-top:-10px}.bf2-switch-dlg-del:hover{color:#c00}.box{clear:both}.bf2-lightboxed-images .image-attachments a{cursor:zoom-in}.bf2-search-highlight{background-color:#ffff80}.bf2-hp-pre:empty{display:none}.bf2-hp-pre-\\\\({margin-right:.13em}.bf2-hp-\\\\({margin-left:-.13em}.bf2-hp-pre-«{margin-right:.2em}.bf2-hp-«{margin-left:-.2em}.bf2-hp-pre-\\\\\\\"{margin-right:.2em}.bf2-hp-\\\\\\\"{margin-left:-.2em}.bf2-hp-pre-“{margin-right:.33em}.bf2-hp-“{margin-left:-.33em}.bf2-hp-pre--{margin-right:.1em}.bf2-hp--{margin-left:-.1em}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./~/less-loader!./src/styles/common.less\n// module id = 2\n// module chunks = 0","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\n// css base code, injected by the css-loader\r\nmodule.exports = function() {\r\n\tvar list = [];\r\n\r\n\t// return the list of modules as css string\r\n\tlist.toString = function toString() {\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar item = this[i];\r\n\t\t\tif(item[2]) {\r\n\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t} else {\r\n\t\t\t\tresult.push(item[1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result.join(\"\");\r\n\t};\r\n\r\n\t// import a list of modules into the list\r\n\tlist.i = function(modules, mediaQuery) {\r\n\t\tif(typeof modules === \"string\")\r\n\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\tvar alreadyImportedModules = {};\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar id = this[i][0];\r\n\t\t\tif(typeof id === \"number\")\r\n\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t}\r\n\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\tvar item = modules[i];\r\n\t\t\t// skip already imported module\r\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(item);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\treturn list;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader/lib/css-base.js\n// module id = 3\n// module chunks = 0","module.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjxzdmcgd2lkdGg9IjE3OTIiIGhlaWdodD0iMTc5MiIgdmlld0JveD0iMCAwIDE3OTIgMTc5MiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgICA8cGF0aCBkPSJNMTc5MiAxMTg0djE5MnEwIDEzLTkuNSAyMi41dC0yMi41IDkuNWgtMTM3NnYxOTJxMCAxMy05LjUgMjIuNXQtMjIuNSA5LjVxLTEyIDAtMjQtMTBsLTMxOS0zMjBxLTktOS05LTIyIDAtMTQgOS0yM2wzMjAtMzIwcTktOSAyMy05IDEzIDAgMjIuNSA5LjV0OS41IDIyLjV2MTkyaDEzNzZxMTMgMCAyMi41IDkuNXQ5LjUgMjIuNXptMC01NDRxMCAxNC05IDIzbC0zMjAgMzIwcS05IDktMjMgOS0xMyAwLTIyLjUtOS41dC05LjUtMjIuNXYtMTkyaC0xMzc2cS0xMyAwLTIyLjUtOS41dC05LjUtMjIuNXYtMTkycTAtMTMgOS41LTIyLjV0MjIuNS05LjVoMTM3NnYtMTkycTAtMTQgOS0yM3QyMy05cTEyIDAgMjQgMTBsMzE5IDMxOXE5IDkgOSAyM3oiLz4NCjwvc3ZnPg==\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles/fa-exchange.svg\n// module id = 4\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nvar stylesInDom = {},\n\tmemoize = function(fn) {\n\t\tvar memo;\n\t\treturn function () {\n\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\t\treturn memo;\n\t\t};\n\t},\n\tisOldIE = memoize(function() {\n\t\treturn /msie [6-9]\\b/.test(self.navigator.userAgent.toLowerCase());\n\t}),\n\tgetHeadElement = memoize(function () {\n\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\n\t}),\n\tsingletonElement = null,\n\tsingletonCounter = 0,\n\tstyleElementsInsertedAtTop = [];\n\nmodule.exports = function(list, options) {\n\tif(typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the bottom of <head>.\n\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list);\n\taddStylesToDom(styles, options);\n\n\treturn function update(newList) {\n\t\tvar mayRemove = [];\n\t\tfor(var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\t\tfor(var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\n\t\t\t\t\tdomStyle.parts[j]();\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n}\n\nfunction addStylesToDom(styles, options) {\n\tfor(var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles(list) {\n\tvar styles = [];\n\tvar newStyles = {};\n\tfor(var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\t\tif(!newStyles[id])\n\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse\n\t\t\tnewStyles[id].parts.push(part);\n\t}\n\treturn styles;\n}\n\nfunction insertStyleElement(options, styleElement) {\n\tvar head = getHeadElement();\n\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\n\tif (options.insertAt === \"top\") {\n\t\tif(!lastStyleElementInsertedAtTop) {\n\t\t\thead.insertBefore(styleElement, head.firstChild);\n\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\thead.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\thead.appendChild(styleElement);\n\t\t}\n\t\tstyleElementsInsertedAtTop.push(styleElement);\n\t} else if (options.insertAt === \"bottom\") {\n\t\thead.appendChild(styleElement);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement(styleElement) {\n\tstyleElement.parentNode.removeChild(styleElement);\n\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\n\tif(idx >= 0) {\n\t\tstyleElementsInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement(options) {\n\tvar styleElement = document.createElement(\"style\");\n\tstyleElement.type = \"text/css\";\n\tinsertStyleElement(options, styleElement);\n\treturn styleElement;\n}\n\nfunction createLinkElement(options) {\n\tvar linkElement = document.createElement(\"link\");\n\tlinkElement.rel = \"stylesheet\";\n\tinsertStyleElement(options, linkElement);\n\treturn linkElement;\n}\n\nfunction addStyle(obj, options) {\n\tvar styleElement, update, remove;\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\n\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\n\t} else if(obj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\") {\n\t\tstyleElement = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, styleElement);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t\tif(styleElement.href)\n\t\t\t\tURL.revokeObjectURL(styleElement.href);\n\t\t};\n\t} else {\n\t\tstyleElement = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, styleElement);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle(newObj) {\n\t\tif(newObj) {\n\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\n\t\t\t\treturn;\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag(styleElement, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = styleElement.childNodes;\n\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\n\t\tif (childNodes.length) {\n\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyleElement.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag(styleElement, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyleElement.setAttribute(\"media\", media)\n\t}\n\n\tif(styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = css;\n\t} else {\n\t\twhile(styleElement.firstChild) {\n\t\t\tstyleElement.removeChild(styleElement.firstChild);\n\t\t}\n\t\tstyleElement.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink(linkElement, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\tif(sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = linkElement.href;\n\n\tlinkElement.href = URL.createObjectURL(blob);\n\n\tif(oldSrc)\n\t\tURL.revokeObjectURL(oldSrc);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/style-loader/addStyles.js\n// module id = 5\n// module chunks = 0","import forSelect from \"../utils/for-select\";\r\n\r\nexport const registeredModules = new Map(); // name → module\r\n\r\nclass Module {\r\n    constructor(name, enabledByDefault = true, alwaysEnabled = false) {\r\n        this.name = name;\r\n        this.alwaysEnabled = alwaysEnabled;\r\n        this.enabledByDefault = enabledByDefault;\r\n        this.requiredModules = [];\r\n        /**\r\n         * Флаг, позволяющий отключить активность модуля, даже если он разрешён в настройках.\r\n         * Например, если фронтенд или браузер не поддерживает необходимые фичи.\r\n         * @type {boolean}\r\n         */\r\n        this.active = true;\r\n        this._watchers = [];\r\n        this._initiators = [];\r\n    }\r\n\r\n    init(callback) {\r\n        this._initiators.push(callback);\r\n    }\r\n\r\n    watch(selector, callback) {\r\n        this._watchers.push({selector, callback});\r\n    }\r\n\r\n    required(name) {\r\n        this.requiredModules.push(name);\r\n    }\r\n\r\n    _initiate(settings) {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n        this._initiators.forEach(c => c(settings));\r\n        this._watchers.forEach(({selector, callback}) => forSelect(document.body, selector, n => callback(n, settings)));\r\n    }\r\n\r\n    _trigger(node) {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n        this._watchers.forEach(({selector, callback}) => forSelect(node, selector, n => callback(n, settings)));\r\n    }\r\n}\r\n\r\nexport function registerModule(name, enabledByDefault = true, alwaysEnabled = false) {\r\n    const m = new Module(name, enabledByDefault, alwaysEnabled);\r\n    registeredModules.set(name, m);\r\n    return m;\r\n}\r\n\r\nlet settings = null;\r\n/**\r\n *\r\n * @param {Settings} aSettings\r\n */\r\nexport function startObserver(aSettings) {\r\n    if (settings) {\r\n        return;\r\n    }\r\n    settings = aSettings;\r\n\r\n    registeredModules.forEach(m => {\r\n        if (settings.isModuleEnabled(m)) {\r\n            m._initiate(settings);\r\n        }\r\n    });\r\n\r\n    let observer = new MutationObserver(mutations => {\r\n        mutations.forEach(mutation => {\r\n            for (let i = 0, l = mutation.addedNodes.length; i < l; i++) {\r\n                let node = mutation.addedNodes[i];\r\n                if (node.nodeType == Node.ELEMENT_NODE) {\r\n                    registeredModules.forEach(m => {\r\n                        if (settings.isModuleEnabled(m)) {\r\n                            m._trigger(node, settings);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    observer.observe(document.body, {childList: true, subtree: true});\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/base/modules.js","import matches from \"./matches\";\r\n\r\n/**\r\n * @param {Document|DocumentFragment|Element} node\r\n * @param {string} selector\r\n * @param {function(Node)} [foo]\r\n */\r\nexport default (node, selector, foo) => {\r\n    if (node === null) return [];\r\n    var nodeList = node.querySelectorAll(selector);\r\n    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\r\n    if (matches(node, selector)) nodes.unshift(node);\r\n    if (foo) {\r\n        for (var i = 0, l = nodes.length; i < l; i++) {\r\n            foo(nodes[i]);\r\n        }\r\n    }\r\n    return nodes;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/for-select.js","const matchesMethod = (\"matches\" in HTMLElement.prototype) ? \"matches\" : \"msMatchesSelector\";\r\n\r\n/**\r\n *\r\n * @param {HTMLElement} node\r\n * @param {String} selector\r\n * @return {Boolean}\r\n */\r\nexport default function (node, selector) { return node[matchesMethod](selector); }\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/matches.js","export let userId = null;\r\nexport let authToken = null;\r\n\r\nconst sitesProps = {\r\n    \"freefeed.net\":       {\r\n        cookies: [\"freefeedBETA_authToken\", \"freefeed_authToken\"]\r\n    },\r\n    \"gamma.freefeed.net\": {\r\n        cookies: [\"freefeed_authToken\"]\r\n    }\r\n};\r\n\r\nexport let siteDomain = location.hostname;\r\nexport let cookieName = \"freefeedBETA_authToken\";\r\n\r\nif (siteDomain in sitesProps) {\r\n    sitesProps[siteDomain].cookies.some(cName => {\r\n        [userId, authToken] = getUserIdToken(cName);\r\n        cookieName = cName;\r\n        return userId !== null;\r\n    });\r\n}\r\n\r\n/**\r\n *\r\n * @param {string} cookieName\r\n * @return {Array.<string>} [userId, token]\r\n */\r\nfunction getUserIdToken(cookieName) {\r\n    const cookieValue = localStorage.getItem(cookieName);\r\n    if (cookieValue !== null) {\r\n        const parts = cookieValue.split(\".\");\r\n        if (parts.length === 3) {\r\n            try {\r\n                let payload = JSON.parse(atob(parts[1]));\r\n                if (\"userId\" in payload) {\r\n                    return [payload[\"userId\"], cookieValue];\r\n                }\r\n            } catch (e) {\r\n            }\r\n        }\r\n    }\r\n    return [null, null];\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/current-user-id.js","import * as api from './api';\r\nimport * as uPics from './userpics';\r\nimport h from \"./html\";\r\n\r\nconst prefsName = \"me.davidmz.BetterFeed2\";\r\n\r\nexport default class IAm {\r\n    constructor() {\r\n        this.me = null;\r\n        this.myID = null;\r\n        this.myScreenName = null;\r\n        this.friends = [];\r\n        this.readers = [];\r\n        this.banIds = [];\r\n        this.bf2Props = {};\r\n\r\n        this._savePropsQueue = [];\r\n        this._savingPropsNow = false;\r\n        this._savingIndicator = h(\".bf2-saving-settings-indicator\", \"Saving settings…\");\r\n    }\r\n\r\n    whoIs(username) {\r\n        let flags = 0;\r\n        if (username === this.me) flags |= IAm.ME;\r\n        if (this.friends.indexOf(username) !== -1) flags |= IAm.FRIEND;\r\n        if (this.readers.indexOf(username) !== -1) flags |= IAm.READER;\r\n        return flags;\r\n    }\r\n\r\n    isBanned(userId) {\r\n        return (this.banIds.indexOf(userId) !== -1);\r\n    }\r\n\r\n    /**\r\n     * @param {Settings} s\r\n     */\r\n    saveProps(s) {\r\n        this._savePropsQueue.push(s.toJSON());\r\n        return this._saveProps();\r\n    }\r\n\r\n    /**\r\n     * Последовательное сохранение настроек по очереди\r\n     * @private\r\n     */\r\n    async _saveProps() {\r\n        if (this._savingPropsNow) return;\r\n\r\n        document.body.appendChild(this._savingIndicator);\r\n        this._savingPropsNow = true;\r\n        while (this._savePropsQueue.length > 0) {\r\n            const json = this._savePropsQueue.shift(), nulls = {};\r\n            for (let k in json) if (json.hasOwnProperty(k)) nulls[k] = null;\r\n            await api.put(`/v1/users/${this.myID}`, JSON.stringify({user: {frontendPreferences: {[prefsName]: json}}}));\r\n        }\r\n        this._savingPropsNow = false;\r\n        document.body.removeChild(this._savingIndicator);\r\n    }\r\n}\r\n\r\n\r\nIAm.ME = 1 << 0;\r\nIAm.FRIEND = 1 << 1;\r\nIAm.READER = 1 << 2;\r\n\r\nIAm.ready = null;\r\n\r\nIAm.update = () => {\r\n    IAm.ready = api.get('/v2/users/whoami').then(resp => {\r\n        const iAm = new IAm();\r\n        iAm.me = resp.users.username;\r\n        iAm.myID = resp.users.id;\r\n        iAm.myScreenName = resp.users.screenName;\r\n        uPics.setPic(resp.users.username, resp.users.profilePictureMediumUrl);\r\n        iAm.friends = resp.subscribers.map(it => {\r\n            uPics.setPic(it.username, it.profilePictureMediumUrl);\r\n            return it.username;\r\n        });\r\n        iAm.readers = resp.users.subscribers.map(it => {\r\n            uPics.setPic(it.username, it.profilePictureMediumUrl);\r\n            return it.username;\r\n        });\r\n        iAm.banIds = resp.users.banIds;\r\n        iAm.bf2Props = (resp.users.frontendPreferences[prefsName] || {});\r\n\r\n        return iAm;\r\n    });\r\n};\r\n\r\nIAm.update();\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/i-am.js","import {authToken} from './current-user-id';\r\n\r\nconst apiRoot = \"https://freefeed.net\";\r\n\r\nexport function get(path, token = authToken) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('X-Authentication-Token', token);\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send();\r\n    });\r\n}\r\n\r\nexport function put(path, body) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('PUT', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('X-Authentication-Token', authToken);\r\n        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    });\r\n}\r\n\r\nexport function del(path, body) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('DELETE', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('X-Authentication-Token', authToken);\r\n        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    });\r\n}\r\n\r\nexport function post(path, body) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('POST', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('X-Authentication-Token', authToken);\r\n        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    });\r\n}\r\n\r\nexport function anonFormPost(path, body) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('POST', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    });\r\n}\r\n\r\nfunction apiURL(path) {\r\n    return apiRoot + path + ((path.indexOf(\"?\") !== -1) ? \"&\" : \"?\") + \"_initiator=betterfeed2\";\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/api.js","import bfRoot from \"../utils/bf-root\";\r\nimport \"file?name=[name].[ext]!../../styles/default-userpic-50.png\";\r\n\r\nexport const defaultPic = `${bfRoot}/build/default-userpic-50.png`;\r\nconst picRegistry = new Map;\r\n\r\nasync function picLoad(username) {\r\n    const resp = await (await fetch(`https://davidmz.me/frfrfr/uinfo/upic?username=${username}`)).json();\r\n    return (resp.status === \"ok\" && resp.data !== \"\") ? resp.data : defaultPic;\r\n}\r\n\r\nexport function getPic(username) {\r\n    if (!picRegistry.has(username)) {\r\n        picRegistry.set(username, picLoad(username));\r\n    }\r\n    return picRegistry.get(username);\r\n}\r\n\r\nexport function setPic(username, pic) {\r\n    picRegistry.set(username, Promise.resolve((pic && pic !== \"\") ? pic : defaultPic));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/userpics.js","let myRoot = \"https://davidmz.me/betterfeed-cdn/\" + localStorage['bf2-version'];\r\nif (document.currentScript) {\r\n    let pr = document.currentScript.src.split(\"/\");\r\n    myRoot = pr.slice(0, pr.length - 2).join(\"/\");\r\n}\r\n\r\nexport default myRoot;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/bf-root.js","module.exports = __webpack_public_path__ + \"default-userpic-50.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=[name].[ext]!./src/styles/default-userpic-50.png\n// module id = 14\n// module chunks = 0","import isArray from \"./is-array\";\r\nimport { isSafeHTML } from \"./html-tpl\";\r\n\r\n/**\r\n * h(\"tag.class\", {attr: val}, child)\r\n * h(\"tag.class\", child)\r\n * h(\"tag.class\", {attr: val})\r\n * h(\"tag.class\")\r\n * h(\".class\") // div\r\n * h(\"$\") // document fragment\r\n *\r\n * Класс, заданный через атрибуты, перекрывает классы из строки тегов\r\n *\r\n * @param {String} tagName - tag или tag.class1.class2 (поддерживаются только классы)\r\n * @param {Object} [attrs]\r\n * @param {Node|string|Array} [children]\r\n * @return {HTMLElement}\r\n */\r\nexport default function h(tagName, attrs, children) {\r\n    var i, k;\r\n    var tagParts = tagName.split(\".\");\r\n    var tn = tagParts.shift() || \"div\";\r\n    var el;\r\n    if (tn === \"$\") {\r\n        el = document.createDocumentFragment();\r\n    } else {\r\n        el = document.createElement(tn);\r\n        if (tagParts.length > 0) {\r\n            el.className = tagParts.join(\" \");\r\n        }\r\n    }\r\n\r\n    var chStart = 1;\r\n    if (arguments.length > 1 && typeof attrs === \"object\" && !(attrs instanceof Node) && !isArray(attrs) && !isSafeHTML(attrs)) {\r\n        for (k in attrs) if (attrs.hasOwnProperty(k)) el.setAttribute(k, attrs[k]);\r\n        chStart = 2;\r\n    }\r\n\r\n    if (arguments.length > chStart) {\r\n        for (i = chStart; i < arguments.length; i++) {\r\n            append(el, arguments[i]);\r\n        }\r\n    }\r\n    return el;\r\n};\r\n\r\nfunction append(el, it) {\r\n    if (it instanceof Node) {\r\n        el.appendChild(it);\r\n    } else if (isArray(it)) {\r\n        it.forEach(append.bind(null, el));\r\n    } else if (typeof it === \"string\") {\r\n        el.appendChild(document.createTextNode(it));\r\n    } else if (isSafeHTML(it)) {\r\n        el.insertAdjacentHTML('beforeEnd', it.toString())\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/html.js","export default Array.isArray || function (arr) {\r\n    return Object.prototype.toString.call(arr) == '[object Array]';\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/is-array.js","import escapeHTML from \"./escape-html\";\r\n\r\nclass SafeHTML {\r\n    constructor(text) { this.text = text; }\r\n\r\n    toString() { return this.text; }\r\n}\r\n\r\nexport function safeHTML(text) { return new SafeHTML(text); }\r\n\r\nexport function isSafeHTML(h) { return (h instanceof SafeHTML); }\r\n\r\nexport function html(tpl, ...args) {\r\n    return safeHTML(tpl.reduce((acc, part, i) => {\r\n        let a = args[i - 1];\r\n        return acc + (isSafeHTML(a) ? a : escapeHTML(a)) + part;\r\n    }));\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/html-tpl.js","/**\r\n * @param {string} s\r\n * @return {string}\r\n */\r\nexport default function (s = \"\") {\r\n    return s.replace(/&/g, \"&amp;\")\r\n        .replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")\r\n        .replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/escape-html.js","export default new Promise(function (resolve) {\r\n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\r\n        setTimeout(resolve, 0);\r\n    } else {\r\n        document.addEventListener(\"DOMContentLoaded\", resolve);\r\n    }\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/doc-loaded.js","import {registeredModules} from \"./modules\";\r\n\r\nexport default class Settings {\r\n\r\n    constructor(o = null, trustedData = false) {\r\n        this.modules = new Map;\r\n        registeredModules.forEach(m => {\r\n            if (!m.alwaysEnabled) {\r\n                this.modules.set(m.name, m.enabledByDefault);\r\n            }\r\n        });\r\n\r\n        this.hideAliens = false;\r\n        this.commentCloudsMode = 2;\r\n\r\n        // инициализация из объекта\r\n        if (o) {\r\n            (o.modules || []).forEach(([k, v]) => {\r\n                if (trustedData || this.modules.has(k)) {\r\n                    this.modules.set(k, !!v);\r\n                }\r\n            });\r\n            this.hideAliens = !!o.hideAliens;\r\n            if (o.commentCloudsMode === 1 || o.commentCloudsMode === 2) {\r\n                this.commentCloudsMode = o.commentCloudsMode;\r\n            }\r\n        }\r\n    }\r\n\r\n     toJSON() {\r\n        const o = {modules: []};\r\n        this.modules.forEach((v, k) => o.modules.push([k, v]));\r\n        o.hideAliens = this.hideAliens;\r\n        o.commentCloudsMode = this.commentCloudsMode;\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * @param {Module} m\r\n     * @return {boolean}\r\n     */\r\n    isModuleEnabled(m) {\r\n        return (\r\n            m\r\n            && (m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name))\r\n            && !m.requiredModules.map(name => registeredModules.get(name)).some(m => !this.isModuleEnabled(m))\r\n        );\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/base/settings.js","let nextRequestId = 1;\r\n\r\nconst responseAction = \"@response\";\r\n\r\nexport default class Messenger {\r\n\r\n    constructor(parentWindow = null, parentOrigin = \"\") {\r\n        this.__responders = new Map();\r\n        this.__listeners = new Map();\r\n\r\n        this.defaultWindow = parentWindow;\r\n        this.defaultOrigin = parentOrigin;\r\n\r\n        window.addEventListener('message', event => {\r\n            if (typeof event.data !== \"object\") {\r\n                return;\r\n            }\r\n            //noinspection UnnecessaryLocalVariableJS\r\n            const {data:{action, requestId, value}, source, origin} = event;\r\n\r\n            if (action === responseAction && this.__responders.has(requestId)) {\r\n                this.__responders.get(requestId)(value);\r\n                this.__responders.delete(requestId);\r\n\r\n            } else if (this.__listeners.has(action)) {\r\n                let resp = this.__listeners.get(action)(value);\r\n                source.postMessage({action: responseAction, requestId, value: resp}, origin);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} action\r\n     * @param {*} value\r\n     * @return {Promise}\r\n     */\r\n    send(action, value = null) {\r\n        return this.sendEx(this.defaultWindow, this.defaultOrigin, action, value);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {Window} window\r\n     * @param {String} origin\r\n     * @param {String} action\r\n     * @param {*} value\r\n     * @return {Promise}\r\n     */\r\n    sendEx(window, origin, action, value = null) {\r\n        return new Promise(resolve => {\r\n            const requestId = nextRequestId++;\r\n            this.__responders.set(requestId, resolve);\r\n            window.postMessage({action, requestId, value}, origin);\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} action\r\n     * @param {function} callback\r\n     */\r\n    on(action, callback) {\r\n        this.__listeners.set(action, callback);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/message-rpc.js","import {registerModule} from \"./../base/modules\";\r\nimport closestParent from \"../utils/closest-parent\";\r\nimport onHistory from \"../utils/on-history\";\r\nimport forSelect from \"../utils/for-select\";\r\nimport IAm from \"../utils/i-am\";\r\nimport {siteDomain} from \"../utils/current-user-id\";\r\n\r\nconst module = registerModule(\"common\", true, true);\r\n\r\nmodule.init(() => {\r\n    onHistory(location => {\r\n        const isHomePage = (location.pathname === \"/\");\r\n        const isBestOf = (location.pathname === \"/filter/best_of\");\r\n        document.body.classList.toggle(\"bf2-homepage\", isHomePage);\r\n        document.body.classList.toggle(\"bf2-best-of\", isBestOf);\r\n        document.body.classList.toggle(\"bf2-aggregate-page\", isHomePage || isBestOf);\r\n    });\r\n\r\n    document.addEventListener(\"click\", e => {\r\n        if (e.button == 0 && e.target.classList.contains(\"bf2-user-link\")) {\r\n            //noinspection JSUnresolvedVariable\r\n            const reactLink = document.querySelector(`a:not(.bf2-user-link)[href=\"${CSS.escape(e.target.getAttribute(\"href\"))}\"]`);\r\n            if (reactLink) {\r\n                e.preventDefault();\r\n                e.target.blur();\r\n                reactLink.click();\r\n            }\r\n        }\r\n    });\r\n\r\n    if (siteDomain === \"gamma.freefeed.net\") {\r\n        document.body.classList.add(\"bf2-gamma-frontend\");\r\n    }\r\n});\r\n\r\n\r\n// Свойства постов\r\nmodule.watch(\".timeline-post, .single-post\", node => {\r\n    // ID поста\r\n    const postId = node.querySelector(\".post-timestamp\").getAttribute(\"href\").match(/^\\/.+?\\/([\\w-]+)/)[1];\r\n    node.id = `post-${postId}`;\r\n    node.dataset.postId = postId;\r\n\r\n    // Автор поста\r\n    const postAuthor = node.querySelector(\".post-author\").getAttribute(\"href\").substr(1);\r\n    node.dataset.postAuthor = postAuthor;\r\n    node.classList.add(`bf2-post-from-${postAuthor}`);\r\n\r\n    // Адресаты поста\r\n    forSelect(node, \".post-recipient\")\r\n        .map(a => a.getAttribute(\"href\").substr(1))\r\n        .filter(u => u !== postAuthor)\r\n        .forEach(u => node.classList.add(`bf2-post-to-${u}`));\r\n\r\n    // Язык поста\r\n    const postBody = node.querySelector(\".post-text\");\r\n    const firstComment = node.querySelector(\".comment-body\");\r\n    if (isArabic(postBody.textContent) || firstComment && isArabic(firstComment.textContent)) {\r\n        node.classList.add(\"bf2-lang-arabic\");\r\n    }\r\n});\r\n\r\n// User cards\r\nmodule.watch(\".user-card .display-name\", node => {\r\n    closestParent(node, \".user-card\").dataset.userName = node.getAttribute(\"href\").substr(1);\r\n});\r\n\r\n// Свойства комментариев\r\nmodule.watch(\".comment\", async(node) => {\r\n    const commentAuthor = getCommentAuthor(node);\r\n    if (!commentAuthor) {\r\n        // фолд или форма нового коммента\r\n        return;\r\n    }\r\n    const postAuthor = getPostAuthor(closestParent(node, \".post\"));\r\n    if (!postAuthor) {\r\n        return;\r\n    }\r\n\r\n    const commProps = [];\r\n\r\n    commProps.push(\"from\");\r\n\r\n    if (postAuthor === commentAuthor) {\r\n        commProps.push(\"from-post-author\");\r\n    }\r\n\r\n    const type = (await IAm.ready).whoIs(commentAuthor);\r\n    if (type & IAm.ME) {\r\n        commProps.push(\"from-me\");\r\n    } else if (type & IAm.FRIEND) {\r\n        commProps.push(\"from-friend\");\r\n    } else if (type & IAm.READER) {\r\n        commProps.push(\"from-reader\");\r\n    }\r\n\r\n    node.dataset.commProps = commProps.join(\" \");\r\n});\r\n\r\nfunction getCommentAuthor(commentNode) {\r\n    let author = commentNode.dataset[\"author\"];\r\n    if (!author) {\r\n        const authorLink = commentNode.querySelector(\".comment-body > .user-name-wrapper > a\");\r\n        if (authorLink) {\r\n            author = authorLink.getAttribute(\"href\").substr(1);\r\n            commentNode.dataset[\"author\"] = author;\r\n        }\r\n    }\r\n    return author;\r\n}\r\n\r\n\r\nfunction getPostAuthor(postNode) {\r\n    let author = postNode.dataset[\"author\"];\r\n    if (!author) {\r\n        const authorLink = postNode.querySelector(\".post-header a.post-author\");\r\n        if (authorLink) {\r\n            author = authorLink.getAttribute(\"href\").substr(1);\r\n            postNode.dataset[\"author\"] = author;\r\n        }\r\n    }\r\n    return author;\r\n}\r\n\r\n/**\r\n *\r\n * @param {string} text\r\n * @return {boolean}\r\n */\r\nfunction isArabic(text) {\r\n    return /[\\u0600-\\u06ff\\u0700-\\u077f\\u08A0-\\u08ff]/.test(text);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/common.js","import matches from \"./matches\";\r\n\r\nconst native = !!Element.prototype.closest;\r\n\r\n/**\r\n *\r\n * @param {Element|null} element\r\n * @param {string} selector\r\n * @param {boolean} [withSelf]\r\n * @return {Element|null}\r\n */\r\nexport default function closestParent(element, selector, withSelf = false) {\r\n    if (element === null) return null;\r\n    const p = withSelf ? element : element.parentNode;\r\n    if (native && p) return p.closest(selector);\r\n\r\n    if (p && p.nodeType == Node.ELEMENT_NODE) {\r\n        return matches(p, selector) ? p : closestParent(p, selector);\r\n    }\r\n    return null;\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/closest-parent.js","const listeners = [];\r\n\r\nexport default function (callback) {\r\n    listeners.push(callback);\r\n    callback(location);\r\n}\r\n\r\nconst oldPushState = history.pushState.bind(history),\r\n    oldReplaceState = history.replaceState.bind(history);\r\n\r\nhistory.pushState = (state, title, url) => {\r\n    oldPushState(state, title, url);\r\n    listeners.forEach(c => c(location));\r\n};\r\n\r\nhistory.replaceState = (state, title, url) => {\r\n    oldReplaceState(state, title, url);\r\n    listeners.forEach(c => c(location));\r\n};\r\n\r\nwindow.addEventListener(\"popstate\", () => listeners.forEach(c => c(location)));\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/on-history.js","import {registerModule} from \"./../base/modules\";\r\nimport h from \"../utils/html\";\r\nimport bfRoot from \"../utils/bf-root\";\r\nimport Lightbox from \"../utils/lightbox\";\r\n\r\nconst version = process.env.BF2_VERSION;\r\n\r\nconst module = registerModule(\"settings-link\", true, true);\r\n\r\nmodule.watch(\".sidebar\", node => {\r\n    if (node.querySelector(\".bf2-sidebar-box\")) {\r\n        return;\r\n    }\r\n\r\n    const link = h(\"a\", \"BetterFeed settings\");\r\n    const html = h(\".bf2-sidebar-box.box\",\r\n        h(\".box-header-groups\", \"Add-ons\"),\r\n        h(\".box-body\",\r\n            h(\"ul\",\r\n                h(\"li\", link)\r\n            )\r\n        ),\r\n        h(\".box-footer\", version),\r\n    );\r\n\r\n    node.insertBefore(html, null);\r\n\r\n    link.addEventListener(\"click\", showSettings)\r\n});\r\n\r\nfunction showSettings() {\r\n    const url = bfRoot + '/src/html/settings.html?origin=' + encodeURIComponent(location.origin);\r\n\r\n    if (/iPhone|iPad/.test(navigator.userAgent)) {\r\n        window.open(url, \"_blank\");\r\n        return;\r\n    }\r\n\r\n    new Lightbox(\"bf2-settings-lightbox\")\r\n        .showContent(h(\"iframe\", {src: url, frameborder: \"0\"}));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/settings-link.js","import h from \"../utils/html\";\r\n\r\nexport default class Lightbox {\r\n    /**\r\n     * @param {string} className\r\n     * @param {boolean} modal\r\n     */\r\n    constructor(className = \"\", modal = false) {\r\n        this._container = h(\".bf2-lightbox-container\");\r\n        if (className !== \"\") {\r\n            this._container.classList.add(className)\r\n        }\r\n        let shadow = this._container.appendChild(h(\".bf2-lightbox-shadow\"));\r\n        /** @var {HTMLElement} */\r\n        this.contentEl = shadow.appendChild(h(\".bf2-lightbox-content\"));\r\n        shadow.addEventListener(\"click\", e => {\r\n            if (e.target === shadow && !modal) {\r\n                this.hide();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @param {HTMLElement|string} el\r\n     */\r\n    showContent(el) {\r\n        if (typeof el === \"string\") {\r\n            this.contentEl.innerHTML = el;\r\n        } else {\r\n            this.contentEl.innerHTML = \"\";\r\n            this.contentEl.appendChild(el);\r\n        }\r\n        document.body.appendChild(this._container);\r\n    }\r\n\r\n    hide() {\r\n        this.contentEl.innerHTML = \"\";\r\n        this._container.parentNode.removeChild(this._container);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/lightbox.js","import {registerModule} from \"./../base/modules\";\r\nimport h from \"../utils/html\";\r\n\r\nconst module = registerModule(\"moon\");\r\n\r\n//noinspection HtmlUnknownAttribute \r\nconst moonXML = `<svg class=\"bf2-moon\" viewBox=\"-4 -4 108 108\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\">\r\n        <circle class=\"bf2-moon-shadow\" cx=\"50\" cy=\"50\" r=\"54\"></circle>\r\n        <path class=\"bf2-moon-light\" d=\"M 50 0 a 30 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z\"></path>\r\n    </svg>`;\r\n\r\nmodule.watch(\"h1\", node => {\r\n    node.appendChild(h(\".bf2-moon-cont\")).innerHTML = moonXML;\r\n    drawMoonPhase(currentMoonPhase());\r\n    setInterval(() => drawMoonPhase(currentMoonPhase()), 1000 * 3600);\r\n});\r\n\r\nconst newMoon = new Date(\"Thu Apr 07 2016 14:22:37 GMT+0300\").getTime(),\r\n    month = Math.round(86400 * 29.53058812 * 1000);\r\n\r\nfunction currentMoonPhase() {\r\n    return (((new Date()).getTime() - newMoon) / month) % 1;\r\n}\r\n\r\n// phase = [0..1], 0 = 1 = новолуние, 0.5 = полнолуние\r\nfunction drawMoonPhase(phase) {\r\n    const moonEl = document.querySelector(\".bf2-moon\");\r\n    if (!moonEl) {\r\n        return;\r\n    }\r\n    const lightEl = moonEl.querySelector(\".bf2-moon-light\");\r\n    const radius = 50;\r\n    const xRadius = radius * Math.abs(Math.cos(2 * Math.PI * phase));\r\n\r\n    let path;\r\n    if (phase < 0.25) {\r\n        path = `M 50 0 a ${xRadius} 50 0 0 1 0 100 a 50 50 0 0 0 0 -100 Z`;\r\n    } else if (phase < 0.5) {\r\n        path = `M 50 0 a ${xRadius} 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z`;\r\n    } else if (phase < 0.75) {\r\n        path = `M 50 0 a 50 50 0 0 0 0 100 a ${xRadius} 50 0 0 0 0 -100 Z`;\r\n    } else {\r\n        path = `M 50 0 a 50 50 0 0 0 0 100 a ${xRadius} 50 0 0 1 0 -100 Z`;\r\n    }\r\n    lightEl.setAttribute(\"d\", path);\r\n\r\n    if (Math.abs(0.5 - phase) < 0.05) {\r\n        moonEl.parentNode.setAttribute(\"title\", \"Achtung Vollmond!\");\r\n    } else {\r\n        moonEl.parentNode.removeAttribute(\"title\");\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/moon.js","import {registerModule} from \"./../base/modules\";\r\nimport LS from \"../utils/cross-local-storage\";\r\nimport h from \"../utils/html\";\r\nimport {html} from \"../utils/html-tpl\";\r\nimport Lightbox from \"../utils/lightbox\";\r\nimport IAm from \"../utils/i-am\";\r\nimport * as api from \"../utils/api\";\r\nimport {defaultPic, getPic} from '../utils/userpics';\r\nimport {cookieName, authToken} from '../utils/current-user-id';\r\nimport closestParent from \"../utils/closest-parent\";\r\n\r\nconst module = registerModule(\"switch-accounts\");\r\n\r\nconst CSS_PREFIX = \"bf2-switch-dlg-\";\r\nconst ACC_LIST_KEY = `bfAccounts-freefeed.net`;\r\nconst clickHandlers = [\r\n    {selector: `.${CSS_PREFIX}del`, handler: removeAccount},\r\n    {selector: `.${CSS_PREFIX}account`, handler: accountClicked},\r\n    {selector: `.${CSS_PREFIX}add-new`, handler: addAccountClicked}\r\n];\r\n\r\n\r\nlet ls = null;\r\n\r\nmodule.init(() => {\r\n    ls = new LS();\r\n\r\n    document.body.addEventListener(\"click\", e => {\r\n        clickHandlers.some(h => {\r\n            let t = closestParent(e.target, h.selector, true);\r\n            if (t) {\r\n                e.preventDefault();\r\n                h.handler(t);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    });\r\n});\r\n\r\nmodule.watch(\".logged-in > .avatar, .logged-in > .userpic\", node => {\r\n    node.appendChild(\r\n        h(\".bf2-switch-acc\", {title: \"Switch account\"}, h(\"span.bf2-switch-acc__icon\"))\r\n    ).addEventListener(\"click\", showSwitchDialog);\r\n\r\n});\r\n\r\nlet lb = null;\r\n\r\nasync function showSwitchDialog() {\r\n    lb = new Lightbox(\"bf2-switch-account-box\");\r\n    lb.showContent(`<p>Loading…</p>`);\r\n    lb.showContent(await genHtml());\r\n}\r\n\r\nasync function genHtml() {\r\n    let {me} = await IAm.ready;\r\n\r\n    let form = h(`form.${CSS_PREFIX}new-form`,\r\n        html`\r\n        <p>Please enter username and password of your other account:</p>\r\n        <p><input class=\"form-control\" type=\"text\" name=\"username\" placeholder=\"Username\" required></p>\r\n        <p><input class=\"form-control\" type=\"password\" name=\"password\" placeholder=\"Password\" required></p>\r\n        <p><button type=\"submit\" class=\"btn btn-default\">Add</button></p>\r\n        `\r\n    );\r\n    form.addEventListener(\"submit\", e => {\r\n        e.preventDefault();\r\n        let username = form.elements['username'].value;\r\n        let password = form.elements['password'].value;\r\n        (async () => {\r\n            let d = await api.anonFormPost(\"/v1/session\", `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`);\r\n            if (d.err) {\r\n                alert(d.err);\r\n                return;\r\n            }\r\n            //noinspection UnnecessaryLocalVariableJS\r\n            let {users: {username: u}, authToken} = d;\r\n            await addAccount(u, authToken);\r\n            lb.showContent(await genHtml());\r\n        })();\r\n    });\r\n\r\n    return h(\"\",\r\n        html`<div class=\"${CSS_PREFIX}header\">Switch account to:</div>`,\r\n        h(\r\n            `.${CSS_PREFIX}accounts`,\r\n            (await readAccList()).map(\r\n                ({username}) => {\r\n                    let userPic = h(`img.${CSS_PREFIX}upic`, {src: defaultPic});\r\n                    getPic(username).then(pic => userPic.src = pic);\r\n                    let deleter = h(`.${CSS_PREFIX}del`, {title: \"Remove from list\"}, h(\"i.fa.fa-times-circle\"));\r\n                    return h(`.${CSS_PREFIX}account${(username === me) ? \".-current\" : \"\"}`, {\"data-username\": username}, userPic, username, deleter);\r\n                }\r\n            )\r\n        ),\r\n        html`<div class=\"${CSS_PREFIX}add-new\"><a><i class=\"fa fa-plus\"></i> Add new account</a></div>`,\r\n        form\r\n    );\r\n}\r\n\r\nfunction addAccountClicked(el) {\r\n    el.style.display = \"none\";\r\n    document.body.querySelector(`.${CSS_PREFIX}new-form`).style.display = \"block\";\r\n}\r\n\r\nasync function readAccList() {\r\n    let list = await ls.get(ACC_LIST_KEY);\r\n    if (!list) {\r\n        list = [{username: (await IAm.ready).me, token: authToken}];\r\n    }\r\n    return list;\r\n}\r\n\r\nasync function addAccount(username, token) {\r\n    let list = await readAccList();\r\n    if (list.some(a => a.username === username)) {\r\n        return;\r\n    }\r\n    list.push({username, token});\r\n    await ls.set(ACC_LIST_KEY, list);\r\n}\r\n\r\nfunction removeAccount(el) {\r\n    if (!confirm(\"Are you sure?\")) return Promise.resolve();\r\n    return (async () => {\r\n        let {me} = await IAm.ready;\r\n        let username = closestParent(el, `.${CSS_PREFIX}account`).dataset['username'];\r\n        if (username === me) return;\r\n\r\n        let list = (await readAccList()).filter(a => a.username !== username);\r\n        if (list.length === 1 && list[0].username === me) {\r\n            await ls.set(ACC_LIST_KEY, null);\r\n        } else {\r\n            await ls.set(ACC_LIST_KEY, list);\r\n        }\r\n        lb.showContent(await genHtml());\r\n    })();\r\n}\r\n\r\nasync function accountClicked(el) {\r\n    let username = el.dataset['username'];\r\n    if (username === (await IAm.ready).me) return;\r\n    let token = null;\r\n    (await readAccList()).some(a => {\r\n        if (a.username === username) {\r\n            token = a.token;\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n\r\n    if (token) {\r\n        lb.showContent(\"Please wait\\u2026\");\r\n        localStorage.setItem(cookieName, token);\r\n        location.reload();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/switch-accounts.js","import Messenger from \"./message-rpc\";\r\n\r\nconst frameSrc = \"https://davidmz.github.io/BetterFeed2/storage.html?_=\" + Math.random();\r\nconst frameOrigin = \"https://davidmz.github.io\";\r\n\r\nexport default class {\r\n\r\n    constructor() {\r\n        this.iframe = document.createElement(\"iframe\");\r\n        this.iframe.src = frameSrc;\r\n        this.iframe.style.cssText =\r\n            `visibility: hidden;\r\n            position: absolute;\r\n            left: 0; top: 0;\r\n            height:0; width:0;\r\n            border: none;`;\r\n        // this.iframe.addEventListener(\"load\", e => console.log(e));\r\n        document.body.appendChild(this.iframe);\r\n        this.msg = new Messenger(this.iframe.contentWindow, frameOrigin);\r\n    }\r\n\r\n    get(key) {\r\n        return this.msg.send(\"get\", key);\r\n    }\r\n\r\n    set(key, value) {\r\n        return this.msg.send(\"set\", {key, value});\r\n    }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/cross-local-storage.js","import {registerModule} from \"./../base/modules\";\r\n\r\nconst module = registerModule(\"no-read-more\", false);\r\n\r\nmodule.watch(\"a.read-more\", a => a.click());\r\n\r\nmodule.watch(\".expand-button > i\", a => a.click());\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/no-read-more.js","import {registerModule} from \"./../base/modules\";\r\nimport h from \"../utils/html\";\r\nimport {getPic} from \"../utils/userpics\";\r\nimport IAm from \"../utils/i-am\";\r\nimport \"../../styles/comment-clouds.less\";\r\n\r\nconst module = registerModule(\"comment-clouds\");\r\n\r\nconst usersWithAvatars = new Map();\r\nlet withAvatars = false;\r\nlet style = null;\r\n\r\nmodule.init(settings => {\r\n    style = document.head.appendChild(h(\"style.bf2-comments-avatars\")).sheet;\r\n    withAvatars = (settings.commentCloudsMode === 2);\r\n    if (withAvatars) {\r\n        document.body.classList.add(\"bf2-comments-with-avatars\");\r\n    }\r\n});\r\n\r\nmodule.watch(\".comment[data-author]\", async(node) => {\r\n    if (node.querySelector(\".bf2-comment-ex\") || node.classList.contains(\"is-hidden\")) {\r\n        return;\r\n    }\r\n    if (withAvatars) {\r\n        const author = node.dataset[\"author\"];\r\n        node.appendChild(h(\".bf2-comment-avatar.bf2-comment-ex\"));\r\n\r\n        if (!usersWithAvatars.has(author)) {\r\n            usersWithAvatars.set(author, true);\r\n            const pic = await getPic(author || (await IAm.ready).me);\r\n            style.insertRule(`.comment[data-author=\"${author}\"] .bf2-comment-avatar { background-image: url(${pic}); }`, 0);\r\n        }\r\n    } else {\r\n        node.appendChild(h(\"i.fa.fa-comment.icon.bf2-ico-bg.bf2-comment-ex\"));\r\n    }\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/comment-clouds.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\", function() {\n\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles/comment-clouds.less\n// module id = 32\n// module chunks = 0","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".comment .comment-icon:not(.fa-stack){position:relative;top:-2px;left:-1px;z-index:1}.comment-likes .comment-likes-list{z-index:2}.bf2-ico-bg{position:absolute;top:0;left:0;color:#fff;display:none}.comment[data-comm-props~=from] .bf2-ico-bg{display:block}.comment[data-comm-props~=from-reader] .bf2-ico-bg{color:#ededed}.comment[data-comm-props~=from-friend] .bf2-ico-bg{color:#cef4fc}.comment[data-comm-props~=from-post-author] .bf2-ico-bg{color:#b5b5b5}.comment[data-comm-props~=from-me] .bf2-ico-bg{color:#ffd061}.comment.omit-bubble .bf2-ico-bg{display:none}.bf2-comment-avatar{position:absolute;width:16px;height:16px;background-size:cover;top:0;left:-4px;z-index:1;background-color:#fff;border-radius:50%;border:1px solid #ccc;box-sizing:content-box;pointer-events:none}.comment.omit-bubble .bf2-comment-avatar{display:none}.bf2-gamma-frontend .highlighted .bf2-comment-avatar{top:4px;left:3px}.bf2-comments-with-avatars .comment-time{margin-right:5px}.bf2-comments-with-avatars .feed-comment-dot:after{margin-top:1px}.bf2-comments-with-avatars .comment{margin-top:10px}.bf2-comments-with-avatars .bf2-likecomm-shift{left:-9px}.bf2-comments-with-avatars .likes{position:relative;left:-2px}.bf2-comments-with-avatars .likes .icon{margin-right:7px}.bf2-comments-with-avatars .fold-comments-sticky{z-index:2}.bf2-comments-with-avatars .fold-comments-sticky i{left:-2px}.bf2-gamma-frontend.bf2-comments-with-avatars .comment.highlighted{margin-top:6px}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./~/less-loader!./src/styles/comment-clouds.less\n// module id = 33\n// module chunks = 0","import {registerModule} from \"./../base/modules\";\r\nimport h from \"../utils/html\";\r\n\r\nconst module = registerModule(\"hide-arabic\", false);\r\n\r\nlet style = null;\r\n\r\nmodule.init(() => {\r\n    style = document.head.appendChild(h(\"style.bf2-hide-posts\")).sheet;\r\n    style.insertRule(\".bf2-aggregate-page .bf2-lang-arabic { display: none; }\", 0);\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/hide-arabic.js","import {registerModule} from \"./../base/modules\";\r\nimport textWalk from \"../utils/text-walk\";\r\nimport escapeHTML from \"../utils/escape-html\";\r\nimport matches from \"../utils/matches\";\r\n\r\nconst module = registerModule(\"hanging-punct\");\r\n\r\nlet helper;\r\n\r\nmodule.init(() => {\r\n    helper = document.createElement(\"div\");\r\n});\r\n\r\nconst re = /(^|\\s)([(«“-]|&quot;)/g;\r\n\r\nmodule.watch(\".post-text, .comment-body\", node => {\r\n    if (matches(node, \".comment-body\")) {\r\n        const userNames = node.querySelectorAll(\".user-name-wrapper\");\r\n        const lastUserName = userNames[userNames.length - 1];\r\n        if (lastUserName && lastUserName.nextElementSibling) {\r\n            const actions = lastUserName.nextElementSibling;\r\n            textWalk(actions, node => {\r\n                if (node.nodeValue === \"(\") {\r\n                    node.nodeValue = \" (\";\r\n                }\r\n            });\r\n        }\r\n    }\r\n    textWalk(node, node => {\r\n        if (node.parentNode.classList.contains(\"bf2-hp\")) {\r\n            return;\r\n        }\r\n        let html = escapeHTML(node.nodeValue);\r\n        if (!re.test(html)) {\r\n            return;\r\n        }\r\n        html = html.replace(re, '<span class=\"bf2-hp bf2-hp-pre bf2-hp-pre-$2\">$1</span><span class=\"bf2-hp bf2-hp-$2\">$2</span>');\r\n        helper.innerHTML = html;\r\n        while (helper.firstChild) {\r\n            node.parentNode.insertBefore(helper.firstChild, node);\r\n        }\r\n        node.parentNode.removeChild(node);\r\n    });\r\n});\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/hanging-punct.js","/**\r\n *\r\n * @param {Node} node\r\n * @param {function} foo\r\n */\r\nexport default function textWalk(node, foo) {\r\n    if (node.nodeType === Node.TEXT_NODE) {\r\n        foo(node);\r\n    } else if (node.nodeType === Node.ELEMENT_NODE) {\r\n        let c = node.firstChild;\r\n        while (c) {\r\n            const next = c.nextSibling;\r\n            textWalk(c, foo);\r\n            c = next;\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/text-walk.js","import {registerModule} from \"./../base/modules\";\r\n\r\nconst module = registerModule(\"show-timestamps\", false);\r\n\r\nmodule.watch(\".post-lock-icon\", t => {\r\n    const event = document.createEvent(\"MouseEvents\");\r\n    event.initEvent(\"click\", true, true);\r\n    t.dispatchEvent(event);\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/show-timestamps.js"],"sourceRoot":""}