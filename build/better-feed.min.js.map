{"version":3,"sources":["webpack:///better-feed.min.js","webpack:///webpack/bootstrap 7d12139c3da36803f11c","webpack:///./src/js/better-feed.js","webpack:///./src/styles/common.less?7c5a","webpack:///./src/styles/common.less","webpack:///./~/css-loader/lib/css-base.js","webpack:///./src/styles/fa-exchange.svg","webpack:///./~/style-loader/addStyles.js","webpack:///./src/js/base/modules.js","webpack:///./src/js/utils/for-select.js","webpack:///./src/js/utils/matches.js","webpack:///./src/js/utils/current-user-id.js","webpack:///./src/js/utils/i-am.js","webpack:///./src/js/utils/api.js","webpack:///./src/js/utils/userpics.js","webpack:///./src/js/utils/bf-root.js","webpack:///./src/styles/default-userpic-50.png","webpack:///./src/js/utils/html.js","webpack:///./src/js/utils/is-array.js","webpack:///./src/js/utils/html-tpl.js","webpack:///./src/js/utils/escape-html.js","webpack:///./src/js/utils/doc-loaded.js","webpack:///./src/js/base/settings.js","webpack:///./src/js/utils/message-rpc.js","webpack:///./src/js/modules/common.js","webpack:///./src/js/utils/closest-parent.js","webpack:///./src/js/utils/on-history.js","webpack:///./src/js/modules/settings-link.js","webpack:///./src/js/utils/lightbox.js","webpack:///./src/js/modules/moon.js","webpack:///./src/js/modules/switch-accounts.js","webpack:///./src/js/utils/cross-local-storage.js","webpack:///./src/js/modules/no-read-more.js","webpack:///./src/js/modules/comment-clouds.js","webpack:///./src/styles/comment-clouds.less?f7f7","webpack:///./src/styles/comment-clouds.less","webpack:///./src/js/modules/hide-arabic.js","webpack:///./src/js/modules/hanging-punct.js","webpack:///./src/js/utils/text-walk.js","webpack:///./src/js/modules/show-timestamps.js","webpack:///./src/js/modules/no-comment-more.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_asyncToGenerator","fn","gen","apply","this","arguments","Promise","resolve","reject","step","key","arg","info","value","error","done","then","err","start","settings","_this","_modules","startObserver","msg","Messenger","on","toJSON","_ref3","regeneratorRuntime","mark","_callee","o","iAm","wrap","_context","prev","next","IAm","ready","sent","saveProps","Settings","location","reload","stop","_x","checkUpdates","now","Date","oldVersion","localStorage","xhr","XMLHttpRequest","open","responseType","onload","tags","response","length","newVersion","confirm","alert","e","send","_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_s","_i","Symbol","iterator","push","Array","isArray","Object","TypeError","_currentUserId","_iAm","_iAm2","_docLoaded","_docLoaded2","_settings","_settings2","_messageRpc","_messageRpc2","_getCurrentAuth","getCurrentAuth","userId","test","pathname","MutationObserver","console","window","warn","__BetterFeed","all","docLoaded","_ref","_ref2","bf2Props","content","locals","list","toString","result","item","join","mediaQuery","alreadyImportedModules","addStylesToDom","styles","options","domStyle","stylesInDom","refs","j","parts","addStyle","listToStyles","newStyles","css","media","sourceMap","part","insertStyleElement","styleElement","head","getHeadElement","lastStyleElementInsertedAtTop","styleElementsInsertedAtTop","insertAt","nextSibling","insertBefore","appendChild","firstChild","Error","removeStyleElement","parentNode","removeChild","idx","indexOf","splice","createStyleElement","document","createElement","type","createLinkElement","linkElement","rel","update","remove","singleton","styleIndex","singletonCounter","singletonElement","applyToSingletonTag","bind","URL","createObjectURL","revokeObjectURL","Blob","btoa","updateLink","href","applyToTag","newObj","index","styleSheet","cssText","replaceText","cssNode","createTextNode","childNodes","setAttribute","unescape","encodeURIComponent","JSON","stringify","blob","oldSrc","memoize","memo","isOldIE","self","navigator","userAgent","toLowerCase","getElementsByTagName","newList","mayRemove","textStore","replacement","filter","Boolean","_classCallCheck","instance","Constructor","registerModule","name","enabledByDefault","alwaysEnabled","Module","registeredModules","set","aSettings","forEach","isModuleEnabled","_initiate","observer","mutations","mutation","_loop","l","node","addedNodes","nodeType","Node","ELEMENT_NODE","_trigger","observe","body","childList","subtree","defineProperty","_createClass","defineProperties","target","props","descriptor","enumerable","configurable","writable","protoProps","staticProps","prototype","_forSelect","_forSelect2","Map","requiredModules","active","_watchers","_initiators","callback","selector","n","_matches","_matches2","foo","nodeList","querySelectorAll","nodes","slice","unshift","matchesMethod","HTMLElement","siteDomain","sitesProps","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","cookies","cName","_extractFromJWT","extractFromJWT","getItem","authToken","return","jwtString","split","payload","parse","atob","freefeed.net","gamma.freefeed.net","hostname","cookieName","_interopRequireWildcard","hasOwnProperty","_defineProperty","_api","api","_userpics","uPics","_html","_html2","prefsName","me","myID","myScreenName","friends","readers","banIds","_savePropsQueue","_savingPropsNow","_savingIndicator","username","flags","ME","FRIEND","READER","s","_saveProps","json","nulls","k","abrupt","shift","put","user","frontendPreferences","get","resp","users","screenName","setPic","profilePictureMediumUrl","subscribers","map","it","path","apiURL","setRequestHeader","del","post","anonFormPost","apiRoot","getPic","picRegistry","has","picLoad","pic","defaultPic","fetch","status","data","_bfRoot","_bfRoot2","bfRoot","myRoot","__BetterFeedRoot","currentScript","pr","src","h","tagName","attrs","children","el","tagParts","tn","createDocumentFragment","className","chStart","_typeof","_isArray2","_htmlTpl","isSafeHTML","append","insertAdjacentHTML","constructor","_isArray","safeHTML","text","SafeHTML","html","tpl","_len","args","_key","reduce","acc","a","_escapeHtml2","_escapeHtml","replace","readyState","setTimeout","addEventListener","trustedData","hideAliens","commentCloudsMode","v","_this2","some","nextRequestId","responseAction","parentWindow","parentOrigin","__responders","__listeners","defaultWindow","defaultOrigin","event","_event$data","action","requestId","source","origin","delete","postMessage","sendEx","getCommentAuthor","commentNode","author","dataset","authorLink","querySelector","getAttribute","substr","getPostAuthor","postNode","isArabic","_closestParent","_closestParent2","_onHistory","_onHistory2","init","isHomePage","isBestOf","classList","toggle","button","contains","reactLink","CSS","escape","preventDefault","blur","click","add","watch","postId","match","postAuthor","u","postBody","firstComment","textContent","userName","commentAuthor","commProps","t0","whoIs","closestParent","element","withSelf","native","closest","Element","listeners","oldPushState","history","pushState","oldReplaceState","replaceState","state","title","url","showSettings","htmlUrl","r","t1","version","t2","Lightbox","showContent","frameborder","_lightbox","_lightbox2","link","someBox","modal","_container","shadow","contentEl","hide","innerHTML","currentMoonPhase","getTime","newMoon","month","drawMoonPhase","phase","moonEl","lightEl","radius","xRadius","Math","abs","cos","PI","removeAttribute","moonXML","setInterval","round","_taggedTemplateLiteral","strings","raw","freeze","addAccountClicked","style","display","CSS_PREFIX","removeAccount","_callee6","_ref9","_context6","readAccList","ls","ACC_LIST_KEY","lb","genHtml","showSwitchDialog","_callee3","form","_context3","_templateObject","elements","password","_callee2","_context2","addAccount","_templateObject2","t3","t4","_ref5","userPic","deleter","data-username","t5","t6","t7","_templateObject3","t8","_ref6","_callee4","_context4","token","_ref7","_callee5","found","_context5","find","_x2","accountClicked","_ref10","_callee7","currentUsername","_context7","setItem","_x3","_crossLocalStorage","_crossLocalStorage2","clickHandlers","handler","LS","t","frameSrc","random","frameOrigin","_class","iframe","contentWindow","usersWithAvatars","withAvatars","sheet","insertRule","_textWalk","_textWalk2","helper","re","userNames","lastUserName","nextElementSibling","actions","nodeValue","textWalk","TEXT_NODE","createEvent","initEvent","dispatchEvent","hidden"],"mappings":"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","file":"better-feed.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\t// import \"./modules/ani-gifs\";\n\t\n\t\n\t__webpack_require__(1);\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _currentUserId = __webpack_require__(9);\n\t\n\tvar _iAm = __webpack_require__(10);\n\t\n\tvar _iAm2 = _interopRequireDefault(_iAm);\n\t\n\tvar _docLoaded = __webpack_require__(19);\n\t\n\tvar _docLoaded2 = _interopRequireDefault(_docLoaded);\n\t\n\tvar _settings = __webpack_require__(20);\n\t\n\tvar _settings2 = _interopRequireDefault(_settings);\n\t\n\tvar _messageRpc = __webpack_require__(21);\n\t\n\tvar _messageRpc2 = _interopRequireDefault(_messageRpc);\n\t\n\t__webpack_require__(22);\n\t\n\t__webpack_require__(25);\n\t\n\t__webpack_require__(27);\n\t\n\t__webpack_require__(28);\n\t\n\t__webpack_require__(30);\n\t\n\t__webpack_require__(31);\n\t\n\t__webpack_require__(34);\n\t\n\t__webpack_require__(35);\n\t\n\t__webpack_require__(37);\n\t\n\t__webpack_require__(38);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar _getCurrentAuth = (0, _currentUserId.getCurrentAuth)(),\n\t    userId = _getCurrentAuth.userId;\n\t\n\tif (!/^\\/(attachments\\/|files\\/|bookmarklet|v\\d\\/)/.test(location.pathname)) {\n\t    if (!MutationObserver || !Promise) {\n\t        console.error(\"Can not start BetterFeed: MutationObserver & Promise not supported\");\n\t    } else if (userId === null) {\n\t        console.error(\"Can not start BetterFeed: user not logged in\");\n\t    } else if (\"__BetterFeed\" in window) {\n\t        console.warn(\"BetterFeed already started\");\n\t    } else {\n\t        window.__BetterFeed = true;\n\t        Promise.all([_iAm2.default.ready, _docLoaded2.default]).then(function (_ref) {\n\t            var _ref2 = _slicedToArray(_ref, 1),\n\t                iAm = _ref2[0];\n\t\n\t            start(new _settings2.default(iAm.bf2Props));\n\t        });\n\t    }\n\t}\n\t\n\t/**\r\n\t * @param {Settings} settings\r\n\t */\n\tfunction start(settings) {\n\t    var _this = this;\n\t\n\t    (0, _modules.startObserver)(settings);\n\t\n\t    var msg = new _messageRpc2.default();\n\t\n\t    msg.on(\"getSettings\", function () {\n\t        return settings.toJSON();\n\t    });\n\t\n\t    msg.on(\"saveSettings\", function () {\n\t        var _ref3 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(o) {\n\t            var iAm;\n\t            return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                while (1) {\n\t                    switch (_context.prev = _context.next) {\n\t                        case 0:\n\t                            _context.next = 2;\n\t                            return _iAm2.default.ready;\n\t\n\t                        case 2:\n\t                            iAm = _context.sent;\n\t                            _context.next = 5;\n\t                            return iAm.saveProps(new _settings2.default(o));\n\t\n\t                        case 5:\n\t                            location.reload(true);\n\t\n\t                        case 6:\n\t                        case \"end\":\n\t                            return _context.stop();\n\t                    }\n\t                }\n\t            }, _callee, _this);\n\t        }));\n\t\n\t        return function (_x) {\n\t            return _ref3.apply(this, arguments);\n\t        };\n\t    }());\n\t\n\t    msg.on(\"checkUpdates\", checkUpdates);\n\t}\n\t\n\tfunction checkUpdates() {\n\t    var now = Date.now();\n\t    var oldVersion = (\"v2.20.1\");\n\t    localStorage[\"bf2-next-update\"] = now + 3600 * 1000;\n\t    var xhr = new XMLHttpRequest();\n\t    xhr.open('GET', 'https://api.github.com/repos/davidmz/BetterFeed2/tags?page=1&per_page=1');\n\t    xhr.responseType = \"json\";\n\t    xhr.onload = function () {\n\t        try {\n\t            var tags = xhr.response;\n\t            if (tags.length === 1 && \"name\" in tags[0]) {\n\t                var newVersion = tags[0][\"name\"];\n\t                localStorage[\"bf2-version\"] = newVersion;\n\t                localStorage[\"bf2-next-update\"] = now + 24 * 3600 * 1000;\n\t                if (newVersion !== oldVersion) {\n\t                    if (confirm(\"\\u0414\\u043E\\u0441\\u0442\\u0443\\u043F\\u043D\\u0430 \\u043D\\u043E\\u0432\\u0430\\u044F \\u0432\\u0435\\u0440\\u0441\\u0438\\u044F: \" + newVersion + \". \\u041E\\u043D\\u0430 \\u0431\\u0443\\u0434\\u0435\\u0442 \\u0443\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0430 \\u043F\\u043E\\u0441\\u043B\\u0435 \\u043F\\u0435\\u0440\\u0435\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0438 \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u044B.\\n\\n\\u041F\\u0435\\u0440\\u0435\\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u0438\\u0442\\u044C \\u0441\\u0442\\u0440\\u0430\\u043D\\u0438\\u0446\\u0443 \\u0441\\u0435\\u0439\\u0447\\u0430\\u0441?\")) {\n\t                        location.reload(true);\n\t                    }\n\t                } else {\n\t                    alert(\"\\u0423 \\u0432\\u0430\\u0441 \\u0443\\u0441\\u0442\\u0430\\u043D\\u043E\\u0432\\u043B\\u0435\\u043D\\u0430 \\u043F\\u043E\\u0441\\u043B\\u0435\\u0434\\u043D\\u044F\\u044F \\u0432\\u0435\\u0440\\u0441\\u0438\\u044F (\" + newVersion + \")\");\n\t                }\n\t            }\n\t        } catch (e) {}\n\t    };\n\t    xhr.send();\n\t}\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(2);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(5)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\", function() {\n\t\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(3)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".bf2-lightbox-container{left:0;top:0;width:100%;height:100%;position:fixed;z-index:10}.bf2-lightbox-shadow{left:0;top:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.5)}.bf2-lightbox-content{position:relative;border:1px solid #000;background-color:#ccc;box-shadow:0 0 50px rgba(0,0,0,.5)}.bf2-settings-lightbox .bf2-lightbox-content{width:90vw;height:90vh;max-width:800px}.bf2-settings-lightbox .bf2-lightbox-content iframe{left:0;top:0;width:100%;height:100%}.bf2-access-token-lightbox .bf2-lightbox-content{background-color:#fff;max-width:90vw;padding:2em}.bf2-access-token-lightbox .bf2-lightbox-content button{padding:.25em 2em;cursor:pointer}.bf2-access-token-lightbox .bf2-lightbox-content .bf2-access-token{word-wrap:break-word;font-family:monospace;color:#069;background-color:#eee;padding:1em}.bf2-green{padding:1em}.bf2-via-names{font-size:12px}.bf2-hide-aliens-cont{font-size:14px;font-weight:400;margin-left:1em;display:none}.bf2-homepage .bf2-hide-aliens-cont{display:inline}.bf2-hide-aliens .bf2-alien-post{display:none}.bf2-saving-settings-indicator{position:fixed;top:.66em;right:1em;background:#f66;color:#fff;padding:.25em 1em;border-radius:4px;z-index:100}.bf2-animated-gif{position:relative;display:inline-block}.bf2-animated-gif:after{content:\\\"\\\\25B6   GIF\\\";position:absolute;bottom:3px;right:4px;background-color:#069;color:#eee;font-weight:700;padding:.1em .4em;border-radius:3px;font-size:11px;line-height:normal}.arrow-span{padding:0 .2em}.bf2-moon{width:18px;height:18px;margin-left:4px;margin-bottom:10px}.bf2-moon-shadow{fill:#666}.bf2-moon-light{fill:#f5eed9}.bf2-moon-cont{display:inline-block}.bf2-switch-acc{color:#ccc;cursor:pointer;text-align:center}.bf2-switch-acc:hover{background-color:#eee;color:#000}.bf2-switch-acc__icon{display:inline-block;background:url(\" + __webpack_require__(4) + \") no-repeat;background-size:contain;width:14px;height:14px;opacity:.4}.bf2-switch-account-box .bf2-lightbox-content{width:360px;height:auto;cursor:auto;border:1px solid #000;box-shadow:1px 1px 10px rgba(0,0,0,.5);background-color:#fff;padding:1em}.bf2-switch-dlg-header{font-size:120%}.bf2-switch-dlg-accounts{margin:1em 0}.bf2-switch-dlg-account{cursor:pointer;font-weight:700;border:1px solid #ddd;margin:.5em 0;position:relative}.bf2-switch-dlg-account.-current,.bf2-switch-dlg-account:hover{background-color:#eee}.bf2-switch-dlg-account.-current{cursor:not-allowed}.bf2-switch-dlg-account.-current .bf2-switch-dlg-del{display:none}.bf2-switch-dlg-upic{width:50px;height:50px;margin-right:1em;border-right:1px solid #ddd}.bf2-switch-dlg-new-form{display:none}.bf2-switch-dlg-del{position:absolute;right:0;top:50%;width:20px;height:20px;line-height:20px;text-align:center;margin-top:-10px}.bf2-switch-dlg-del:hover{color:#c00}.box{clear:both}.bf2-lightboxed-images .image-attachments a{cursor:zoom-in}.bf2-search-highlight{background-color:#ffff80}.bf2-hp-pre:empty{display:none}.bf2-hp-pre-\\\\({margin-right:.13em}.bf2-hp-\\\\({margin-left:-.13em}.bf2-hp-pre-«{margin-right:.2em}.bf2-hp-«{margin-left:-.2em}.bf2-hp-pre-\\\\\\\"{margin-right:.2em}.bf2-hp-\\\\\\\"{margin-left:-.2em}.bf2-hp-pre-“{margin-right:.33em}.bf2-hp-“{margin-left:-.33em}.bf2-hp-pre--{margin-right:.1em}.bf2-hp--{margin-left:-.1em}\", \"\"]);\n\t\n\t// exports\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\n\t/*\r\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\t\tAuthor Tobias Koppers @sokra\r\n\t*/\r\n\t// css base code, injected by the css-loader\r\n\tmodule.exports = function() {\r\n\t\tvar list = [];\r\n\t\r\n\t\t// return the list of modules as css string\r\n\t\tlist.toString = function toString() {\r\n\t\t\tvar result = [];\r\n\t\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar item = this[i];\r\n\t\t\t\tif(item[2]) {\r\n\t\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tresult.push(item[1]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result.join(\"\");\r\n\t\t};\r\n\t\r\n\t\t// import a list of modules into the list\r\n\t\tlist.i = function(modules, mediaQuery) {\r\n\t\t\tif(typeof modules === \"string\")\r\n\t\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\t\tvar alreadyImportedModules = {};\r\n\t\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\t\tvar id = this[i][0];\r\n\t\t\t\tif(typeof id === \"number\")\r\n\t\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t\t}\r\n\t\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\t\tvar item = modules[i];\r\n\t\t\t\t// skip already imported module\r\n\t\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tlist.push(item);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\treturn list;\r\n\t};\r\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\tmodule.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjxzdmcgd2lkdGg9IjE3OTIiIGhlaWdodD0iMTc5MiIgdmlld0JveD0iMCAwIDE3OTIgMTc5MiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgICA8cGF0aCBkPSJNMTc5MiAxMTg0djE5MnEwIDEzLTkuNSAyMi41dC0yMi41IDkuNWgtMTM3NnYxOTJxMCAxMy05LjUgMjIuNXQtMjIuNSA5LjVxLTEyIDAtMjQtMTBsLTMxOS0zMjBxLTktOS05LTIyIDAtMTQgOS0yM2wzMjAtMzIwcTktOSAyMy05IDEzIDAgMjIuNSA5LjV0OS41IDIyLjV2MTkyaDEzNzZxMTMgMCAyMi41IDkuNXQ5LjUgMjIuNXptMC01NDRxMCAxNC05IDIzbC0zMjAgMzIwcS05IDktMjMgOS0xMyAwLTIyLjUtOS41dC05LjUtMjIuNXYtMTkyaC0xMzc2cS0xMyAwLTIyLjUtOS41dC05LjUtMjIuNXYtMTkycTAtMTMgOS41LTIyLjV0MjIuNS05LjVoMTM3NnYtMTkycTAtMTQgOS0yM3QyMy05cTEyIDAgMjQgMTBsMzE5IDMxOXE5IDkgOSAyM3oiLz4NCjwvc3ZnPg==\"\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t/*\n\t\tMIT License http://www.opensource.org/licenses/mit-license.php\n\t\tAuthor Tobias Koppers @sokra\n\t*/\n\tvar stylesInDom = {},\n\t\tmemoize = function(fn) {\n\t\t\tvar memo;\n\t\t\treturn function () {\n\t\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\t\t\treturn memo;\n\t\t\t};\n\t\t},\n\t\tisOldIE = memoize(function() {\n\t\t\treturn /msie [6-9]\\b/.test(self.navigator.userAgent.toLowerCase());\n\t\t}),\n\t\tgetHeadElement = memoize(function () {\n\t\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\n\t\t}),\n\t\tsingletonElement = null,\n\t\tsingletonCounter = 0,\n\t\tstyleElementsInsertedAtTop = [];\n\t\n\tmodule.exports = function(list, options) {\n\t\tif(false) {\n\t\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t\t}\n\t\n\t\toptions = options || {};\n\t\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t\t// tags it will allow on a page\n\t\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\n\t\n\t\t// By default, add <style> tags to the bottom of <head>.\n\t\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\n\t\n\t\tvar styles = listToStyles(list);\n\t\taddStylesToDom(styles, options);\n\t\n\t\treturn function update(newList) {\n\t\t\tvar mayRemove = [];\n\t\t\tfor(var i = 0; i < styles.length; i++) {\n\t\t\t\tvar item = styles[i];\n\t\t\t\tvar domStyle = stylesInDom[item.id];\n\t\t\t\tdomStyle.refs--;\n\t\t\t\tmayRemove.push(domStyle);\n\t\t\t}\n\t\t\tif(newList) {\n\t\t\t\tvar newStyles = listToStyles(newList);\n\t\t\t\taddStylesToDom(newStyles, options);\n\t\t\t}\n\t\t\tfor(var i = 0; i < mayRemove.length; i++) {\n\t\t\t\tvar domStyle = mayRemove[i];\n\t\t\t\tif(domStyle.refs === 0) {\n\t\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\n\t\t\t\t\t\tdomStyle.parts[j]();\n\t\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\t\n\tfunction addStylesToDom(styles, options) {\n\t\tfor(var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\t\t\tif(domStyle) {\n\t\t\t\tdomStyle.refs++;\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t\t}\n\t\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tvar parts = [];\n\t\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t\t}\n\t\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction listToStyles(list) {\n\t\tvar styles = [];\n\t\tvar newStyles = {};\n\t\tfor(var i = 0; i < list.length; i++) {\n\t\t\tvar item = list[i];\n\t\t\tvar id = item[0];\n\t\t\tvar css = item[1];\n\t\t\tvar media = item[2];\n\t\t\tvar sourceMap = item[3];\n\t\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\t\t\tif(!newStyles[id])\n\t\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\n\t\t\telse\n\t\t\t\tnewStyles[id].parts.push(part);\n\t\t}\n\t\treturn styles;\n\t}\n\t\n\tfunction insertStyleElement(options, styleElement) {\n\t\tvar head = getHeadElement();\n\t\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\n\t\tif (options.insertAt === \"top\") {\n\t\t\tif(!lastStyleElementInsertedAtTop) {\n\t\t\t\thead.insertBefore(styleElement, head.firstChild);\n\t\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\t\thead.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\n\t\t\t} else {\n\t\t\t\thead.appendChild(styleElement);\n\t\t\t}\n\t\t\tstyleElementsInsertedAtTop.push(styleElement);\n\t\t} else if (options.insertAt === \"bottom\") {\n\t\t\thead.appendChild(styleElement);\n\t\t} else {\n\t\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t\t}\n\t}\n\t\n\tfunction removeStyleElement(styleElement) {\n\t\tstyleElement.parentNode.removeChild(styleElement);\n\t\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\n\t\tif(idx >= 0) {\n\t\t\tstyleElementsInsertedAtTop.splice(idx, 1);\n\t\t}\n\t}\n\t\n\tfunction createStyleElement(options) {\n\t\tvar styleElement = document.createElement(\"style\");\n\t\tstyleElement.type = \"text/css\";\n\t\tinsertStyleElement(options, styleElement);\n\t\treturn styleElement;\n\t}\n\t\n\tfunction createLinkElement(options) {\n\t\tvar linkElement = document.createElement(\"link\");\n\t\tlinkElement.rel = \"stylesheet\";\n\t\tinsertStyleElement(options, linkElement);\n\t\treturn linkElement;\n\t}\n\t\n\tfunction addStyle(obj, options) {\n\t\tvar styleElement, update, remove;\n\t\n\t\tif (options.singleton) {\n\t\t\tvar styleIndex = singletonCounter++;\n\t\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\n\t\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\n\t\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\n\t\t} else if(obj.sourceMap &&\n\t\t\ttypeof URL === \"function\" &&\n\t\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\t\ttypeof Blob === \"function\" &&\n\t\t\ttypeof btoa === \"function\") {\n\t\t\tstyleElement = createLinkElement(options);\n\t\t\tupdate = updateLink.bind(null, styleElement);\n\t\t\tremove = function() {\n\t\t\t\tremoveStyleElement(styleElement);\n\t\t\t\tif(styleElement.href)\n\t\t\t\t\tURL.revokeObjectURL(styleElement.href);\n\t\t\t};\n\t\t} else {\n\t\t\tstyleElement = createStyleElement(options);\n\t\t\tupdate = applyToTag.bind(null, styleElement);\n\t\t\tremove = function() {\n\t\t\t\tremoveStyleElement(styleElement);\n\t\t\t};\n\t\t}\n\t\n\t\tupdate(obj);\n\t\n\t\treturn function updateStyle(newObj) {\n\t\t\tif(newObj) {\n\t\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\n\t\t\t\t\treturn;\n\t\t\t\tupdate(obj = newObj);\n\t\t\t} else {\n\t\t\t\tremove();\n\t\t\t}\n\t\t};\n\t}\n\t\n\tvar replaceText = (function () {\n\t\tvar textStore = [];\n\t\n\t\treturn function (index, replacement) {\n\t\t\ttextStore[index] = replacement;\n\t\t\treturn textStore.filter(Boolean).join('\\n');\n\t\t};\n\t})();\n\t\n\tfunction applyToSingletonTag(styleElement, index, remove, obj) {\n\t\tvar css = remove ? \"\" : obj.css;\n\t\n\t\tif (styleElement.styleSheet) {\n\t\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\n\t\t} else {\n\t\t\tvar cssNode = document.createTextNode(css);\n\t\t\tvar childNodes = styleElement.childNodes;\n\t\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\n\t\t\tif (childNodes.length) {\n\t\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\n\t\t\t} else {\n\t\t\t\tstyleElement.appendChild(cssNode);\n\t\t\t}\n\t\t}\n\t}\n\t\n\tfunction applyToTag(styleElement, obj) {\n\t\tvar css = obj.css;\n\t\tvar media = obj.media;\n\t\n\t\tif(media) {\n\t\t\tstyleElement.setAttribute(\"media\", media)\n\t\t}\n\t\n\t\tif(styleElement.styleSheet) {\n\t\t\tstyleElement.styleSheet.cssText = css;\n\t\t} else {\n\t\t\twhile(styleElement.firstChild) {\n\t\t\t\tstyleElement.removeChild(styleElement.firstChild);\n\t\t\t}\n\t\t\tstyleElement.appendChild(document.createTextNode(css));\n\t\t}\n\t}\n\t\n\tfunction updateLink(linkElement, obj) {\n\t\tvar css = obj.css;\n\t\tvar sourceMap = obj.sourceMap;\n\t\n\t\tif(sourceMap) {\n\t\t\t// http://stackoverflow.com/a/26603875\n\t\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t\t}\n\t\n\t\tvar blob = new Blob([css], { type: \"text/css\" });\n\t\n\t\tvar oldSrc = linkElement.href;\n\t\n\t\tlinkElement.href = URL.createObjectURL(blob);\n\t\n\t\tif(oldSrc)\n\t\t\tURL.revokeObjectURL(oldSrc);\n\t}\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.registeredModules = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.registerModule = registerModule;\n\texports.startObserver = startObserver;\n\t\n\tvar _forSelect = __webpack_require__(7);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar registeredModules = exports.registeredModules = new Map(); // name → module\n\t\n\tvar Module = function () {\n\t    function Module(name) {\n\t        var enabledByDefault = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\t        var alwaysEnabled = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t        _classCallCheck(this, Module);\n\t\n\t        this.name = name;\n\t        this.alwaysEnabled = alwaysEnabled;\n\t        this.enabledByDefault = enabledByDefault;\n\t        this.requiredModules = [];\n\t        /**\r\n\t         * Флаг, позволяющий отключить активность модуля, даже если он разрешён в настройках.\r\n\t         * Например, если фронтенд или браузер не поддерживает необходимые фичи.\r\n\t         * @type {boolean}\r\n\t         */\n\t        this.active = true;\n\t        this._watchers = [];\n\t        this._initiators = [];\n\t    }\n\t\n\t    _createClass(Module, [{\n\t        key: \"init\",\n\t        value: function init(callback) {\n\t            this._initiators.push(callback);\n\t        }\n\t    }, {\n\t        key: \"watch\",\n\t        value: function watch(selector, callback) {\n\t            this._watchers.push({ selector: selector, callback: callback });\n\t        }\n\t    }, {\n\t        key: \"required\",\n\t        value: function required(name) {\n\t            this.requiredModules.push(name);\n\t        }\n\t    }, {\n\t        key: \"_initiate\",\n\t        value: function _initiate(settings) {\n\t            if (!this.active) {\n\t                return;\n\t            }\n\t            this._initiators.forEach(function (c) {\n\t                return c(settings);\n\t            });\n\t            this._watchers.forEach(function (_ref) {\n\t                var selector = _ref.selector,\n\t                    callback = _ref.callback;\n\t                return (0, _forSelect2.default)(document.body, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }, {\n\t        key: \"_trigger\",\n\t        value: function _trigger(node) {\n\t            if (!this.active) {\n\t                return;\n\t            }\n\t            this._watchers.forEach(function (_ref2) {\n\t                var selector = _ref2.selector,\n\t                    callback = _ref2.callback;\n\t                return (0, _forSelect2.default)(node, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Module;\n\t}();\n\t\n\tfunction registerModule(name) {\n\t    var enabledByDefault = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\t    var alwaysEnabled = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t    var m = new Module(name, enabledByDefault, alwaysEnabled);\n\t    registeredModules.set(name, m);\n\t    return m;\n\t}\n\t\n\tvar settings = null;\n\t/**\r\n\t *\r\n\t * @param {Settings} aSettings\r\n\t */\n\tfunction startObserver(aSettings) {\n\t    if (settings) {\n\t        return;\n\t    }\n\t    settings = aSettings;\n\t\n\t    registeredModules.forEach(function (m) {\n\t        if (settings.isModuleEnabled(m)) {\n\t            m._initiate(settings);\n\t        }\n\t    });\n\t\n\t    var observer = new MutationObserver(function (mutations) {\n\t        mutations.forEach(function (mutation) {\n\t            var _loop = function _loop(i, l) {\n\t                var node = mutation.addedNodes[i];\n\t                if (node.nodeType == Node.ELEMENT_NODE) {\n\t                    registeredModules.forEach(function (m) {\n\t                        if (settings.isModuleEnabled(m)) {\n\t                            m._trigger(node, settings);\n\t                        }\n\t                    });\n\t                }\n\t            };\n\t\n\t            for (var i = 0, l = mutation.addedNodes.length; i < l; i++) {\n\t                _loop(i, l);\n\t            }\n\t        });\n\t    });\n\t\n\t    observer.observe(document.body, { childList: true, subtree: true });\n\t}\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _matches = __webpack_require__(8);\n\t\n\tvar _matches2 = _interopRequireDefault(_matches);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\r\n\t * @param {Document|DocumentFragment|Element} node\r\n\t * @param {string} selector\r\n\t * @param {function(Node)} [foo]\r\n\t */\n\texports.default = function (node, selector, foo) {\n\t    if (node === null) return [];\n\t    var nodeList = node.querySelectorAll(selector);\n\t    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\n\t    if ((0, _matches2.default)(node, selector)) nodes.unshift(node);\n\t    if (foo) {\n\t        for (var i = 0, l = nodes.length; i < l; i++) {\n\t            foo(nodes[i]);\n\t        }\n\t    }\n\t    return nodes;\n\t};\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (node, selector) {\n\t  return node[matchesMethod](selector);\n\t};\n\t\n\tvar matchesMethod = \"matches\" in HTMLElement.prototype ? \"matches\" : \"msMatchesSelector\";\n\t\n\t/**\r\n\t *\r\n\t * @param {HTMLElement} node\r\n\t * @param {String} selector\r\n\t * @return {Boolean}\r\n\t */\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.getCurrentAuth = getCurrentAuth;\n\tvar sitesProps = {\n\t    \"freefeed.net\": {\n\t        cookies: [\"freefeedBETA_authToken\", \"freefeed_authToken\"]\n\t    },\n\t    \"gamma.freefeed.net\": {\n\t        cookies: [\"freefeed_authToken\"]\n\t    }\n\t};\n\t\n\tvar siteDomain = exports.siteDomain = location.hostname;\n\tvar cookieName = exports.cookieName = \"freefeedBETA_authToken\";\n\t\n\tfunction getCurrentAuth() {\n\t    if (siteDomain in sitesProps) {\n\t        var _iteratorNormalCompletion = true;\n\t        var _didIteratorError = false;\n\t        var _iteratorError = undefined;\n\t\n\t        try {\n\t            for (var _iterator = sitesProps[siteDomain].cookies[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n\t                var cName = _step.value;\n\t\n\t                var _extractFromJWT = extractFromJWT(localStorage.getItem(cName)),\n\t                    userId = _extractFromJWT.userId,\n\t                    authToken = _extractFromJWT.authToken;\n\t\n\t                if (userId) {\n\t                    return { userId: userId, authToken: authToken };\n\t                }\n\t            }\n\t        } catch (err) {\n\t            _didIteratorError = true;\n\t            _iteratorError = err;\n\t        } finally {\n\t            try {\n\t                if (!_iteratorNormalCompletion && _iterator.return) {\n\t                    _iterator.return();\n\t                }\n\t            } finally {\n\t                if (_didIteratorError) {\n\t                    throw _iteratorError;\n\t                }\n\t            }\n\t        }\n\t    }\n\t    return { userId: null, authToken: null };\n\t}\n\t\n\tfunction extractFromJWT(jwtString) {\n\t    if (jwtString !== null) {\n\t        var parts = jwtString.split(\".\");\n\t        if (parts.length === 3) {\n\t            try {\n\t                var payload = JSON.parse(atob(parts[1]));\n\t                if (\"userId\" in payload) {\n\t                    return { authToken: jwtString, userId: payload[\"userId\"] };\n\t                }\n\t            } catch (e) {}\n\t        }\n\t    }\n\t    return { authToken: null, userId: null };\n\t}\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _api = __webpack_require__(11);\n\t\n\tvar api = _interopRequireWildcard(_api);\n\t\n\tvar _userpics = __webpack_require__(12);\n\t\n\tvar uPics = _interopRequireWildcard(_userpics);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar prefsName = \"me.davidmz.BetterFeed2\";\n\t\n\tvar IAm = function () {\n\t    function IAm() {\n\t        _classCallCheck(this, IAm);\n\t\n\t        this.me = null;\n\t        this.myID = null;\n\t        this.myScreenName = null;\n\t        this.friends = [];\n\t        this.readers = [];\n\t        this.banIds = [];\n\t        this.bf2Props = {};\n\t\n\t        this._savePropsQueue = [];\n\t        this._savingPropsNow = false;\n\t        this._savingIndicator = (0, _html2.default)(\".bf2-saving-settings-indicator\", \"Saving settings…\");\n\t    }\n\t\n\t    _createClass(IAm, [{\n\t        key: 'whoIs',\n\t        value: function whoIs(username) {\n\t            var flags = 0;\n\t            if (username === this.me) flags |= IAm.ME;\n\t            if (this.friends.indexOf(username) !== -1) flags |= IAm.FRIEND;\n\t            if (this.readers.indexOf(username) !== -1) flags |= IAm.READER;\n\t            return flags;\n\t        }\n\t    }, {\n\t        key: 'isBanned',\n\t        value: function isBanned(userId) {\n\t            return this.banIds.indexOf(userId) !== -1;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Settings} s\r\n\t         */\n\t\n\t    }, {\n\t        key: 'saveProps',\n\t        value: function saveProps(s) {\n\t            this._savePropsQueue.push(s.toJSON());\n\t            return this._saveProps();\n\t        }\n\t\n\t        /**\r\n\t         * Последовательное сохранение настроек по очереди\r\n\t         * @private\r\n\t         */\n\t\n\t    }, {\n\t        key: '_saveProps',\n\t        value: function () {\n\t            var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t                var json, nulls, k;\n\t                return regeneratorRuntime.wrap(function _callee$(_context) {\n\t                    while (1) {\n\t                        switch (_context.prev = _context.next) {\n\t                            case 0:\n\t                                if (!this._savingPropsNow) {\n\t                                    _context.next = 2;\n\t                                    break;\n\t                                }\n\t\n\t                                return _context.abrupt('return');\n\t\n\t                            case 2:\n\t\n\t                                document.body.appendChild(this._savingIndicator);\n\t                                this._savingPropsNow = true;\n\t\n\t                            case 4:\n\t                                if (!(this._savePropsQueue.length > 0)) {\n\t                                    _context.next = 11;\n\t                                    break;\n\t                                }\n\t\n\t                                json = this._savePropsQueue.shift(), nulls = {};\n\t\n\t                                for (k in json) {\n\t                                    if (json.hasOwnProperty(k)) nulls[k] = null;\n\t                                }_context.next = 9;\n\t                                return api.put('/v1/users/' + this.myID, JSON.stringify({ user: { frontendPreferences: _defineProperty({}, prefsName, json) } }));\n\t\n\t                            case 9:\n\t                                _context.next = 4;\n\t                                break;\n\t\n\t                            case 11:\n\t                                this._savingPropsNow = false;\n\t                                document.body.removeChild(this._savingIndicator);\n\t\n\t                            case 13:\n\t                            case 'end':\n\t                                return _context.stop();\n\t                        }\n\t                    }\n\t                }, _callee, this);\n\t            }));\n\t\n\t            function _saveProps() {\n\t                return _ref.apply(this, arguments);\n\t            }\n\t\n\t            return _saveProps;\n\t        }()\n\t    }]);\n\t\n\t    return IAm;\n\t}();\n\t\n\texports.default = IAm;\n\t\n\t\n\tIAm.ME = 1 << 0;\n\tIAm.FRIEND = 1 << 1;\n\tIAm.READER = 1 << 2;\n\t\n\tIAm.ready = null;\n\t\n\tIAm.update = function () {\n\t    IAm.ready = api.get('/v2/users/whoami').then(function (resp) {\n\t        var iAm = new IAm();\n\t        iAm.me = resp.users.username;\n\t        iAm.myID = resp.users.id;\n\t        iAm.myScreenName = resp.users.screenName;\n\t        uPics.setPic(resp.users.username, resp.users.profilePictureMediumUrl);\n\t        iAm.friends = resp.subscribers.map(function (it) {\n\t            uPics.setPic(it.username, it.profilePictureMediumUrl);\n\t            return it.username;\n\t        });\n\t        iAm.readers = resp.users.subscribers.map(function (it) {\n\t            uPics.setPic(it.username, it.profilePictureMediumUrl);\n\t            return it.username;\n\t        });\n\t        iAm.banIds = resp.users.banIds;\n\t        iAm.bf2Props = resp.users.frontendPreferences[prefsName] || {};\n\t\n\t        return iAm;\n\t    });\n\t};\n\t\n\tIAm.update();\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.get = get;\n\texports.put = put;\n\texports.del = del;\n\texports.post = post;\n\texports.anonFormPost = anonFormPost;\n\t\n\tvar _currentUserId = __webpack_require__(9);\n\t\n\tvar apiRoot = \"https://freefeed.net\";\n\t\n\tfunction get(path) {\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('GET', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('Authorization', 'Bearer ' + (0, _currentUserId.getCurrentAuth)().authToken);\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send();\n\t    });\n\t}\n\t\n\tfunction put(path, body) {\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('PUT', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('Authorization', 'Bearer ' + (0, _currentUserId.getCurrentAuth)().authToken);\n\t        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send(body);\n\t    });\n\t}\n\t\n\tfunction del(path, body) {\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('DELETE', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('Authorization', 'Bearer ' + (0, _currentUserId.getCurrentAuth)().authToken);\n\t        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send(body);\n\t    });\n\t}\n\t\n\tfunction post(path, body) {\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('POST', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('Authorization', 'Bearer ' + (0, _currentUserId.getCurrentAuth)().authToken);\n\t        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send(body);\n\t    });\n\t}\n\t\n\tfunction anonFormPost(path, body) {\n\t    return new Promise(function (resolve, reject) {\n\t        var xhr = new XMLHttpRequest();\n\t        xhr.open('POST', apiURL(path));\n\t        xhr.responseType = 'json';\n\t        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');\n\t        xhr.onload = function () {\n\t            if (xhr.response && \"err\" in xhr.response) {\n\t                reject(xhr.response.err);\n\t            } else {\n\t                resolve(xhr.response);\n\t            }\n\t        };\n\t        xhr.send(body);\n\t    });\n\t}\n\t\n\tfunction apiURL(path) {\n\t    return apiRoot + path + (path.indexOf(\"?\") !== -1 ? \"&\" : \"?\") + \"_initiator=betterfeed2\";\n\t}\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.defaultPic = undefined;\n\t\n\tvar picLoad = function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(username) {\n\t        var resp;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        _context.next = 2;\n\t                        return fetch(\"https://davidmz.me/frfrfr/uinfo/upic?username=\" + username);\n\t\n\t                    case 2:\n\t                        _context.next = 4;\n\t                        return _context.sent.json();\n\t\n\t                    case 4:\n\t                        resp = _context.sent;\n\t                        return _context.abrupt(\"return\", resp.status === \"ok\" && resp.data !== \"\" ? resp.data : defaultPic);\n\t\n\t                    case 6:\n\t                    case \"end\":\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this);\n\t    }));\n\t\n\t    return function picLoad(_x) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\texports.getPic = getPic;\n\texports.setPic = setPic;\n\t\n\tvar _bfRoot = __webpack_require__(13);\n\t\n\tvar _bfRoot2 = _interopRequireDefault(_bfRoot);\n\t\n\t__webpack_require__(14);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar defaultPic = exports.defaultPic = _bfRoot2.default + \"/build/default-userpic-50.png\";\n\tvar picRegistry = new Map();\n\t\n\tfunction getPic(username) {\n\t    if (!picRegistry.has(username)) {\n\t        picRegistry.set(username, picLoad(username));\n\t    }\n\t    return picRegistry.get(username);\n\t}\n\t\n\tfunction setPic(username, pic) {\n\t    picRegistry.set(username, Promise.resolve(pic && pic !== \"\" ? pic : defaultPic));\n\t}\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\tvar myRoot = window.__BetterFeedRoot || \"https://cdn.jsdelivr.net/gh/davidmz/BetterFeed2@\" + localStorage['bf2-version'];\n\tif (document.currentScript) {\n\t    var pr = document.currentScript.src.split(\"/\");\n\t    myRoot = pr.slice(0, pr.length - 2).join(\"/\");\n\t}\n\t\n\texports.default = myRoot;\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__.p + \"default-userpic-50.png\";\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\texports.default = h;\n\t\n\tvar _isArray = __webpack_require__(16);\n\t\n\tvar _isArray2 = _interopRequireDefault(_isArray);\n\t\n\tvar _htmlTpl = __webpack_require__(17);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\r\n\t * h(\"tag.class\", {attr: val}, child)\r\n\t * h(\"tag.class\", child)\r\n\t * h(\"tag.class\", {attr: val})\r\n\t * h(\"tag.class\")\r\n\t * h(\".class\") // div\r\n\t * h(\"$\") // document fragment\r\n\t *\r\n\t * Класс, заданный через атрибуты, перекрывает классы из строки тегов\r\n\t *\r\n\t * @param {String} tagName - tag или tag.class1.class2 (поддерживаются только классы)\r\n\t * @param {Object} [attrs]\r\n\t * @param {Node|string|Array} [children]\r\n\t * @return {HTMLElement}\r\n\t */\n\tfunction h(tagName, attrs, children) {\n\t    var i, k;\n\t    var tagParts = tagName.split(\".\");\n\t    var tn = tagParts.shift() || \"div\";\n\t    var el;\n\t    if (tn === \"$\") {\n\t        el = document.createDocumentFragment();\n\t    } else {\n\t        el = document.createElement(tn);\n\t        if (tagParts.length > 0) {\n\t            el.className = tagParts.join(\" \");\n\t        }\n\t    }\n\t\n\t    var chStart = 1;\n\t    if (arguments.length > 1 && (typeof attrs === \"undefined\" ? \"undefined\" : _typeof(attrs)) === \"object\" && !(attrs instanceof Node) && !(0, _isArray2.default)(attrs) && !(0, _htmlTpl.isSafeHTML)(attrs)) {\n\t        for (k in attrs) {\n\t            if (attrs.hasOwnProperty(k)) el.setAttribute(k, attrs[k]);\n\t        }chStart = 2;\n\t    }\n\t\n\t    if (arguments.length > chStart) {\n\t        for (i = chStart; i < arguments.length; i++) {\n\t            append(el, arguments[i]);\n\t        }\n\t    }\n\t    return el;\n\t};\n\t\n\tfunction append(el, it) {\n\t    if (it instanceof Node) {\n\t        el.appendChild(it);\n\t    } else if ((0, _isArray2.default)(it)) {\n\t        it.forEach(append.bind(null, el));\n\t    } else if (typeof it === \"string\") {\n\t        el.appendChild(document.createTextNode(it));\n\t    } else if ((0, _htmlTpl.isSafeHTML)(it)) {\n\t        el.insertAdjacentHTML('beforeEnd', it.toString());\n\t    }\n\t}\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\texports.default = Array.isArray || function (arr) {\n\t    return Object.prototype.toString.call(arr) == '[object Array]';\n\t};\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.safeHTML = safeHTML;\n\texports.isSafeHTML = isSafeHTML;\n\texports.html = html;\n\t\n\tvar _escapeHtml = __webpack_require__(18);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar SafeHTML = function () {\n\t    function SafeHTML(text) {\n\t        _classCallCheck(this, SafeHTML);\n\t\n\t        this.text = text;\n\t    }\n\t\n\t    _createClass(SafeHTML, [{\n\t        key: \"toString\",\n\t        value: function toString() {\n\t            return this.text;\n\t        }\n\t    }]);\n\t\n\t    return SafeHTML;\n\t}();\n\t\n\tfunction safeHTML(text) {\n\t    return new SafeHTML(text);\n\t}\n\t\n\tfunction isSafeHTML(h) {\n\t    return h instanceof SafeHTML;\n\t}\n\t\n\tfunction html(tpl) {\n\t    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n\t        args[_key - 1] = arguments[_key];\n\t    }\n\t\n\t    return safeHTML(tpl.reduce(function (acc, part, i) {\n\t        var a = args[i - 1];\n\t        return acc + (isSafeHTML(a) ? a : (0, _escapeHtml2.default)(a)) + part;\n\t    }));\n\t}\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function () {\n\t  var s = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n\t\n\t  return s.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\n\t};\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = new Promise(function (resolve) {\n\t    if (document.readyState === 'complete' || document.readyState === 'interactive') {\n\t        setTimeout(resolve, 0);\n\t    } else {\n\t        document.addEventListener(\"DOMContentLoaded\", resolve);\n\t    }\n\t});\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Settings = function () {\n\t    function Settings() {\n\t        var _this = this;\n\t\n\t        var o = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t        var trustedData = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\t\n\t        _classCallCheck(this, Settings);\n\t\n\t        this.modules = new Map();\n\t        _modules.registeredModules.forEach(function (m) {\n\t            if (!m.alwaysEnabled) {\n\t                _this.modules.set(m.name, m.enabledByDefault);\n\t            }\n\t        });\n\t\n\t        this.hideAliens = false;\n\t        this.commentCloudsMode = 2;\n\t\n\t        // инициализация из объекта\n\t        if (o) {\n\t            (o.modules || []).forEach(function (_ref) {\n\t                var _ref2 = _slicedToArray(_ref, 2),\n\t                    k = _ref2[0],\n\t                    v = _ref2[1];\n\t\n\t                if (trustedData || _this.modules.has(k)) {\n\t                    _this.modules.set(k, !!v);\n\t                }\n\t            });\n\t            this.hideAliens = !!o.hideAliens;\n\t            if (o.commentCloudsMode === 1 || o.commentCloudsMode === 2) {\n\t                this.commentCloudsMode = o.commentCloudsMode;\n\t            }\n\t        }\n\t    }\n\t\n\t    _createClass(Settings, [{\n\t        key: \"toJSON\",\n\t        value: function toJSON() {\n\t            var o = { modules: [] };\n\t            this.modules.forEach(function (v, k) {\n\t                return o.modules.push([k, v]);\n\t            });\n\t            o.hideAliens = this.hideAliens;\n\t            o.commentCloudsMode = this.commentCloudsMode;\n\t            return o;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Module} m\r\n\t         * @return {boolean}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"isModuleEnabled\",\n\t        value: function isModuleEnabled(m) {\n\t            var _this2 = this;\n\t\n\t            return m && (m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name)) && !m.requiredModules.map(function (name) {\n\t                return _modules.registeredModules.get(name);\n\t            }).some(function (m) {\n\t                return !_this2.isModuleEnabled(m);\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Settings;\n\t}();\n\t\n\texports.default = Settings;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nextRequestId = 1;\n\t\n\tvar responseAction = \"@response\";\n\t\n\tvar Messenger = function () {\n\t    function Messenger() {\n\t        var _this = this;\n\t\n\t        var parentWindow = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n\t        var parentOrigin = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : \"\";\n\t\n\t        _classCallCheck(this, Messenger);\n\t\n\t        this.__responders = new Map();\n\t        this.__listeners = new Map();\n\t\n\t        this.defaultWindow = parentWindow;\n\t        this.defaultOrigin = parentOrigin;\n\t\n\t        window.addEventListener('message', function (event) {\n\t            if (_typeof(event.data) !== \"object\") {\n\t                return;\n\t            }\n\t            //noinspection UnnecessaryLocalVariableJS\n\t            var _event$data = event.data,\n\t                action = _event$data.action,\n\t                requestId = _event$data.requestId,\n\t                value = _event$data.value,\n\t                source = event.source,\n\t                origin = event.origin;\n\t\n\t\n\t            if (action === responseAction && _this.__responders.has(requestId)) {\n\t                _this.__responders.get(requestId)(value);\n\t                _this.__responders.delete(requestId);\n\t            } else if (_this.__listeners.has(action)) {\n\t                var resp = _this.__listeners.get(action)(value);\n\t                source.postMessage({ action: responseAction, requestId: requestId, value: resp }, origin);\n\t            }\n\t        });\n\t    }\n\t\n\t    /**\r\n\t     *\r\n\t     * @param {String} action\r\n\t     * @param {*} value\r\n\t     * @return {Promise}\r\n\t     */\n\t\n\t\n\t    _createClass(Messenger, [{\n\t        key: \"send\",\n\t        value: function send(action) {\n\t            var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\t\n\t            return this.sendEx(this.defaultWindow, this.defaultOrigin, action, value);\n\t        }\n\t\n\t        /**\r\n\t         *\r\n\t         * @param {Window} window\r\n\t         * @param {String} origin\r\n\t         * @param {String} action\r\n\t         * @param {*} value\r\n\t         * @return {Promise}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"sendEx\",\n\t        value: function sendEx(window, origin, action) {\n\t            var _this2 = this;\n\t\n\t            var value = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : null;\n\t\n\t            return new Promise(function (resolve) {\n\t                var requestId = nextRequestId++;\n\t                _this2.__responders.set(requestId, resolve);\n\t                window.postMessage({ action: action, requestId: requestId, value: value }, origin);\n\t            });\n\t        }\n\t\n\t        /**\r\n\t         *\r\n\t         * @param {String} action\r\n\t         * @param {function} callback\r\n\t         */\n\t\n\t    }, {\n\t        key: \"on\",\n\t        value: function on(action, callback) {\n\t            this.__listeners.set(action, callback);\n\t        }\n\t    }]);\n\t\n\t    return Messenger;\n\t}();\n\t\n\texports.default = Messenger;\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _closestParent = __webpack_require__(23);\n\t\n\tvar _closestParent2 = _interopRequireDefault(_closestParent);\n\t\n\tvar _onHistory = __webpack_require__(24);\n\t\n\tvar _onHistory2 = _interopRequireDefault(_onHistory);\n\t\n\tvar _forSelect = __webpack_require__(7);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tvar _iAm = __webpack_require__(10);\n\t\n\tvar _iAm2 = _interopRequireDefault(_iAm);\n\t\n\tvar _currentUserId = __webpack_require__(9);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"common\", true, true);\n\t\n\t_module.init(function () {\n\t    (0, _onHistory2.default)(function (location) {\n\t        var isHomePage = location.pathname === \"/\";\n\t        var isBestOf = location.pathname === \"/filter/best_of\";\n\t        document.body.classList.toggle(\"bf2-homepage\", isHomePage);\n\t        document.body.classList.toggle(\"bf2-best-of\", isBestOf);\n\t        document.body.classList.toggle(\"bf2-aggregate-page\", isHomePage || isBestOf);\n\t    });\n\t\n\t    document.addEventListener(\"click\", function (e) {\n\t        if (e.button == 0 && e.target.classList.contains(\"bf2-user-link\")) {\n\t            //noinspection JSUnresolvedVariable\n\t            var reactLink = document.querySelector(\"a:not(.bf2-user-link)[href=\\\"\" + CSS.escape(e.target.getAttribute(\"href\")) + \"\\\"]\");\n\t            if (reactLink) {\n\t                e.preventDefault();\n\t                e.target.blur();\n\t                reactLink.click();\n\t            }\n\t        }\n\t    });\n\t\n\t    if (_currentUserId.siteDomain === \"gamma.freefeed.net\") {\n\t        document.body.classList.add(\"bf2-gamma-frontend\");\n\t    }\n\t});\n\t\n\t// Свойства постов\n\t_module.watch(\".timeline-post, .single-post\", function (node) {\n\t    // ID поста\n\t    var postId = node.querySelector(\".post-timestamp\").getAttribute(\"href\").match(/^\\/.+?\\/([\\w-]+)/)[1];\n\t    node.id = \"post-\" + postId;\n\t    node.dataset.postId = postId;\n\t\n\t    // Автор поста\n\t    var postAuthor = node.querySelector(\".post-author\").getAttribute(\"href\").substr(1);\n\t    node.dataset.postAuthor = postAuthor;\n\t    node.classList.add(\"bf2-post-from-\" + postAuthor);\n\t\n\t    // Адресаты поста\n\t    (0, _forSelect2.default)(node, \".post-recipient\").map(function (a) {\n\t        return a.getAttribute(\"href\").substr(1);\n\t    }).filter(function (u) {\n\t        return u !== postAuthor;\n\t    }).forEach(function (u) {\n\t        return node.classList.add(\"bf2-post-to-\" + u);\n\t    });\n\t\n\t    // Язык поста\n\t    var postBody = node.querySelector(\".post-text\");\n\t    var firstComment = node.querySelector(\".comment-body\");\n\t    if (isArabic(postBody.textContent) || firstComment && isArabic(firstComment.textContent)) {\n\t        node.classList.add(\"bf2-lang-arabic\");\n\t    }\n\t});\n\t\n\t// User cards\n\t_module.watch(\".user-card .display-name\", function (node) {\n\t    (0, _closestParent2.default)(node, \".user-card\").dataset.userName = node.getAttribute(\"href\").substr(1);\n\t});\n\t\n\t// Свойства комментариев\n\t_module.watch(\".comment\", function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(node) {\n\t        var commentAuthor, postAuthor, commProps, type;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        commentAuthor = getCommentAuthor(node);\n\t\n\t                        if (commentAuthor) {\n\t                            _context.next = 3;\n\t                            break;\n\t                        }\n\t\n\t                        return _context.abrupt(\"return\");\n\t\n\t                    case 3:\n\t                        postAuthor = getPostAuthor((0, _closestParent2.default)(node, \".post\"));\n\t\n\t                        if (postAuthor) {\n\t                            _context.next = 6;\n\t                            break;\n\t                        }\n\t\n\t                        return _context.abrupt(\"return\");\n\t\n\t                    case 6:\n\t                        commProps = [];\n\t\n\t\n\t                        commProps.push(\"from\");\n\t\n\t                        if (postAuthor === commentAuthor) {\n\t                            commProps.push(\"from-post-author\");\n\t                        }\n\t\n\t                        _context.next = 11;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 11:\n\t                        _context.t0 = commentAuthor;\n\t                        type = _context.sent.whoIs(_context.t0);\n\t\n\t                        if (type & _iAm2.default.ME) {\n\t                            commProps.push(\"from-me\");\n\t                        } else if (type & _iAm2.default.FRIEND) {\n\t                            commProps.push(\"from-friend\");\n\t                        } else if (type & _iAm2.default.READER) {\n\t                            commProps.push(\"from-reader\");\n\t                        }\n\t\n\t                        node.dataset.commProps = commProps.join(\" \");\n\t\n\t                    case 15:\n\t                    case \"end\":\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, undefined);\n\t    }));\n\t\n\t    return function (_x) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}());\n\t\n\tfunction getCommentAuthor(commentNode) {\n\t    var author = commentNode.dataset[\"author\"];\n\t    if (!author) {\n\t        var authorLink = commentNode.querySelector(\".comment-body > .user-name-wrapper > a\");\n\t        if (authorLink) {\n\t            author = authorLink.getAttribute(\"href\").substr(1);\n\t            commentNode.dataset[\"author\"] = author;\n\t        }\n\t    }\n\t    return author;\n\t}\n\t\n\tfunction getPostAuthor(postNode) {\n\t    var author = postNode.dataset[\"author\"];\n\t    if (!author) {\n\t        var authorLink = postNode.querySelector(\".post-header a.post-author\");\n\t        if (authorLink) {\n\t            author = authorLink.getAttribute(\"href\").substr(1);\n\t            postNode.dataset[\"author\"] = author;\n\t        }\n\t    }\n\t    return author;\n\t}\n\t\n\t/**\r\n\t *\r\n\t * @param {string} text\r\n\t * @return {boolean}\r\n\t */\n\tfunction isArabic(text) {\n\t    return (/[\\u0600-\\u06ff\\u0700-\\u077f\\u08A0-\\u08ff]/.test(text)\n\t    );\n\t}\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = closestParent;\n\t\n\tvar _matches = __webpack_require__(8);\n\t\n\tvar _matches2 = _interopRequireDefault(_matches);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar native = !!Element.prototype.closest;\n\t\n\t/**\r\n\t *\r\n\t * @param {Element|null} element\r\n\t * @param {string} selector\r\n\t * @param {boolean} [withSelf]\r\n\t * @return {Element|null}\r\n\t */\n\tfunction closestParent(element, selector) {\n\t    var withSelf = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\t\n\t    if (element === null) return null;\n\t    var p = withSelf ? element : element.parentNode;\n\t    if (native && p) return p.closest(selector);\n\t\n\t    if (p && p.nodeType == Node.ELEMENT_NODE) {\n\t        return (0, _matches2.default)(p, selector) ? p : closestParent(p, selector);\n\t    }\n\t    return null;\n\t};\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\texports.default = function (callback) {\n\t    listeners.push(callback);\n\t    callback(location);\n\t};\n\t\n\tvar listeners = [];\n\t\n\tvar oldPushState = history.pushState.bind(history),\n\t    oldReplaceState = history.replaceState.bind(history);\n\t\n\thistory.pushState = function (state, title, url) {\n\t    oldPushState(state, title, url);\n\t    listeners.forEach(function (c) {\n\t        return c(location);\n\t    });\n\t};\n\t\n\thistory.replaceState = function (state, title, url) {\n\t    oldReplaceState(state, title, url);\n\t    listeners.forEach(function (c) {\n\t        return c(location);\n\t    });\n\t};\n\t\n\twindow.addEventListener(\"popstate\", function () {\n\t    return listeners.forEach(function (c) {\n\t        return c(location);\n\t    });\n\t});\n\n/***/ }),\n/* 25 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar showSettings = function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t        var url, html, htmlUrl;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        url = _bfRoot2.default + '/src/html/settings.html';\n\t                        _context.next = 3;\n\t                        return fetch(url).then(function (r) {\n\t                            return r.text();\n\t                        });\n\t\n\t                    case 3:\n\t                        _context.t0 = (0, _escapeHtml2.default)(location.origin);\n\t                        _context.t1 = (0, _escapeHtml2.default)(version);\n\t                        _context.t2 = (0, _escapeHtml2.default)(_bfRoot2.default + '/');\n\t                        html = _context.sent.replace(/\\[\\[parentOrigin]]/g, _context.t0).replace(/\\[\\[betterFeedVersion]]/g, _context.t1).replace(/\\[\\[baseURL]]/g, _context.t2);\n\t                        htmlUrl = URL.createObjectURL(new Blob([html], { type: \"text/html;charset=utf-8\" }));\n\t\n\t                        if (!/iPhone|iPad/.test(navigator.userAgent)) {\n\t                            _context.next = 11;\n\t                            break;\n\t                        }\n\t\n\t                        window.open(htmlUrl, \"_blank\");\n\t                        return _context.abrupt(\"return\");\n\t\n\t                    case 11:\n\t\n\t                        new _lightbox2.default(\"bf2-settings-lightbox\").showContent((0, _html2.default)(\"iframe\", { src: htmlUrl, frameborder: \"0\" }));\n\t\n\t                    case 12:\n\t                    case \"end\":\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this);\n\t    }));\n\t\n\t    return function showSettings() {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tvar _bfRoot = __webpack_require__(13);\n\t\n\tvar _bfRoot2 = _interopRequireDefault(_bfRoot);\n\t\n\tvar _lightbox = __webpack_require__(26);\n\t\n\tvar _lightbox2 = _interopRequireDefault(_lightbox);\n\t\n\tvar _escapeHtml = __webpack_require__(18);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar version = (\"v2.20.1\");\n\t\n\tvar _module = (0, _modules.registerModule)(\"settings-link\", true, true);\n\t\n\t_module.watch(\".sidebar\", function (node) {\n\t    if (node.querySelector(\".bf2-sidebar-box\")) {\n\t        return;\n\t    }\n\t\n\t    var link = (0, _html2.default)(\"a\", \"BetterFeed settings\");\n\t    var html = (0, _html2.default)(\".bf2-sidebar-box.box\", (0, _html2.default)(\".box-header-groups\", \"Add-ons\"), (0, _html2.default)(\".box-body\", (0, _html2.default)(\"ul\", (0, _html2.default)(\"li\", link))), (0, _html2.default)(\".box-footer\", version));\n\t\n\t    var someBox = node.querySelector(\".box\");\n\t\n\t    someBox.parentNode.insertBefore(html, null);\n\t\n\t    link.addEventListener(\"click\", showSettings);\n\t});\n\n/***/ }),\n/* 26 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Lightbox = function () {\n\t    /**\r\n\t     * @param {string} className\r\n\t     * @param {boolean} modal\r\n\t     */\n\t    function Lightbox() {\n\t        var _this = this;\n\t\n\t        var className = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : \"\";\n\t        var modal = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\t\n\t        _classCallCheck(this, Lightbox);\n\t\n\t        this._container = (0, _html2.default)(\".bf2-lightbox-container\");\n\t        if (className !== \"\") {\n\t            this._container.classList.add(className);\n\t        }\n\t        var shadow = this._container.appendChild((0, _html2.default)(\".bf2-lightbox-shadow\"));\n\t        /** @var {HTMLElement} */\n\t        this.contentEl = shadow.appendChild((0, _html2.default)(\".bf2-lightbox-content\"));\n\t        shadow.addEventListener(\"click\", function (e) {\n\t            if (e.target === shadow && !modal) {\n\t                _this.hide();\n\t            }\n\t        });\n\t    }\n\t\n\t    /**\r\n\t     * @param {HTMLElement|string} el\r\n\t     */\n\t\n\t\n\t    _createClass(Lightbox, [{\n\t        key: \"showContent\",\n\t        value: function showContent(el) {\n\t            if (typeof el === \"string\") {\n\t                this.contentEl.innerHTML = el;\n\t            } else {\n\t                this.contentEl.innerHTML = \"\";\n\t                this.contentEl.appendChild(el);\n\t            }\n\t            document.body.appendChild(this._container);\n\t        }\n\t    }, {\n\t        key: \"hide\",\n\t        value: function hide() {\n\t            this.contentEl.innerHTML = \"\";\n\t            this._container.parentNode.removeChild(this._container);\n\t        }\n\t    }]);\n\t\n\t    return Lightbox;\n\t}();\n\t\n\texports.default = Lightbox;\n\n/***/ }),\n/* 27 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"moon\");\n\t\n\t//noinspection HtmlUnknownAttribute \n\tvar moonXML = \"<svg class=\\\"bf2-moon\\\" viewBox=\\\"-4 -4 108 108\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" version=\\\"1.1\\\">\\n        <circle class=\\\"bf2-moon-shadow\\\" cx=\\\"50\\\" cy=\\\"50\\\" r=\\\"54\\\"></circle>\\n        <path class=\\\"bf2-moon-light\\\" d=\\\"M 50 0 a 30 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z\\\"></path>\\n    </svg>\";\n\t\n\t_module.watch(\"h1\", function (node) {\n\t    node.appendChild((0, _html2.default)(\".bf2-moon-cont\")).innerHTML = moonXML;\n\t    drawMoonPhase(currentMoonPhase());\n\t    setInterval(function () {\n\t        return drawMoonPhase(currentMoonPhase());\n\t    }, 1000 * 3600);\n\t});\n\t\n\tvar newMoon = new Date(\"Thu Apr 07 2016 14:22:37 GMT+0300\").getTime(),\n\t    month = Math.round(86400 * 29.53058812 * 1000);\n\t\n\tfunction currentMoonPhase() {\n\t    return (new Date().getTime() - newMoon) / month % 1;\n\t}\n\t\n\t// phase = [0..1], 0 = 1 = новолуние, 0.5 = полнолуние\n\tfunction drawMoonPhase(phase) {\n\t    var moonEl = document.querySelector(\".bf2-moon\");\n\t    if (!moonEl) {\n\t        return;\n\t    }\n\t    var lightEl = moonEl.querySelector(\".bf2-moon-light\");\n\t    var radius = 50;\n\t    var xRadius = radius * Math.abs(Math.cos(2 * Math.PI * phase));\n\t\n\t    var path = void 0;\n\t    if (phase < 0.25) {\n\t        path = \"M 50 0 a \" + xRadius + \" 50 0 0 1 0 100 a 50 50 0 0 0 0 -100 Z\";\n\t    } else if (phase < 0.5) {\n\t        path = \"M 50 0 a \" + xRadius + \" 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z\";\n\t    } else if (phase < 0.75) {\n\t        path = \"M 50 0 a 50 50 0 0 0 0 100 a \" + xRadius + \" 50 0 0 0 0 -100 Z\";\n\t    } else {\n\t        path = \"M 50 0 a 50 50 0 0 0 0 100 a \" + xRadius + \" 50 0 0 1 0 -100 Z\";\n\t    }\n\t    lightEl.setAttribute(\"d\", path);\n\t\n\t    if (Math.abs(0.5 - phase) < 0.05) {\n\t        moonEl.parentNode.setAttribute(\"title\", \"Achtung Vollmond!\");\n\t    } else {\n\t        moonEl.parentNode.removeAttribute(\"title\");\n\t    }\n\t}\n\n/***/ }),\n/* 28 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar showSwitchDialog = function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        lb = new _lightbox2.default(\"bf2-switch-account-box\");\n\t                        lb.showContent(\"<p>Loading\\u2026</p>\");\n\t                        _context.t0 = lb;\n\t                        _context.next = 5;\n\t                        return genHtml();\n\t\n\t                    case 5:\n\t                        _context.t1 = _context.sent;\n\t\n\t                        _context.t0.showContent.call(_context.t0, _context.t1);\n\t\n\t                    case 7:\n\t                    case \"end\":\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, this);\n\t    }));\n\t\n\t    return function showSwitchDialog() {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar genHtml = function () {\n\t    var _ref2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n\t        var _this = this;\n\t\n\t        var _ref3, me, form;\n\t\n\t        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n\t            while (1) {\n\t                switch (_context3.prev = _context3.next) {\n\t                    case 0:\n\t                        _context3.next = 2;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 2:\n\t                        _ref3 = _context3.sent;\n\t                        me = _ref3.me;\n\t                        form = (0, _html2.default)(\"form.\" + CSS_PREFIX + \"new-form\", (0, _htmlTpl.html)(_templateObject));\n\t\n\t                        form.addEventListener(\"submit\", function (e) {\n\t                            e.preventDefault();\n\t                            var username = form.elements['username'].value;\n\t                            var password = form.elements['password'].value;\n\t                            _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n\t                                var resp, u, authToken;\n\t                                return regeneratorRuntime.wrap(function _callee2$(_context2) {\n\t                                    while (1) {\n\t                                        switch (_context2.prev = _context2.next) {\n\t                                            case 0:\n\t                                                _context2.next = 2;\n\t                                                return api.anonFormPost(\"/v1/session\", \"username=\" + encodeURIComponent(username) + \"&password=\" + encodeURIComponent(password));\n\t\n\t                                            case 2:\n\t                                                resp = _context2.sent;\n\t\n\t                                                if (!resp.err) {\n\t                                                    _context2.next = 6;\n\t                                                    break;\n\t                                                }\n\t\n\t                                                alert(resp.err);\n\t                                                return _context2.abrupt(\"return\");\n\t\n\t                                            case 6:\n\t                                                //noinspection UnnecessaryLocalVariableJS\n\t                                                u = resp.users.username, authToken = resp.authToken;\n\t                                                _context2.next = 9;\n\t                                                return addAccount(u, authToken);\n\t\n\t                                            case 9:\n\t                                                _context2.t0 = lb;\n\t                                                _context2.next = 12;\n\t                                                return genHtml();\n\t\n\t                                            case 12:\n\t                                                _context2.t1 = _context2.sent;\n\t\n\t                                                _context2.t0.showContent.call(_context2.t0, _context2.t1);\n\t\n\t                                            case 14:\n\t                                            case \"end\":\n\t                                                return _context2.stop();\n\t                                        }\n\t                                    }\n\t                                }, _callee2, _this);\n\t                            }))();\n\t                        });\n\t\n\t                        _context3.t0 = _html2.default;\n\t                        _context3.t1 = (0, _htmlTpl.html)(_templateObject2, CSS_PREFIX);\n\t                        _context3.t2 = _html2.default;\n\t                        _context3.t3 = \".\" + CSS_PREFIX + \"accounts\";\n\t                        _context3.next = 12;\n\t                        return readAccList();\n\t\n\t                    case 12:\n\t                        _context3.t4 = function (_ref5) {\n\t                            var username = _ref5.username;\n\t\n\t                            var userPic = (0, _html2.default)(\"img.\" + CSS_PREFIX + \"upic\", { src: _userpics.defaultPic });\n\t                            (0, _userpics.getPic)(username).then(function (pic) {\n\t                                return userPic.src = pic;\n\t                            });\n\t                            var deleter = (0, _html2.default)(\".\" + CSS_PREFIX + \"del\", { title: \"Remove from list\" }, (0, _html2.default)(\"i.fa.fa-times-circle\"));\n\t                            return (0, _html2.default)(\".\" + CSS_PREFIX + \"account\" + (username === me ? \".-current\" : \"\"), { \"data-username\": username }, userPic, username, deleter);\n\t                        };\n\t\n\t                        _context3.t5 = _context3.sent.map(_context3.t4);\n\t                        _context3.t6 = (0, _context3.t2)(_context3.t3, _context3.t5);\n\t                        _context3.t7 = (0, _htmlTpl.html)(_templateObject3, CSS_PREFIX);\n\t                        _context3.t8 = form;\n\t                        return _context3.abrupt(\"return\", (0, _context3.t0)(\"\", _context3.t1, _context3.t6, _context3.t7, _context3.t8));\n\t\n\t                    case 18:\n\t                    case \"end\":\n\t                        return _context3.stop();\n\t                }\n\t            }\n\t        }, _callee3, this);\n\t    }));\n\t\n\t    return function genHtml() {\n\t        return _ref2.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar readAccList = function () {\n\t    var _ref6 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4() {\n\t        var list;\n\t        return regeneratorRuntime.wrap(function _callee4$(_context4) {\n\t            while (1) {\n\t                switch (_context4.prev = _context4.next) {\n\t                    case 0:\n\t                        _context4.next = 2;\n\t                        return ls.get(ACC_LIST_KEY);\n\t\n\t                    case 2:\n\t                        list = _context4.sent;\n\t\n\t                        if (list) {\n\t                            _context4.next = 10;\n\t                            break;\n\t                        }\n\t\n\t                        _context4.next = 6;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 6:\n\t                        _context4.t0 = _context4.sent.me;\n\t                        _context4.t1 = (0, _currentUserId.getCurrentAuth)().authToken;\n\t                        _context4.t2 = {\n\t                            username: _context4.t0,\n\t                            token: _context4.t1\n\t                        };\n\t                        list = [_context4.t2];\n\t\n\t                    case 10:\n\t                        return _context4.abrupt(\"return\", list);\n\t\n\t                    case 11:\n\t                    case \"end\":\n\t                        return _context4.stop();\n\t                }\n\t            }\n\t        }, _callee4, this);\n\t    }));\n\t\n\t    return function readAccList() {\n\t        return _ref6.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar addAccount = function () {\n\t    var _ref7 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(username, token) {\n\t        var list, found;\n\t        return regeneratorRuntime.wrap(function _callee5$(_context5) {\n\t            while (1) {\n\t                switch (_context5.prev = _context5.next) {\n\t                    case 0:\n\t                        _context5.next = 2;\n\t                        return readAccList();\n\t\n\t                    case 2:\n\t                        list = _context5.sent;\n\t                        found = list.find(function (a) {\n\t                            return a.username === username;\n\t                        });\n\t\n\t                        if (found) {\n\t                            found.token = token;\n\t                        } else {\n\t                            list.push({ username: username, token: token });\n\t                        }\n\t                        _context5.next = 7;\n\t                        return ls.set(ACC_LIST_KEY, list);\n\t\n\t                    case 7:\n\t                    case \"end\":\n\t                        return _context5.stop();\n\t                }\n\t            }\n\t        }, _callee5, this);\n\t    }));\n\t\n\t    return function addAccount(_x, _x2) {\n\t        return _ref7.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar accountClicked = function () {\n\t    var _ref10 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee7(el) {\n\t        var currentUsername, username, token;\n\t        return regeneratorRuntime.wrap(function _callee7$(_context7) {\n\t            while (1) {\n\t                switch (_context7.prev = _context7.next) {\n\t                    case 0:\n\t                        _context7.next = 2;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 2:\n\t                        currentUsername = _context7.sent.me;\n\t                        username = el.dataset['username'];\n\t\n\t                        if (!(username === currentUsername)) {\n\t                            _context7.next = 6;\n\t                            break;\n\t                        }\n\t\n\t                        return _context7.abrupt(\"return\");\n\t\n\t                    case 6:\n\t                        token = null;\n\t                        _context7.next = 9;\n\t                        return readAccList();\n\t\n\t                    case 9:\n\t                        _context7.t0 = function (a) {\n\t                            if (a.username === username) {\n\t                                token = a.token;\n\t                                return true;\n\t                            }\n\t                            return false;\n\t                        };\n\t\n\t                        _context7.sent.some(_context7.t0);\n\t\n\t                        if (!token) {\n\t                            _context7.next = 17;\n\t                            break;\n\t                        }\n\t\n\t                        lb.showContent(\"Please wait\\u2026\");\n\t                        // Save the current token of current account\n\t                        _context7.next = 15;\n\t                        return addAccount(currentUsername, (0, _currentUserId.getCurrentAuth)().authToken);\n\t\n\t                    case 15:\n\t\n\t                        // Set the new token\n\t                        localStorage.setItem(_currentUserId.cookieName, token);\n\t                        location.reload();\n\t\n\t                    case 17:\n\t                    case \"end\":\n\t                        return _context7.stop();\n\t                }\n\t            }\n\t        }, _callee7, this);\n\t    }));\n\t\n\t    return function accountClicked(_x3) {\n\t        return _ref10.apply(this, arguments);\n\t    };\n\t}();\n\t\n\tvar _templateObject = _taggedTemplateLiteral([\"\\n            <p>Please enter username and password of your other account:</p>\\n            <p><input class=\\\"form-control\\\" type=\\\"text\\\" name=\\\"username\\\" placeholder=\\\"Username\\\" required></p>\\n            <p><input class=\\\"form-control\\\" type=\\\"password\\\" name=\\\"password\\\" placeholder=\\\"Password\\\" required></p>\\n            <p>\\n                <button type=\\\"submit\\\" class=\\\"btn btn-default\\\">Add</button>\\n            </p>\\n        \"], [\"\\n            <p>Please enter username and password of your other account:</p>\\n            <p><input class=\\\"form-control\\\" type=\\\"text\\\" name=\\\"username\\\" placeholder=\\\"Username\\\" required></p>\\n            <p><input class=\\\"form-control\\\" type=\\\"password\\\" name=\\\"password\\\" placeholder=\\\"Password\\\" required></p>\\n            <p>\\n                <button type=\\\"submit\\\" class=\\\"btn btn-default\\\">Add</button>\\n            </p>\\n        \"]),\n\t    _templateObject2 = _taggedTemplateLiteral([\"\\n            <div class=\\\"\", \"header\\\">Switch account to:</div>\"], [\"\\n            <div class=\\\"\", \"header\\\">Switch account to:</div>\"]),\n\t    _templateObject3 = _taggedTemplateLiteral([\"\\n            <div class=\\\"\", \"add-new\\\"><a><i class=\\\"fa fa-plus\\\"></i> Add new account</a></div>\"], [\"\\n            <div class=\\\"\", \"add-new\\\"><a><i class=\\\"fa fa-plus\\\"></i> Add new account</a></div>\"]);\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _crossLocalStorage = __webpack_require__(29);\n\t\n\tvar _crossLocalStorage2 = _interopRequireDefault(_crossLocalStorage);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tvar _htmlTpl = __webpack_require__(17);\n\t\n\tvar _lightbox = __webpack_require__(26);\n\t\n\tvar _lightbox2 = _interopRequireDefault(_lightbox);\n\t\n\tvar _iAm = __webpack_require__(10);\n\t\n\tvar _iAm2 = _interopRequireDefault(_iAm);\n\t\n\tvar _api = __webpack_require__(11);\n\t\n\tvar api = _interopRequireWildcard(_api);\n\t\n\tvar _userpics = __webpack_require__(12);\n\t\n\tvar _currentUserId = __webpack_require__(9);\n\t\n\tvar _closestParent = __webpack_require__(23);\n\t\n\tvar _closestParent2 = _interopRequireDefault(_closestParent);\n\t\n\tfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"switch-accounts\");\n\t\n\tvar CSS_PREFIX = \"bf2-switch-dlg-\";\n\tvar ACC_LIST_KEY = \"bfAccounts-freefeed.net\";\n\tvar clickHandlers = [{ selector: \".\" + CSS_PREFIX + \"del\", handler: removeAccount }, { selector: \".\" + CSS_PREFIX + \"account\", handler: accountClicked }, { selector: \".\" + CSS_PREFIX + \"add-new\", handler: addAccountClicked }];\n\t\n\tvar ls = null;\n\t\n\t_module.init(function () {\n\t    ls = new _crossLocalStorage2.default();\n\t\n\t    document.body.addEventListener(\"click\", function (e) {\n\t        clickHandlers.some(function (h) {\n\t            var t = (0, _closestParent2.default)(e.target, h.selector, true);\n\t            if (t) {\n\t                e.preventDefault();\n\t                h.handler(t);\n\t                return true;\n\t            }\n\t            return false;\n\t        });\n\t    });\n\t});\n\t\n\t_module.watch(\".logged-in > .avatar, .logged-in > .userpic\", function (node) {\n\t    node.appendChild((0, _html2.default)(\".bf2-switch-acc\", { title: \"Switch account\" }, (0, _html2.default)(\"span.bf2-switch-acc__icon\"))).addEventListener(\"click\", showSwitchDialog);\n\t});\n\t\n\tvar lb = null;\n\t\n\tfunction addAccountClicked(el) {\n\t    el.style.display = \"none\";\n\t    document.body.querySelector(\".\" + CSS_PREFIX + \"new-form\").style.display = \"block\";\n\t}\n\t\n\tfunction removeAccount(el) {\n\t    var _this2 = this;\n\t\n\t    if (!confirm(\"Are you sure?\")) return Promise.resolve();\n\t    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee6() {\n\t        var _ref9, me, username, list;\n\t\n\t        return regeneratorRuntime.wrap(function _callee6$(_context6) {\n\t            while (1) {\n\t                switch (_context6.prev = _context6.next) {\n\t                    case 0:\n\t                        _context6.next = 2;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 2:\n\t                        _ref9 = _context6.sent;\n\t                        me = _ref9.me;\n\t                        username = (0, _closestParent2.default)(el, \".\" + CSS_PREFIX + \"account\").dataset['username'];\n\t\n\t                        if (!(username === me)) {\n\t                            _context6.next = 7;\n\t                            break;\n\t                        }\n\t\n\t                        return _context6.abrupt(\"return\");\n\t\n\t                    case 7:\n\t                        _context6.next = 9;\n\t                        return readAccList();\n\t\n\t                    case 9:\n\t                        _context6.t0 = function (a) {\n\t                            return a.username !== username;\n\t                        };\n\t\n\t                        list = _context6.sent.filter(_context6.t0);\n\t\n\t                        if (!(list.length === 1 && list[0].username === me)) {\n\t                            _context6.next = 16;\n\t                            break;\n\t                        }\n\t\n\t                        _context6.next = 14;\n\t                        return ls.set(ACC_LIST_KEY, null);\n\t\n\t                    case 14:\n\t                        _context6.next = 18;\n\t                        break;\n\t\n\t                    case 16:\n\t                        _context6.next = 18;\n\t                        return ls.set(ACC_LIST_KEY, list);\n\t\n\t                    case 18:\n\t                        _context6.t1 = lb;\n\t                        _context6.next = 21;\n\t                        return genHtml();\n\t\n\t                    case 21:\n\t                        _context6.t2 = _context6.sent;\n\t\n\t                        _context6.t1.showContent.call(_context6.t1, _context6.t2);\n\t\n\t                    case 23:\n\t                    case \"end\":\n\t                        return _context6.stop();\n\t                }\n\t            }\n\t        }, _callee6, _this2);\n\t    }))();\n\t}\n\n/***/ }),\n/* 29 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _messageRpc = __webpack_require__(21);\n\t\n\tvar _messageRpc2 = _interopRequireDefault(_messageRpc);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar frameSrc = \"https://davidmz.github.io/BetterFeed2/storage.html?_=\" + Math.random();\n\tvar frameOrigin = \"https://davidmz.github.io\";\n\t\n\tvar _class = function () {\n\t    function _class() {\n\t        _classCallCheck(this, _class);\n\t\n\t        this.iframe = document.createElement(\"iframe\");\n\t        this.iframe.src = frameSrc;\n\t        this.iframe.style.cssText = \"visibility: hidden;\\n            position: absolute;\\n            left: 0; top: 0;\\n            height:0; width:0;\\n            border: none;\";\n\t        // this.iframe.addEventListener(\"load\", e => console.log(e));\n\t        document.body.appendChild(this.iframe);\n\t        this.msg = new _messageRpc2.default(this.iframe.contentWindow, frameOrigin);\n\t    }\n\t\n\t    _createClass(_class, [{\n\t        key: \"get\",\n\t        value: function get(key) {\n\t            return this.msg.send(\"get\", key);\n\t        }\n\t    }, {\n\t        key: \"set\",\n\t        value: function set(key, value) {\n\t            return this.msg.send(\"set\", { key: key, value: value });\n\t        }\n\t    }]);\n\n\t    return _class;\n\t}();\n\n\texports.default = _class;\n\n/***/ }),\n/* 30 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _module = (0, _modules.registerModule)(\"no-read-more\", false);\n\t\n\t_module.watch(\"a.read-more\", function (a) {\n\t  return a.click();\n\t});\n\t\n\t_module.watch(\".expand-button > i\", function (a) {\n\t  return a.click();\n\t});\n\n/***/ }),\n/* 31 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tvar _userpics = __webpack_require__(12);\n\t\n\tvar _iAm = __webpack_require__(10);\n\t\n\tvar _iAm2 = _interopRequireDefault(_iAm);\n\t\n\t__webpack_require__(32);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { return Promise.resolve(value).then(function (value) { step(\"next\", value); }, function (err) { step(\"throw\", err); }); } } return step(\"next\"); }); }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"comment-clouds\");\n\t\n\tvar usersWithAvatars = new Map();\n\tvar withAvatars = false;\n\tvar style = null;\n\t\n\t_module.init(function (settings) {\n\t    style = document.head.appendChild((0, _html2.default)(\"style.bf2-comments-avatars\")).sheet;\n\t    withAvatars = settings.commentCloudsMode === 2;\n\t    if (withAvatars) {\n\t        document.body.classList.add(\"bf2-comments-with-avatars\");\n\t    }\n\t});\n\t\n\t_module.watch(\".comment[data-author]\", function () {\n\t    var _ref = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(node) {\n\t        var author, pic;\n\t        return regeneratorRuntime.wrap(function _callee$(_context) {\n\t            while (1) {\n\t                switch (_context.prev = _context.next) {\n\t                    case 0:\n\t                        if (!(node.querySelector(\".bf2-comment-ex\") || node.classList.contains(\"is-hidden\"))) {\n\t                            _context.next = 2;\n\t                            break;\n\t                        }\n\t\n\t                        return _context.abrupt(\"return\");\n\t\n\t                    case 2:\n\t                        if (!withAvatars) {\n\t                            _context.next = 20;\n\t                            break;\n\t                        }\n\t\n\t                        author = node.dataset[\"author\"];\n\t\n\t                        node.appendChild((0, _html2.default)(\".bf2-comment-avatar.bf2-comment-ex\"));\n\t\n\t                        if (usersWithAvatars.has(author)) {\n\t                            _context.next = 18;\n\t                            break;\n\t                        }\n\t\n\t                        usersWithAvatars.set(author, true);\n\t                        _context.t0 = _userpics.getPic;\n\t                        _context.t1 = author;\n\t\n\t                        if (_context.t1) {\n\t                            _context.next = 13;\n\t                            break;\n\t                        }\n\t\n\t                        _context.next = 12;\n\t                        return _iAm2.default.ready;\n\t\n\t                    case 12:\n\t                        _context.t1 = _context.sent.me;\n\t\n\t                    case 13:\n\t                        _context.t2 = _context.t1;\n\t                        _context.next = 16;\n\t                        return (0, _context.t0)(_context.t2);\n\t\n\t                    case 16:\n\t                        pic = _context.sent;\n\t\n\t                        style.insertRule(\".comment[data-author=\\\"\" + author + \"\\\"] .bf2-comment-avatar { background-image: url(\" + pic + \"); }\", 0);\n\t\n\t                    case 18:\n\t                        _context.next = 21;\n\t                        break;\n\t\n\t                    case 20:\n\t                        node.appendChild((0, _html2.default)(\"i.fa.fa-comment.icon.bf2-ico-bg.bf2-comment-ex\"));\n\t\n\t                    case 21:\n\t                    case \"end\":\n\t                        return _context.stop();\n\t                }\n\t            }\n\t        }, _callee, undefined);\n\t    }));\n\t\n\t    return function (_x) {\n\t        return _ref.apply(this, arguments);\n\t    };\n\t}());\n\n/***/ }),\n/* 32 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t// style-loader: Adds some css to the DOM by adding a <style> tag\n\t\n\t// load the styles\n\tvar content = __webpack_require__(33);\n\tif(typeof content === 'string') content = [[module.id, content, '']];\n\t// add the styles to the DOM\n\tvar update = __webpack_require__(5)(content, {});\n\tif(content.locals) module.exports = content.locals;\n\t// Hot Module Replacement\n\tif(false) {\n\t\t// When the styles change, update the <style> tags\n\t\tif(!content.locals) {\n\t\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\", function() {\n\t\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\");\n\t\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\t\tupdate(newContent);\n\t\t\t});\n\t\t}\n\t\t// When the module is disposed, remove the <style> tags\n\t\tmodule.hot.dispose(function() { update(); });\n\t}\n\n/***/ }),\n/* 33 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\texports = module.exports = __webpack_require__(3)();\n\t// imports\n\t\n\t\n\t// module\n\texports.push([module.id, \".comment .comment-icon:not(.fa-stack){position:relative;top:-2px;left:-1px;z-index:1}.comment-likes .comment-likes-list{z-index:2}.bf2-ico-bg{position:absolute;top:0;left:0;color:#fff;display:none}.comment[data-comm-props~=from] .bf2-ico-bg{display:block}.comment[data-comm-props~=from-reader] .bf2-ico-bg{color:#ededed}.comment[data-comm-props~=from-friend] .bf2-ico-bg{color:#cef4fc}.comment[data-comm-props~=from-post-author] .bf2-ico-bg{color:#b5b5b5}.comment[data-comm-props~=from-me] .bf2-ico-bg{color:#ffd061}.comment.omit-bubble .bf2-ico-bg{display:none}.bf2-comment-avatar{position:absolute;width:16px;height:16px;background-size:cover;top:0;left:-4px;z-index:1;background-color:#fff;border-radius:50%;border:1px solid #ccc;box-sizing:content-box;pointer-events:none}.comment.omit-bubble .bf2-comment-avatar{display:none}.bf2-gamma-frontend .highlighted .bf2-comment-avatar{top:4px;left:3px}.bf2-comments-with-avatars .comment-time{margin-right:5px}.bf2-comments-with-avatars .feed-comment-dot:after{margin-top:1px}.bf2-comments-with-avatars .comment{margin-top:10px}.bf2-comments-with-avatars .bf2-likecomm-shift{left:-9px}.bf2-comments-with-avatars .likes{position:relative;left:-2px}.bf2-comments-with-avatars .likes .icon{margin-right:7px}.bf2-comments-with-avatars .fold-comments-sticky{z-index:2}.bf2-comments-with-avatars .fold-comments-sticky i{left:-2px}.bf2-gamma-frontend.bf2-comments-with-avatars .comment.highlighted{margin-top:6px}\", \"\"]);\n\t\n\t// exports\n\n\n/***/ }),\n/* 34 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _html = __webpack_require__(15);\n\t\n\tvar _html2 = _interopRequireDefault(_html);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"hide-arabic\", false);\n\t\n\tvar style = null;\n\t\n\t_module.init(function () {\n\t    style = document.head.appendChild((0, _html2.default)(\"style.bf2-hide-posts\")).sheet;\n\t    style.insertRule(\".bf2-aggregate-page .bf2-lang-arabic { display: none; }\", 0);\n\t});\n\n/***/ }),\n/* 35 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _textWalk = __webpack_require__(36);\n\t\n\tvar _textWalk2 = _interopRequireDefault(_textWalk);\n\t\n\tvar _escapeHtml = __webpack_require__(18);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tvar _matches = __webpack_require__(8);\n\t\n\tvar _matches2 = _interopRequireDefault(_matches);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tvar _module = (0, _modules.registerModule)(\"hanging-punct\");\n\t\n\tvar helper = void 0;\n\t\n\t_module.init(function () {\n\t    helper = document.createElement(\"div\");\n\t});\n\t\n\tvar re = /(^|\\s)([(«“-]|&quot;)/g;\n\t\n\t_module.watch(\".post-text, .comment-body\", function (node) {\n\t    if ((0, _matches2.default)(node, \".comment-body\")) {\n\t        var userNames = node.querySelectorAll(\".user-name-wrapper\");\n\t        var lastUserName = userNames[userNames.length - 1];\n\t        if (lastUserName && lastUserName.nextElementSibling) {\n\t            var actions = lastUserName.nextElementSibling;\n\t            (0, _textWalk2.default)(actions, function (node) {\n\t                if (node.nodeValue === \"(\") {\n\t                    node.nodeValue = \" (\";\n\t                }\n\t            });\n\t        }\n\t    }\n\t    (0, _textWalk2.default)(node, function (node) {\n\t        if (node.parentNode.classList.contains(\"bf2-hp\")) {\n\t            return;\n\t        }\n\t        var html = (0, _escapeHtml2.default)(node.nodeValue);\n\t        if (!re.test(html)) {\n\t            return;\n\t        }\n\t        html = html.replace(re, '<span class=\"bf2-hp bf2-hp-pre bf2-hp-pre-$2\">$1</span><span class=\"bf2-hp bf2-hp-$2\">$2</span>');\n\t        helper.innerHTML = html;\n\t        while (helper.firstChild) {\n\t            node.parentNode.insertBefore(helper.firstChild, node);\n\t        }\n\t        node.parentNode.removeChild(node);\n\t    });\n\t});\n\n/***/ }),\n/* 36 */\n/***/ (function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.default = textWalk;\n\t/**\r\n\t *\r\n\t * @param {Node} node\r\n\t * @param {function} foo\r\n\t */\n\tfunction textWalk(node, foo) {\n\t    if (node.nodeType === Node.TEXT_NODE) {\n\t        foo(node);\n\t    } else if (node.nodeType === Node.ELEMENT_NODE) {\n\t        var c = node.firstChild;\n\t        while (c) {\n\t            var next = c.nextSibling;\n\t            textWalk(c, foo);\n\t            c = next;\n\t        }\n\t    }\n\t}\n\n/***/ }),\n/* 37 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _module = (0, _modules.registerModule)(\"show-timestamps\", false);\n\t\n\t_module.watch(\".post-lock-icon\", function (t) {\n\t    var event = document.createEvent(\"MouseEvents\");\n\t    event.initEvent(\"click\", true, true);\n\t    t.dispatchEvent(event);\n\t});\n\n/***/ }),\n/* 38 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _modules = __webpack_require__(6);\n\t\n\tvar _module = (0, _modules.registerModule)(\"no-comment-more\", false);\n\t\n\t_module.watch(\".comment-tail__actions\", function (it) {\n\t    var actions = it.querySelectorAll(\".comment-tail__action\");\n\t    if (actions.length === 1) {\n\t        it.hidden = true;\n\t    } else {\n\t        actions[actions.length - 1].hidden = true;\n\t    }\n\t});\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// better-feed.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 7d12139c3da36803f11c","import \"../styles/common.less\";\r\nimport {startObserver} from \"./base/modules\";\r\nimport {getCurrentAuth} from \"./utils/current-user-id\";\r\nimport IAm from \"./utils/i-am\";\r\nimport docLoaded from \"./utils/doc-loaded\";\r\nimport Settings from \"./base/settings\";\r\nimport Messenger from \"./utils/message-rpc\";\r\n\r\nimport \"./modules/common\";\r\nimport \"./modules/settings-link\";\r\n\r\n// import \"./modules/ani-gifs\";\r\nimport \"./modules/moon\";\r\nimport \"./modules/switch-accounts\";\r\nimport \"./modules/no-read-more\";\r\nimport \"./modules/comment-clouds\";\r\nimport \"./modules/hide-arabic\";\r\nimport \"./modules/hanging-punct\";\r\nimport \"./modules/show-timestamps\";\r\nimport \"./modules/no-comment-more\";\r\n\r\nconst {userId} = getCurrentAuth();\r\n\r\nif (!/^\\/(attachments\\/|files\\/|bookmarklet|v\\d\\/)/.test(location.pathname)) {\r\n    if (!MutationObserver || !Promise) {\r\n        console.error(\"Can not start BetterFeed: MutationObserver & Promise not supported\");\r\n    } else if (userId === null) {\r\n        console.error(\"Can not start BetterFeed: user not logged in\");\r\n    } else if (\"__BetterFeed\" in window) {\r\n        console.warn(\"BetterFeed already started\");\r\n    } else {\r\n        window.__BetterFeed = true;\r\n        Promise.all([IAm.ready, docLoaded]).then(([iAm]) => {\r\n            start(new Settings(iAm.bf2Props));\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * @param {Settings} settings\r\n */\r\nfunction start(settings) {\r\n    startObserver(settings);\r\n\r\n    const msg = new Messenger();\r\n\r\n    msg.on(\"getSettings\", () => settings.toJSON());\r\n\r\n    msg.on(\"saveSettings\", async (o) => {\r\n        const iAm = await IAm.ready;\r\n        await iAm.saveProps(new Settings(o));\r\n        location.reload(true);\r\n    });\r\n\r\n    msg.on(\"checkUpdates\", checkUpdates);\r\n}\r\n\r\nfunction checkUpdates() {\r\n    const now = Date.now();\r\n    const oldVersion = process.env.BF2_VERSION;\r\n    localStorage[\"bf2-next-update\"] = now + 3600 * 1000;\r\n    const xhr = new XMLHttpRequest();\r\n    xhr.open('GET', 'https://api.github.com/repos/davidmz/BetterFeed2/tags?page=1&per_page=1');\r\n    xhr.responseType = \"json\";\r\n    xhr.onload = () => {\r\n        try {\r\n            const tags = xhr.response;\r\n            if (tags.length === 1 && \"name\" in tags[0]) {\r\n                const newVersion = tags[0][\"name\"];\r\n                localStorage[\"bf2-version\"] = newVersion;\r\n                localStorage[\"bf2-next-update\"] = now + 24 * 3600 * 1000;\r\n                if (newVersion !== oldVersion) {\r\n                    if (confirm(`Доступна новая версия: ${newVersion}. Она будет установлена после перезагрузки страницы.\\n\\nПерезагрузить страницу сейчас?`)) {\r\n                        location.reload(true);\r\n                    }\r\n                } else {\r\n                    alert(`У вас установлена последняя версия (${newVersion})`);\r\n                }\r\n            }\r\n        } catch (e) {\r\n        }\r\n    };\r\n    xhr.send();\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/better-feed.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\", function() {\n\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./common.less\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles/common.less\n// module id = 1\n// module chunks = 0","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".bf2-lightbox-container{left:0;top:0;width:100%;height:100%;position:fixed;z-index:10}.bf2-lightbox-shadow{left:0;top:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.5)}.bf2-lightbox-content{position:relative;border:1px solid #000;background-color:#ccc;box-shadow:0 0 50px rgba(0,0,0,.5)}.bf2-settings-lightbox .bf2-lightbox-content{width:90vw;height:90vh;max-width:800px}.bf2-settings-lightbox .bf2-lightbox-content iframe{left:0;top:0;width:100%;height:100%}.bf2-access-token-lightbox .bf2-lightbox-content{background-color:#fff;max-width:90vw;padding:2em}.bf2-access-token-lightbox .bf2-lightbox-content button{padding:.25em 2em;cursor:pointer}.bf2-access-token-lightbox .bf2-lightbox-content .bf2-access-token{word-wrap:break-word;font-family:monospace;color:#069;background-color:#eee;padding:1em}.bf2-green{padding:1em}.bf2-via-names{font-size:12px}.bf2-hide-aliens-cont{font-size:14px;font-weight:400;margin-left:1em;display:none}.bf2-homepage .bf2-hide-aliens-cont{display:inline}.bf2-hide-aliens .bf2-alien-post{display:none}.bf2-saving-settings-indicator{position:fixed;top:.66em;right:1em;background:#f66;color:#fff;padding:.25em 1em;border-radius:4px;z-index:100}.bf2-animated-gif{position:relative;display:inline-block}.bf2-animated-gif:after{content:\\\"\\\\25B6   GIF\\\";position:absolute;bottom:3px;right:4px;background-color:#069;color:#eee;font-weight:700;padding:.1em .4em;border-radius:3px;font-size:11px;line-height:normal}.arrow-span{padding:0 .2em}.bf2-moon{width:18px;height:18px;margin-left:4px;margin-bottom:10px}.bf2-moon-shadow{fill:#666}.bf2-moon-light{fill:#f5eed9}.bf2-moon-cont{display:inline-block}.bf2-switch-acc{color:#ccc;cursor:pointer;text-align:center}.bf2-switch-acc:hover{background-color:#eee;color:#000}.bf2-switch-acc__icon{display:inline-block;background:url(\" + require(\"./fa-exchange.svg\") + \") no-repeat;background-size:contain;width:14px;height:14px;opacity:.4}.bf2-switch-account-box .bf2-lightbox-content{width:360px;height:auto;cursor:auto;border:1px solid #000;box-shadow:1px 1px 10px rgba(0,0,0,.5);background-color:#fff;padding:1em}.bf2-switch-dlg-header{font-size:120%}.bf2-switch-dlg-accounts{margin:1em 0}.bf2-switch-dlg-account{cursor:pointer;font-weight:700;border:1px solid #ddd;margin:.5em 0;position:relative}.bf2-switch-dlg-account.-current,.bf2-switch-dlg-account:hover{background-color:#eee}.bf2-switch-dlg-account.-current{cursor:not-allowed}.bf2-switch-dlg-account.-current .bf2-switch-dlg-del{display:none}.bf2-switch-dlg-upic{width:50px;height:50px;margin-right:1em;border-right:1px solid #ddd}.bf2-switch-dlg-new-form{display:none}.bf2-switch-dlg-del{position:absolute;right:0;top:50%;width:20px;height:20px;line-height:20px;text-align:center;margin-top:-10px}.bf2-switch-dlg-del:hover{color:#c00}.box{clear:both}.bf2-lightboxed-images .image-attachments a{cursor:zoom-in}.bf2-search-highlight{background-color:#ffff80}.bf2-hp-pre:empty{display:none}.bf2-hp-pre-\\\\({margin-right:.13em}.bf2-hp-\\\\({margin-left:-.13em}.bf2-hp-pre-«{margin-right:.2em}.bf2-hp-«{margin-left:-.2em}.bf2-hp-pre-\\\\\\\"{margin-right:.2em}.bf2-hp-\\\\\\\"{margin-left:-.2em}.bf2-hp-pre-“{margin-right:.33em}.bf2-hp-“{margin-left:-.33em}.bf2-hp-pre--{margin-right:.1em}.bf2-hp--{margin-left:-.1em}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./~/less-loader!./src/styles/common.less\n// module id = 2\n// module chunks = 0","/*\r\n\tMIT License http://www.opensource.org/licenses/mit-license.php\r\n\tAuthor Tobias Koppers @sokra\r\n*/\r\n// css base code, injected by the css-loader\r\nmodule.exports = function() {\r\n\tvar list = [];\r\n\r\n\t// return the list of modules as css string\r\n\tlist.toString = function toString() {\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar item = this[i];\r\n\t\t\tif(item[2]) {\r\n\t\t\t\tresult.push(\"@media \" + item[2] + \"{\" + item[1] + \"}\");\r\n\t\t\t} else {\r\n\t\t\t\tresult.push(item[1]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result.join(\"\");\r\n\t};\r\n\r\n\t// import a list of modules into the list\r\n\tlist.i = function(modules, mediaQuery) {\r\n\t\tif(typeof modules === \"string\")\r\n\t\t\tmodules = [[null, modules, \"\"]];\r\n\t\tvar alreadyImportedModules = {};\r\n\t\tfor(var i = 0; i < this.length; i++) {\r\n\t\t\tvar id = this[i][0];\r\n\t\t\tif(typeof id === \"number\")\r\n\t\t\t\talreadyImportedModules[id] = true;\r\n\t\t}\r\n\t\tfor(i = 0; i < modules.length; i++) {\r\n\t\t\tvar item = modules[i];\r\n\t\t\t// skip already imported module\r\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\r\n\t\t\t//  when a module is imported multiple times with different media queries.\r\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\r\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\r\n\t\t\t\tif(mediaQuery && !item[2]) {\r\n\t\t\t\t\titem[2] = mediaQuery;\r\n\t\t\t\t} else if(mediaQuery) {\r\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\r\n\t\t\t\t}\r\n\t\t\t\tlist.push(item);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\treturn list;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader/lib/css-base.js\n// module id = 3\n// module chunks = 0","module.exports = \"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjxzdmcgd2lkdGg9IjE3OTIiIGhlaWdodD0iMTc5MiIgdmlld0JveD0iMCAwIDE3OTIgMTc5MiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCiAgICA8cGF0aCBkPSJNMTc5MiAxMTg0djE5MnEwIDEzLTkuNSAyMi41dC0yMi41IDkuNWgtMTM3NnYxOTJxMCAxMy05LjUgMjIuNXQtMjIuNSA5LjVxLTEyIDAtMjQtMTBsLTMxOS0zMjBxLTktOS05LTIyIDAtMTQgOS0yM2wzMjAtMzIwcTktOSAyMy05IDEzIDAgMjIuNSA5LjV0OS41IDIyLjV2MTkyaDEzNzZxMTMgMCAyMi41IDkuNXQ5LjUgMjIuNXptMC01NDRxMCAxNC05IDIzbC0zMjAgMzIwcS05IDktMjMgOS0xMyAwLTIyLjUtOS41dC05LjUtMjIuNXYtMTkyaC0xMzc2cS0xMyAwLTIyLjUtOS41dC05LjUtMjIuNXYtMTkycTAtMTMgOS41LTIyLjV0MjIuNS05LjVoMTM3NnYtMTkycTAtMTQgOS0yM3QyMy05cTEyIDAgMjQgMTBsMzE5IDMxOXE5IDkgOSAyM3oiLz4NCjwvc3ZnPg==\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles/fa-exchange.svg\n// module id = 4\n// module chunks = 0","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\nvar stylesInDom = {},\n\tmemoize = function(fn) {\n\t\tvar memo;\n\t\treturn function () {\n\t\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\t\treturn memo;\n\t\t};\n\t},\n\tisOldIE = memoize(function() {\n\t\treturn /msie [6-9]\\b/.test(self.navigator.userAgent.toLowerCase());\n\t}),\n\tgetHeadElement = memoize(function () {\n\t\treturn document.head || document.getElementsByTagName(\"head\")[0];\n\t}),\n\tsingletonElement = null,\n\tsingletonCounter = 0,\n\tstyleElementsInsertedAtTop = [];\n\nmodule.exports = function(list, options) {\n\tif(typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif(typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (typeof options.singleton === \"undefined\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the bottom of <head>.\n\tif (typeof options.insertAt === \"undefined\") options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list);\n\taddStylesToDom(styles, options);\n\n\treturn function update(newList) {\n\t\tvar mayRemove = [];\n\t\tfor(var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\t\tfor(var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor(var j = 0; j < domStyle.parts.length; j++)\n\t\t\t\t\tdomStyle.parts[j]();\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n}\n\nfunction addStylesToDom(styles, options) {\n\tfor(var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles(list) {\n\tvar styles = [];\n\tvar newStyles = {};\n\tfor(var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\t\tif(!newStyles[id])\n\t\t\tstyles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse\n\t\t\tnewStyles[id].parts.push(part);\n\t}\n\treturn styles;\n}\n\nfunction insertStyleElement(options, styleElement) {\n\tvar head = getHeadElement();\n\tvar lastStyleElementInsertedAtTop = styleElementsInsertedAtTop[styleElementsInsertedAtTop.length - 1];\n\tif (options.insertAt === \"top\") {\n\t\tif(!lastStyleElementInsertedAtTop) {\n\t\t\thead.insertBefore(styleElement, head.firstChild);\n\t\t} else if(lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\thead.insertBefore(styleElement, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\thead.appendChild(styleElement);\n\t\t}\n\t\tstyleElementsInsertedAtTop.push(styleElement);\n\t} else if (options.insertAt === \"bottom\") {\n\t\thead.appendChild(styleElement);\n\t} else {\n\t\tthrow new Error(\"Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.\");\n\t}\n}\n\nfunction removeStyleElement(styleElement) {\n\tstyleElement.parentNode.removeChild(styleElement);\n\tvar idx = styleElementsInsertedAtTop.indexOf(styleElement);\n\tif(idx >= 0) {\n\t\tstyleElementsInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement(options) {\n\tvar styleElement = document.createElement(\"style\");\n\tstyleElement.type = \"text/css\";\n\tinsertStyleElement(options, styleElement);\n\treturn styleElement;\n}\n\nfunction createLinkElement(options) {\n\tvar linkElement = document.createElement(\"link\");\n\tlinkElement.rel = \"stylesheet\";\n\tinsertStyleElement(options, linkElement);\n\treturn linkElement;\n}\n\nfunction addStyle(obj, options) {\n\tvar styleElement, update, remove;\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\t\tstyleElement = singletonElement || (singletonElement = createStyleElement(options));\n\t\tupdate = applyToSingletonTag.bind(null, styleElement, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, styleElement, styleIndex, true);\n\t} else if(obj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\") {\n\t\tstyleElement = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, styleElement);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t\tif(styleElement.href)\n\t\t\t\tURL.revokeObjectURL(styleElement.href);\n\t\t};\n\t} else {\n\t\tstyleElement = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, styleElement);\n\t\tremove = function() {\n\t\t\tremoveStyleElement(styleElement);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle(newObj) {\n\t\tif(newObj) {\n\t\t\tif(newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap)\n\t\t\t\treturn;\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag(styleElement, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = styleElement.childNodes;\n\t\tif (childNodes[index]) styleElement.removeChild(childNodes[index]);\n\t\tif (childNodes.length) {\n\t\t\tstyleElement.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyleElement.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag(styleElement, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyleElement.setAttribute(\"media\", media)\n\t}\n\n\tif(styleElement.styleSheet) {\n\t\tstyleElement.styleSheet.cssText = css;\n\t} else {\n\t\twhile(styleElement.firstChild) {\n\t\t\tstyleElement.removeChild(styleElement.firstChild);\n\t\t}\n\t\tstyleElement.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink(linkElement, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\tif(sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = linkElement.href;\n\n\tlinkElement.href = URL.createObjectURL(blob);\n\n\tif(oldSrc)\n\t\tURL.revokeObjectURL(oldSrc);\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/style-loader/addStyles.js\n// module id = 5\n// module chunks = 0","import forSelect from \"../utils/for-select\";\r\n\r\nexport const registeredModules = new Map(); // name → module\r\n\r\nclass Module {\r\n    constructor(name, enabledByDefault = true, alwaysEnabled = false) {\r\n        this.name = name;\r\n        this.alwaysEnabled = alwaysEnabled;\r\n        this.enabledByDefault = enabledByDefault;\r\n        this.requiredModules = [];\r\n        /**\r\n         * Флаг, позволяющий отключить активность модуля, даже если он разрешён в настройках.\r\n         * Например, если фронтенд или браузер не поддерживает необходимые фичи.\r\n         * @type {boolean}\r\n         */\r\n        this.active = true;\r\n        this._watchers = [];\r\n        this._initiators = [];\r\n    }\r\n\r\n    init(callback) {\r\n        this._initiators.push(callback);\r\n    }\r\n\r\n    watch(selector, callback) {\r\n        this._watchers.push({selector, callback});\r\n    }\r\n\r\n    required(name) {\r\n        this.requiredModules.push(name);\r\n    }\r\n\r\n    _initiate(settings) {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n        this._initiators.forEach(c => c(settings));\r\n        this._watchers.forEach(({selector, callback}) => forSelect(document.body, selector, n => callback(n, settings)));\r\n    }\r\n\r\n    _trigger(node) {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n        this._watchers.forEach(({selector, callback}) => forSelect(node, selector, n => callback(n, settings)));\r\n    }\r\n}\r\n\r\nexport function registerModule(name, enabledByDefault = true, alwaysEnabled = false) {\r\n    const m = new Module(name, enabledByDefault, alwaysEnabled);\r\n    registeredModules.set(name, m);\r\n    return m;\r\n}\r\n\r\nlet settings = null;\r\n/**\r\n *\r\n * @param {Settings} aSettings\r\n */\r\nexport function startObserver(aSettings) {\r\n    if (settings) {\r\n        return;\r\n    }\r\n    settings = aSettings;\r\n\r\n    registeredModules.forEach(m => {\r\n        if (settings.isModuleEnabled(m)) {\r\n            m._initiate(settings);\r\n        }\r\n    });\r\n\r\n    let observer = new MutationObserver(mutations => {\r\n        mutations.forEach(mutation => {\r\n            for (let i = 0, l = mutation.addedNodes.length; i < l; i++) {\r\n                let node = mutation.addedNodes[i];\r\n                if (node.nodeType == Node.ELEMENT_NODE) {\r\n                    registeredModules.forEach(m => {\r\n                        if (settings.isModuleEnabled(m)) {\r\n                            m._trigger(node, settings);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    observer.observe(document.body, {childList: true, subtree: true});\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/base/modules.js","import matches from \"./matches\";\r\n\r\n/**\r\n * @param {Document|DocumentFragment|Element} node\r\n * @param {string} selector\r\n * @param {function(Node)} [foo]\r\n */\r\nexport default (node, selector, foo) => {\r\n    if (node === null) return [];\r\n    var nodeList = node.querySelectorAll(selector);\r\n    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\r\n    if (matches(node, selector)) nodes.unshift(node);\r\n    if (foo) {\r\n        for (var i = 0, l = nodes.length; i < l; i++) {\r\n            foo(nodes[i]);\r\n        }\r\n    }\r\n    return nodes;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/for-select.js","const matchesMethod = (\"matches\" in HTMLElement.prototype) ? \"matches\" : \"msMatchesSelector\";\r\n\r\n/**\r\n *\r\n * @param {HTMLElement} node\r\n * @param {String} selector\r\n * @return {Boolean}\r\n */\r\nexport default function (node, selector) { return node[matchesMethod](selector); }\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/matches.js","const sitesProps = {\r\n    \"freefeed.net\":       {\r\n        cookies: [\"freefeedBETA_authToken\", \"freefeed_authToken\"]\r\n    },\r\n    \"gamma.freefeed.net\": {\r\n        cookies: [\"freefeed_authToken\"]\r\n    }\r\n};\r\n\r\nexport const siteDomain = location.hostname;\r\nexport const cookieName = \"freefeedBETA_authToken\";\r\n\r\nexport function getCurrentAuth() {\r\n    if (siteDomain in sitesProps) {\r\n        for (const cName of sitesProps[siteDomain].cookies) {\r\n            const {userId, authToken} = extractFromJWT(localStorage.getItem(cName));\r\n            if (userId) {\r\n                return {userId, authToken};\r\n            }\r\n        }\r\n    }\r\n    return {userId: null, authToken: null};\r\n}\r\n\r\nfunction extractFromJWT(jwtString) {\r\n    if (jwtString !== null) {\r\n        const parts = jwtString.split(\".\");\r\n        if (parts.length === 3) {\r\n            try {\r\n                let payload = JSON.parse(atob(parts[1]));\r\n                if (\"userId\" in payload) {\r\n                    return {authToken: jwtString, userId: payload[\"userId\"]};\r\n                }\r\n            } catch (e) {\r\n            }\r\n        }\r\n    }\r\n    return {authToken: null, userId: null};\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/current-user-id.js","import * as api from './api';\r\nimport * as uPics from './userpics';\r\nimport h from \"./html\";\r\n\r\nconst prefsName = \"me.davidmz.BetterFeed2\";\r\n\r\nexport default class IAm {\r\n    constructor() {\r\n        this.me = null;\r\n        this.myID = null;\r\n        this.myScreenName = null;\r\n        this.friends = [];\r\n        this.readers = [];\r\n        this.banIds = [];\r\n        this.bf2Props = {};\r\n\r\n        this._savePropsQueue = [];\r\n        this._savingPropsNow = false;\r\n        this._savingIndicator = h(\".bf2-saving-settings-indicator\", \"Saving settings…\");\r\n    }\r\n\r\n    whoIs(username) {\r\n        let flags = 0;\r\n        if (username === this.me) flags |= IAm.ME;\r\n        if (this.friends.indexOf(username) !== -1) flags |= IAm.FRIEND;\r\n        if (this.readers.indexOf(username) !== -1) flags |= IAm.READER;\r\n        return flags;\r\n    }\r\n\r\n    isBanned(userId) {\r\n        return (this.banIds.indexOf(userId) !== -1);\r\n    }\r\n\r\n    /**\r\n     * @param {Settings} s\r\n     */\r\n    saveProps(s) {\r\n        this._savePropsQueue.push(s.toJSON());\r\n        return this._saveProps();\r\n    }\r\n\r\n    /**\r\n     * Последовательное сохранение настроек по очереди\r\n     * @private\r\n     */\r\n    async _saveProps() {\r\n        if (this._savingPropsNow) return;\r\n\r\n        document.body.appendChild(this._savingIndicator);\r\n        this._savingPropsNow = true;\r\n        while (this._savePropsQueue.length > 0) {\r\n            const json = this._savePropsQueue.shift(), nulls = {};\r\n            for (let k in json) if (json.hasOwnProperty(k)) nulls[k] = null;\r\n            await api.put(`/v1/users/${this.myID}`, JSON.stringify({user: {frontendPreferences: {[prefsName]: json}}}));\r\n        }\r\n        this._savingPropsNow = false;\r\n        document.body.removeChild(this._savingIndicator);\r\n    }\r\n}\r\n\r\n\r\nIAm.ME = 1 << 0;\r\nIAm.FRIEND = 1 << 1;\r\nIAm.READER = 1 << 2;\r\n\r\nIAm.ready = null;\r\n\r\nIAm.update = () => {\r\n    IAm.ready = api.get('/v2/users/whoami').then(resp => {\r\n        const iAm = new IAm();\r\n        iAm.me = resp.users.username;\r\n        iAm.myID = resp.users.id;\r\n        iAm.myScreenName = resp.users.screenName;\r\n        uPics.setPic(resp.users.username, resp.users.profilePictureMediumUrl);\r\n        iAm.friends = resp.subscribers.map(it => {\r\n            uPics.setPic(it.username, it.profilePictureMediumUrl);\r\n            return it.username;\r\n        });\r\n        iAm.readers = resp.users.subscribers.map(it => {\r\n            uPics.setPic(it.username, it.profilePictureMediumUrl);\r\n            return it.username;\r\n        });\r\n        iAm.banIds = resp.users.banIds;\r\n        iAm.bf2Props = (resp.users.frontendPreferences[prefsName] || {});\r\n\r\n        return iAm;\r\n    });\r\n};\r\n\r\nIAm.update();\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/i-am.js","import {getCurrentAuth} from './current-user-id';\r\n\r\nconst apiRoot = \"https://freefeed.net\";\r\n\r\nexport function get(path) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('GET', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('Authorization', 'Bearer ' + getCurrentAuth().authToken);\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send();\r\n    });\r\n}\r\n\r\nexport function put(path, body) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('PUT', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('Authorization', 'Bearer ' + getCurrentAuth().authToken);\r\n        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    });\r\n}\r\n\r\nexport function del(path, body) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('DELETE', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('Authorization', 'Bearer ' + getCurrentAuth().authToken);\r\n        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    });\r\n}\r\n\r\nexport function post(path, body) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('POST', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('Authorization', 'Bearer ' + getCurrentAuth().authToken);\r\n        xhr.setRequestHeader('Content-Type', 'application/json; charset=UTF-8');\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    });\r\n}\r\n\r\nexport function anonFormPost(path, body) {\r\n    return new Promise(function (resolve, reject) {\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.open('POST', apiURL(path));\r\n        xhr.responseType = 'json';\r\n        xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded; charset=UTF-8');\r\n        xhr.onload = function () {\r\n            if (xhr.response && \"err\" in xhr.response) {\r\n                reject(xhr.response.err);\r\n            } else {\r\n                resolve(xhr.response);\r\n            }\r\n        };\r\n        xhr.send(body);\r\n    });\r\n}\r\n\r\nfunction apiURL(path) {\r\n    return apiRoot + path + ((path.indexOf(\"?\") !== -1) ? \"&\" : \"?\") + \"_initiator=betterfeed2\";\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/api.js","import bfRoot from \"../utils/bf-root\";\r\nimport \"file?name=[name].[ext]!../../styles/default-userpic-50.png\";\r\n\r\nexport const defaultPic = `${bfRoot}/build/default-userpic-50.png`;\r\nconst picRegistry = new Map;\r\n\r\nasync function picLoad(username) {\r\n    const resp = await (await fetch(`https://davidmz.me/frfrfr/uinfo/upic?username=${username}`)).json();\r\n    return (resp.status === \"ok\" && resp.data !== \"\") ? resp.data : defaultPic;\r\n}\r\n\r\nexport function getPic(username) {\r\n    if (!picRegistry.has(username)) {\r\n        picRegistry.set(username, picLoad(username));\r\n    }\r\n    return picRegistry.get(username);\r\n}\r\n\r\nexport function setPic(username, pic) {\r\n    picRegistry.set(username, Promise.resolve((pic && pic !== \"\") ? pic : defaultPic));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/userpics.js","let myRoot = window.__BetterFeedRoot || \"https://cdn.jsdelivr.net/gh/davidmz/BetterFeed2@\" + localStorage['bf2-version'];\r\nif (document.currentScript) {\r\n    let pr = document.currentScript.src.split(\"/\");\r\n    myRoot = pr.slice(0, pr.length - 2).join(\"/\");\r\n}\r\n\r\nexport default myRoot;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/bf-root.js","module.exports = __webpack_public_path__ + \"default-userpic-50.png\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/file-loader?name=[name].[ext]!./src/styles/default-userpic-50.png\n// module id = 14\n// module chunks = 0","import isArray from \"./is-array\";\r\nimport { isSafeHTML } from \"./html-tpl\";\r\n\r\n/**\r\n * h(\"tag.class\", {attr: val}, child)\r\n * h(\"tag.class\", child)\r\n * h(\"tag.class\", {attr: val})\r\n * h(\"tag.class\")\r\n * h(\".class\") // div\r\n * h(\"$\") // document fragment\r\n *\r\n * Класс, заданный через атрибуты, перекрывает классы из строки тегов\r\n *\r\n * @param {String} tagName - tag или tag.class1.class2 (поддерживаются только классы)\r\n * @param {Object} [attrs]\r\n * @param {Node|string|Array} [children]\r\n * @return {HTMLElement}\r\n */\r\nexport default function h(tagName, attrs, children) {\r\n    var i, k;\r\n    var tagParts = tagName.split(\".\");\r\n    var tn = tagParts.shift() || \"div\";\r\n    var el;\r\n    if (tn === \"$\") {\r\n        el = document.createDocumentFragment();\r\n    } else {\r\n        el = document.createElement(tn);\r\n        if (tagParts.length > 0) {\r\n            el.className = tagParts.join(\" \");\r\n        }\r\n    }\r\n\r\n    var chStart = 1;\r\n    if (arguments.length > 1 && typeof attrs === \"object\" && !(attrs instanceof Node) && !isArray(attrs) && !isSafeHTML(attrs)) {\r\n        for (k in attrs) if (attrs.hasOwnProperty(k)) el.setAttribute(k, attrs[k]);\r\n        chStart = 2;\r\n    }\r\n\r\n    if (arguments.length > chStart) {\r\n        for (i = chStart; i < arguments.length; i++) {\r\n            append(el, arguments[i]);\r\n        }\r\n    }\r\n    return el;\r\n};\r\n\r\nfunction append(el, it) {\r\n    if (it instanceof Node) {\r\n        el.appendChild(it);\r\n    } else if (isArray(it)) {\r\n        it.forEach(append.bind(null, el));\r\n    } else if (typeof it === \"string\") {\r\n        el.appendChild(document.createTextNode(it));\r\n    } else if (isSafeHTML(it)) {\r\n        el.insertAdjacentHTML('beforeEnd', it.toString())\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/html.js","export default Array.isArray || function (arr) {\r\n    return Object.prototype.toString.call(arr) == '[object Array]';\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/is-array.js","import escapeHTML from \"./escape-html\";\r\n\r\nclass SafeHTML {\r\n    constructor(text) { this.text = text; }\r\n\r\n    toString() { return this.text; }\r\n}\r\n\r\nexport function safeHTML(text) { return new SafeHTML(text); }\r\n\r\nexport function isSafeHTML(h) { return (h instanceof SafeHTML); }\r\n\r\nexport function html(tpl, ...args) {\r\n    return safeHTML(tpl.reduce((acc, part, i) => {\r\n        let a = args[i - 1];\r\n        return acc + (isSafeHTML(a) ? a : escapeHTML(a)) + part;\r\n    }));\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/html-tpl.js","/**\r\n * @param {string} s\r\n * @return {string}\r\n */\r\nexport default function (s = \"\") {\r\n    return s.replace(/&/g, \"&amp;\")\r\n        .replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")\r\n        .replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/escape-html.js","export default new Promise(function (resolve) {\r\n    if (document.readyState === 'complete' || document.readyState === 'interactive') {\r\n        setTimeout(resolve, 0);\r\n    } else {\r\n        document.addEventListener(\"DOMContentLoaded\", resolve);\r\n    }\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/doc-loaded.js","import {registeredModules} from \"./modules\";\r\n\r\nexport default class Settings {\r\n\r\n    constructor(o = null, trustedData = false) {\r\n        this.modules = new Map;\r\n        registeredModules.forEach(m => {\r\n            if (!m.alwaysEnabled) {\r\n                this.modules.set(m.name, m.enabledByDefault);\r\n            }\r\n        });\r\n\r\n        this.hideAliens = false;\r\n        this.commentCloudsMode = 2;\r\n\r\n        // инициализация из объекта\r\n        if (o) {\r\n            (o.modules || []).forEach(([k, v]) => {\r\n                if (trustedData || this.modules.has(k)) {\r\n                    this.modules.set(k, !!v);\r\n                }\r\n            });\r\n            this.hideAliens = !!o.hideAliens;\r\n            if (o.commentCloudsMode === 1 || o.commentCloudsMode === 2) {\r\n                this.commentCloudsMode = o.commentCloudsMode;\r\n            }\r\n        }\r\n    }\r\n\r\n     toJSON() {\r\n        const o = {modules: []};\r\n        this.modules.forEach((v, k) => o.modules.push([k, v]));\r\n        o.hideAliens = this.hideAliens;\r\n        o.commentCloudsMode = this.commentCloudsMode;\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * @param {Module} m\r\n     * @return {boolean}\r\n     */\r\n    isModuleEnabled(m) {\r\n        return (\r\n            m\r\n            && (m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name))\r\n            && !m.requiredModules.map(name => registeredModules.get(name)).some(m => !this.isModuleEnabled(m))\r\n        );\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/base/settings.js","let nextRequestId = 1;\r\n\r\nconst responseAction = \"@response\";\r\n\r\nexport default class Messenger {\r\n\r\n    constructor(parentWindow = null, parentOrigin = \"\") {\r\n        this.__responders = new Map();\r\n        this.__listeners = new Map();\r\n\r\n        this.defaultWindow = parentWindow;\r\n        this.defaultOrigin = parentOrigin;\r\n\r\n        window.addEventListener('message', event => {\r\n            if (typeof event.data !== \"object\") {\r\n                return;\r\n            }\r\n            //noinspection UnnecessaryLocalVariableJS\r\n            const {data:{action, requestId, value}, source, origin} = event;\r\n\r\n            if (action === responseAction && this.__responders.has(requestId)) {\r\n                this.__responders.get(requestId)(value);\r\n                this.__responders.delete(requestId);\r\n\r\n            } else if (this.__listeners.has(action)) {\r\n                let resp = this.__listeners.get(action)(value);\r\n                source.postMessage({action: responseAction, requestId, value: resp}, origin);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} action\r\n     * @param {*} value\r\n     * @return {Promise}\r\n     */\r\n    send(action, value = null) {\r\n        return this.sendEx(this.defaultWindow, this.defaultOrigin, action, value);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {Window} window\r\n     * @param {String} origin\r\n     * @param {String} action\r\n     * @param {*} value\r\n     * @return {Promise}\r\n     */\r\n    sendEx(window, origin, action, value = null) {\r\n        return new Promise(resolve => {\r\n            const requestId = nextRequestId++;\r\n            this.__responders.set(requestId, resolve);\r\n            window.postMessage({action, requestId, value}, origin);\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} action\r\n     * @param {function} callback\r\n     */\r\n    on(action, callback) {\r\n        this.__listeners.set(action, callback);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/message-rpc.js","import {registerModule} from \"./../base/modules\";\r\nimport closestParent from \"../utils/closest-parent\";\r\nimport onHistory from \"../utils/on-history\";\r\nimport forSelect from \"../utils/for-select\";\r\nimport IAm from \"../utils/i-am\";\r\nimport {siteDomain} from \"../utils/current-user-id\";\r\n\r\nconst module = registerModule(\"common\", true, true);\r\n\r\nmodule.init(() => {\r\n    onHistory(location => {\r\n        const isHomePage = (location.pathname === \"/\");\r\n        const isBestOf = (location.pathname === \"/filter/best_of\");\r\n        document.body.classList.toggle(\"bf2-homepage\", isHomePage);\r\n        document.body.classList.toggle(\"bf2-best-of\", isBestOf);\r\n        document.body.classList.toggle(\"bf2-aggregate-page\", isHomePage || isBestOf);\r\n    });\r\n\r\n    document.addEventListener(\"click\", e => {\r\n        if (e.button == 0 && e.target.classList.contains(\"bf2-user-link\")) {\r\n            //noinspection JSUnresolvedVariable\r\n            const reactLink = document.querySelector(`a:not(.bf2-user-link)[href=\"${CSS.escape(e.target.getAttribute(\"href\"))}\"]`);\r\n            if (reactLink) {\r\n                e.preventDefault();\r\n                e.target.blur();\r\n                reactLink.click();\r\n            }\r\n        }\r\n    });\r\n\r\n    if (siteDomain === \"gamma.freefeed.net\") {\r\n        document.body.classList.add(\"bf2-gamma-frontend\");\r\n    }\r\n});\r\n\r\n\r\n// Свойства постов\r\nmodule.watch(\".timeline-post, .single-post\", node => {\r\n    // ID поста\r\n    const postId = node.querySelector(\".post-timestamp\").getAttribute(\"href\").match(/^\\/.+?\\/([\\w-]+)/)[1];\r\n    node.id = `post-${postId}`;\r\n    node.dataset.postId = postId;\r\n\r\n    // Автор поста\r\n    const postAuthor = node.querySelector(\".post-author\").getAttribute(\"href\").substr(1);\r\n    node.dataset.postAuthor = postAuthor;\r\n    node.classList.add(`bf2-post-from-${postAuthor}`);\r\n\r\n    // Адресаты поста\r\n    forSelect(node, \".post-recipient\")\r\n        .map(a => a.getAttribute(\"href\").substr(1))\r\n        .filter(u => u !== postAuthor)\r\n        .forEach(u => node.classList.add(`bf2-post-to-${u}`));\r\n\r\n    // Язык поста\r\n    const postBody = node.querySelector(\".post-text\");\r\n    const firstComment = node.querySelector(\".comment-body\");\r\n    if (isArabic(postBody.textContent) || firstComment && isArabic(firstComment.textContent)) {\r\n        node.classList.add(\"bf2-lang-arabic\");\r\n    }\r\n});\r\n\r\n// User cards\r\nmodule.watch(\".user-card .display-name\", node => {\r\n    closestParent(node, \".user-card\").dataset.userName = node.getAttribute(\"href\").substr(1);\r\n});\r\n\r\n// Свойства комментариев\r\nmodule.watch(\".comment\", async(node) => {\r\n    const commentAuthor = getCommentAuthor(node);\r\n    if (!commentAuthor) {\r\n        // фолд или форма нового коммента\r\n        return;\r\n    }\r\n    const postAuthor = getPostAuthor(closestParent(node, \".post\"));\r\n    if (!postAuthor) {\r\n        return;\r\n    }\r\n\r\n    const commProps = [];\r\n\r\n    commProps.push(\"from\");\r\n\r\n    if (postAuthor === commentAuthor) {\r\n        commProps.push(\"from-post-author\");\r\n    }\r\n\r\n    const type = (await IAm.ready).whoIs(commentAuthor);\r\n    if (type & IAm.ME) {\r\n        commProps.push(\"from-me\");\r\n    } else if (type & IAm.FRIEND) {\r\n        commProps.push(\"from-friend\");\r\n    } else if (type & IAm.READER) {\r\n        commProps.push(\"from-reader\");\r\n    }\r\n\r\n    node.dataset.commProps = commProps.join(\" \");\r\n});\r\n\r\nfunction getCommentAuthor(commentNode) {\r\n    let author = commentNode.dataset[\"author\"];\r\n    if (!author) {\r\n        const authorLink = commentNode.querySelector(\".comment-body > .user-name-wrapper > a\");\r\n        if (authorLink) {\r\n            author = authorLink.getAttribute(\"href\").substr(1);\r\n            commentNode.dataset[\"author\"] = author;\r\n        }\r\n    }\r\n    return author;\r\n}\r\n\r\n\r\nfunction getPostAuthor(postNode) {\r\n    let author = postNode.dataset[\"author\"];\r\n    if (!author) {\r\n        const authorLink = postNode.querySelector(\".post-header a.post-author\");\r\n        if (authorLink) {\r\n            author = authorLink.getAttribute(\"href\").substr(1);\r\n            postNode.dataset[\"author\"] = author;\r\n        }\r\n    }\r\n    return author;\r\n}\r\n\r\n/**\r\n *\r\n * @param {string} text\r\n * @return {boolean}\r\n */\r\nfunction isArabic(text) {\r\n    return /[\\u0600-\\u06ff\\u0700-\\u077f\\u08A0-\\u08ff]/.test(text);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/common.js","import matches from \"./matches\";\r\n\r\nconst native = !!Element.prototype.closest;\r\n\r\n/**\r\n *\r\n * @param {Element|null} element\r\n * @param {string} selector\r\n * @param {boolean} [withSelf]\r\n * @return {Element|null}\r\n */\r\nexport default function closestParent(element, selector, withSelf = false) {\r\n    if (element === null) return null;\r\n    const p = withSelf ? element : element.parentNode;\r\n    if (native && p) return p.closest(selector);\r\n\r\n    if (p && p.nodeType == Node.ELEMENT_NODE) {\r\n        return matches(p, selector) ? p : closestParent(p, selector);\r\n    }\r\n    return null;\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/closest-parent.js","const listeners = [];\r\n\r\nexport default function (callback) {\r\n    listeners.push(callback);\r\n    callback(location);\r\n}\r\n\r\nconst oldPushState = history.pushState.bind(history),\r\n    oldReplaceState = history.replaceState.bind(history);\r\n\r\nhistory.pushState = (state, title, url) => {\r\n    oldPushState(state, title, url);\r\n    listeners.forEach(c => c(location));\r\n};\r\n\r\nhistory.replaceState = (state, title, url) => {\r\n    oldReplaceState(state, title, url);\r\n    listeners.forEach(c => c(location));\r\n};\r\n\r\nwindow.addEventListener(\"popstate\", () => listeners.forEach(c => c(location)));\r\n\r\n\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/on-history.js","import {registerModule} from \"./../base/modules\";\r\nimport h from \"../utils/html\";\r\nimport bfRoot from \"../utils/bf-root\";\r\nimport Lightbox from \"../utils/lightbox\";\r\nimport escapeHTML from \"../utils/escape-html\";\r\n\r\nconst version = process.env.BF2_VERSION;\r\n\r\nconst module = registerModule(\"settings-link\", true, true);\r\n\r\nmodule.watch(\".sidebar\", node => {\r\n    if (node.querySelector(\".bf2-sidebar-box\")) {\r\n        return;\r\n    }\r\n\r\n    const link = h(\"a\", \"BetterFeed settings\");\r\n    const html = h(\".bf2-sidebar-box.box\",\r\n        h(\".box-header-groups\", \"Add-ons\"),\r\n        h(\".box-body\",\r\n            h(\"ul\",\r\n                h(\"li\", link)\r\n            )\r\n        ),\r\n        h(\".box-footer\", version),\r\n    );\r\n\r\n    const someBox = node.querySelector(\".box\");\r\n\r\n    someBox.parentNode.insertBefore(html, null);\r\n\r\n    link.addEventListener(\"click\", showSettings)\r\n});\r\n\r\nasync function showSettings() {\r\n    const url = bfRoot + '/src/html/settings.html';\r\n    const html = (await fetch(url).then(r => r.text()))\r\n        .replace(/\\[\\[parentOrigin]]/g, escapeHTML(location.origin))\r\n        .replace(/\\[\\[betterFeedVersion]]/g, escapeHTML(version))\r\n        .replace(/\\[\\[baseURL]]/g, escapeHTML(bfRoot + '/'));\r\n    const htmlUrl = URL.createObjectURL(new Blob([html], {type: \"text/html;charset=utf-8\"}));\r\n\r\n    if (/iPhone|iPad/.test(navigator.userAgent)) {\r\n        window.open(htmlUrl, \"_blank\");\r\n        return;\r\n    }\r\n\r\n    new Lightbox(\"bf2-settings-lightbox\")\r\n        .showContent(h(\"iframe\", {src: htmlUrl, frameborder: \"0\"}));\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/settings-link.js","import h from \"../utils/html\";\r\n\r\nexport default class Lightbox {\r\n    /**\r\n     * @param {string} className\r\n     * @param {boolean} modal\r\n     */\r\n    constructor(className = \"\", modal = false) {\r\n        this._container = h(\".bf2-lightbox-container\");\r\n        if (className !== \"\") {\r\n            this._container.classList.add(className)\r\n        }\r\n        let shadow = this._container.appendChild(h(\".bf2-lightbox-shadow\"));\r\n        /** @var {HTMLElement} */\r\n        this.contentEl = shadow.appendChild(h(\".bf2-lightbox-content\"));\r\n        shadow.addEventListener(\"click\", e => {\r\n            if (e.target === shadow && !modal) {\r\n                this.hide();\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @param {HTMLElement|string} el\r\n     */\r\n    showContent(el) {\r\n        if (typeof el === \"string\") {\r\n            this.contentEl.innerHTML = el;\r\n        } else {\r\n            this.contentEl.innerHTML = \"\";\r\n            this.contentEl.appendChild(el);\r\n        }\r\n        document.body.appendChild(this._container);\r\n    }\r\n\r\n    hide() {\r\n        this.contentEl.innerHTML = \"\";\r\n        this._container.parentNode.removeChild(this._container);\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/lightbox.js","import {registerModule} from \"./../base/modules\";\r\nimport h from \"../utils/html\";\r\n\r\nconst module = registerModule(\"moon\");\r\n\r\n//noinspection HtmlUnknownAttribute \r\nconst moonXML = `<svg class=\"bf2-moon\" viewBox=\"-4 -4 108 108\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\">\r\n        <circle class=\"bf2-moon-shadow\" cx=\"50\" cy=\"50\" r=\"54\"></circle>\r\n        <path class=\"bf2-moon-light\" d=\"M 50 0 a 30 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z\"></path>\r\n    </svg>`;\r\n\r\nmodule.watch(\"h1\", node => {\r\n    node.appendChild(h(\".bf2-moon-cont\")).innerHTML = moonXML;\r\n    drawMoonPhase(currentMoonPhase());\r\n    setInterval(() => drawMoonPhase(currentMoonPhase()), 1000 * 3600);\r\n});\r\n\r\nconst newMoon = new Date(\"Thu Apr 07 2016 14:22:37 GMT+0300\").getTime(),\r\n    month = Math.round(86400 * 29.53058812 * 1000);\r\n\r\nfunction currentMoonPhase() {\r\n    return (((new Date()).getTime() - newMoon) / month) % 1;\r\n}\r\n\r\n// phase = [0..1], 0 = 1 = новолуние, 0.5 = полнолуние\r\nfunction drawMoonPhase(phase) {\r\n    const moonEl = document.querySelector(\".bf2-moon\");\r\n    if (!moonEl) {\r\n        return;\r\n    }\r\n    const lightEl = moonEl.querySelector(\".bf2-moon-light\");\r\n    const radius = 50;\r\n    const xRadius = radius * Math.abs(Math.cos(2 * Math.PI * phase));\r\n\r\n    let path;\r\n    if (phase < 0.25) {\r\n        path = `M 50 0 a ${xRadius} 50 0 0 1 0 100 a 50 50 0 0 0 0 -100 Z`;\r\n    } else if (phase < 0.5) {\r\n        path = `M 50 0 a ${xRadius} 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z`;\r\n    } else if (phase < 0.75) {\r\n        path = `M 50 0 a 50 50 0 0 0 0 100 a ${xRadius} 50 0 0 0 0 -100 Z`;\r\n    } else {\r\n        path = `M 50 0 a 50 50 0 0 0 0 100 a ${xRadius} 50 0 0 1 0 -100 Z`;\r\n    }\r\n    lightEl.setAttribute(\"d\", path);\r\n\r\n    if (Math.abs(0.5 - phase) < 0.05) {\r\n        moonEl.parentNode.setAttribute(\"title\", \"Achtung Vollmond!\");\r\n    } else {\r\n        moonEl.parentNode.removeAttribute(\"title\");\r\n    }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/moon.js","import {registerModule} from \"../base/modules\";\r\nimport LS from \"../utils/cross-local-storage\";\r\nimport h from \"../utils/html\";\r\nimport {html} from \"../utils/html-tpl\";\r\nimport Lightbox from \"../utils/lightbox\";\r\nimport IAm from \"../utils/i-am\";\r\nimport * as api from \"../utils/api\";\r\nimport {defaultPic, getPic} from '../utils/userpics';\r\nimport {cookieName, getCurrentAuth} from '../utils/current-user-id';\r\nimport closestParent from \"../utils/closest-parent\";\r\n\r\nconst module = registerModule(\"switch-accounts\");\r\n\r\nconst CSS_PREFIX = \"bf2-switch-dlg-\";\r\nconst ACC_LIST_KEY = `bfAccounts-freefeed.net`;\r\nconst clickHandlers = [\r\n    {selector: `.${CSS_PREFIX}del`, handler: removeAccount},\r\n    {selector: `.${CSS_PREFIX}account`, handler: accountClicked},\r\n    {selector: `.${CSS_PREFIX}add-new`, handler: addAccountClicked}\r\n];\r\n\r\n\r\nlet ls = null;\r\n\r\nmodule.init(() => {\r\n    ls = new LS();\r\n\r\n    document.body.addEventListener(\"click\", e => {\r\n        clickHandlers.some(h => {\r\n            let t = closestParent(e.target, h.selector, true);\r\n            if (t) {\r\n                e.preventDefault();\r\n                h.handler(t);\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n    });\r\n});\r\n\r\nmodule.watch(\".logged-in > .avatar, .logged-in > .userpic\", node => {\r\n    node.appendChild(\r\n        h(\".bf2-switch-acc\", {title: \"Switch account\"}, h(\"span.bf2-switch-acc__icon\"))\r\n    ).addEventListener(\"click\", showSwitchDialog);\r\n\r\n});\r\n\r\nlet lb = null;\r\n\r\nasync function showSwitchDialog() {\r\n    lb = new Lightbox(\"bf2-switch-account-box\");\r\n    lb.showContent(`<p>Loading…</p>`);\r\n    lb.showContent(await genHtml());\r\n}\r\n\r\nasync function genHtml() {\r\n    let {me} = await IAm.ready;\r\n\r\n    let form = h(`form.${CSS_PREFIX}new-form`,\r\n        html`\r\n            <p>Please enter username and password of your other account:</p>\r\n            <p><input class=\"form-control\" type=\"text\" name=\"username\" placeholder=\"Username\" required></p>\r\n            <p><input class=\"form-control\" type=\"password\" name=\"password\" placeholder=\"Password\" required></p>\r\n            <p>\r\n                <button type=\"submit\" class=\"btn btn-default\">Add</button>\r\n            </p>\r\n        `\r\n    );\r\n    form.addEventListener(\"submit\", e => {\r\n        e.preventDefault();\r\n        let username = form.elements['username'].value;\r\n        let password = form.elements['password'].value;\r\n        (async () => {\r\n            let resp = await api.anonFormPost(\"/v1/session\", `username=${encodeURIComponent(username)}&password=${encodeURIComponent(password)}`);\r\n            if (resp.err) {\r\n                alert(resp.err);\r\n                return;\r\n            }\r\n            //noinspection UnnecessaryLocalVariableJS\r\n            let {users: {username: u}, authToken} = resp;\r\n            await addAccount(u, authToken);\r\n            lb.showContent(await genHtml());\r\n        })();\r\n    });\r\n\r\n    return h(\"\",\r\n        html`\r\n            <div class=\"${CSS_PREFIX}header\">Switch account to:</div>`,\r\n        h(\r\n            `.${CSS_PREFIX}accounts`,\r\n            (await readAccList()).map(\r\n                ({username}) => {\r\n                    let userPic = h(`img.${CSS_PREFIX}upic`, {src: defaultPic});\r\n                    getPic(username).then(pic => userPic.src = pic);\r\n                    let deleter = h(`.${CSS_PREFIX}del`, {title: \"Remove from list\"}, h(\"i.fa.fa-times-circle\"));\r\n                    return h(`.${CSS_PREFIX}account${(username === me) ? \".-current\" : \"\"}`, {\"data-username\": username}, userPic, username, deleter);\r\n                }\r\n            )\r\n        ),\r\n        html`\r\n            <div class=\"${CSS_PREFIX}add-new\"><a><i class=\"fa fa-plus\"></i> Add new account</a></div>`,\r\n        form\r\n    );\r\n}\r\n\r\nfunction addAccountClicked(el) {\r\n    el.style.display = \"none\";\r\n    document.body.querySelector(`.${CSS_PREFIX}new-form`).style.display = \"block\";\r\n}\r\n\r\nasync function readAccList() {\r\n    let list = await ls.get(ACC_LIST_KEY);\r\n    if (!list) {\r\n        list = [{username: (await IAm.ready).me, token: getCurrentAuth().authToken}];\r\n    }\r\n    return list;\r\n}\r\n\r\nasync function addAccount(username, token) {\r\n    let list = await readAccList();\r\n    const found = list.find(a => a.username === username);\r\n    if (found) {\r\n        found.token = token;\r\n    } else {\r\n        list.push({username, token});\r\n    }\r\n    await ls.set(ACC_LIST_KEY, list);\r\n}\r\n\r\nfunction removeAccount(el) {\r\n    if (!confirm(\"Are you sure?\")) return Promise.resolve();\r\n    return (async () => {\r\n        let {me} = await IAm.ready;\r\n        let username = closestParent(el, `.${CSS_PREFIX}account`).dataset['username'];\r\n        if (username === me) return;\r\n\r\n        let list = (await readAccList()).filter(a => a.username !== username);\r\n        if (list.length === 1 && list[0].username === me) {\r\n            await ls.set(ACC_LIST_KEY, null);\r\n        } else {\r\n            await ls.set(ACC_LIST_KEY, list);\r\n        }\r\n        lb.showContent(await genHtml());\r\n    })();\r\n}\r\n\r\nasync function accountClicked(el) {\r\n    const currentUsername = (await IAm.ready).me;\r\n    let username = el.dataset['username'];\r\n    if (username === currentUsername) return;\r\n    let token = null;\r\n    (await readAccList()).some(a => {\r\n        if (a.username === username) {\r\n            token = a.token;\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n\r\n    if (token) {\r\n        lb.showContent(\"Please wait\\u2026\");\r\n        // Save the current token of current account\r\n        await addAccount(currentUsername, getCurrentAuth().authToken);\r\n\r\n        // Set the new token\r\n        localStorage.setItem(cookieName, token);\r\n        location.reload();\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/switch-accounts.js","import Messenger from \"./message-rpc\";\r\n\r\nconst frameSrc = \"https://davidmz.github.io/BetterFeed2/storage.html?_=\" + Math.random();\r\nconst frameOrigin = \"https://davidmz.github.io\";\r\n\r\nexport default class {\r\n\r\n    constructor() {\r\n        this.iframe = document.createElement(\"iframe\");\r\n        this.iframe.src = frameSrc;\r\n        this.iframe.style.cssText =\r\n            `visibility: hidden;\r\n            position: absolute;\r\n            left: 0; top: 0;\r\n            height:0; width:0;\r\n            border: none;`;\r\n        // this.iframe.addEventListener(\"load\", e => console.log(e));\r\n        document.body.appendChild(this.iframe);\r\n        this.msg = new Messenger(this.iframe.contentWindow, frameOrigin);\r\n    }\r\n\r\n    get(key) {\r\n        return this.msg.send(\"get\", key);\r\n    }\r\n\r\n    set(key, value) {\r\n        return this.msg.send(\"set\", {key, value});\r\n    }\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/cross-local-storage.js","import {registerModule} from \"./../base/modules\";\r\n\r\nconst module = registerModule(\"no-read-more\", false);\r\n\r\nmodule.watch(\"a.read-more\", a => a.click());\r\n\r\nmodule.watch(\".expand-button > i\", a => a.click());\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/no-read-more.js","import {registerModule} from \"./../base/modules\";\r\nimport h from \"../utils/html\";\r\nimport {getPic} from \"../utils/userpics\";\r\nimport IAm from \"../utils/i-am\";\r\nimport \"../../styles/comment-clouds.less\";\r\n\r\nconst module = registerModule(\"comment-clouds\");\r\n\r\nconst usersWithAvatars = new Map();\r\nlet withAvatars = false;\r\nlet style = null;\r\n\r\nmodule.init(settings => {\r\n    style = document.head.appendChild(h(\"style.bf2-comments-avatars\")).sheet;\r\n    withAvatars = (settings.commentCloudsMode === 2);\r\n    if (withAvatars) {\r\n        document.body.classList.add(\"bf2-comments-with-avatars\");\r\n    }\r\n});\r\n\r\nmodule.watch(\".comment[data-author]\", async(node) => {\r\n    if (node.querySelector(\".bf2-comment-ex\") || node.classList.contains(\"is-hidden\")) {\r\n        return;\r\n    }\r\n    if (withAvatars) {\r\n        const author = node.dataset[\"author\"];\r\n        node.appendChild(h(\".bf2-comment-avatar.bf2-comment-ex\"));\r\n\r\n        if (!usersWithAvatars.has(author)) {\r\n            usersWithAvatars.set(author, true);\r\n            const pic = await getPic(author || (await IAm.ready).me);\r\n            style.insertRule(`.comment[data-author=\"${author}\"] .bf2-comment-avatar { background-image: url(${pic}); }`, 0);\r\n        }\r\n    } else {\r\n        node.appendChild(h(\"i.fa.fa-comment.icon.bf2-ico-bg.bf2-comment-ex\"));\r\n    }\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/comment-clouds.js","// style-loader: Adds some css to the DOM by adding a <style> tag\n\n// load the styles\nvar content = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\");\nif(typeof content === 'string') content = [[module.id, content, '']];\n// add the styles to the DOM\nvar update = require(\"!../../node_modules/style-loader/addStyles.js\")(content, {});\nif(content.locals) module.exports = content.locals;\n// Hot Module Replacement\nif(module.hot) {\n\t// When the styles change, update the <style> tags\n\tif(!content.locals) {\n\t\tmodule.hot.accept(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\", function() {\n\t\t\tvar newContent = require(\"!!../../node_modules/css-loader/index.js!../../node_modules/less-loader/index.js!./comment-clouds.less\");\n\t\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\t\t\tupdate(newContent);\n\t\t});\n\t}\n\t// When the module is disposed, remove the <style> tags\n\tmodule.hot.dispose(function() { update(); });\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/styles/comment-clouds.less\n// module id = 32\n// module chunks = 0","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")();\n// imports\n\n\n// module\nexports.push([module.id, \".comment .comment-icon:not(.fa-stack){position:relative;top:-2px;left:-1px;z-index:1}.comment-likes .comment-likes-list{z-index:2}.bf2-ico-bg{position:absolute;top:0;left:0;color:#fff;display:none}.comment[data-comm-props~=from] .bf2-ico-bg{display:block}.comment[data-comm-props~=from-reader] .bf2-ico-bg{color:#ededed}.comment[data-comm-props~=from-friend] .bf2-ico-bg{color:#cef4fc}.comment[data-comm-props~=from-post-author] .bf2-ico-bg{color:#b5b5b5}.comment[data-comm-props~=from-me] .bf2-ico-bg{color:#ffd061}.comment.omit-bubble .bf2-ico-bg{display:none}.bf2-comment-avatar{position:absolute;width:16px;height:16px;background-size:cover;top:0;left:-4px;z-index:1;background-color:#fff;border-radius:50%;border:1px solid #ccc;box-sizing:content-box;pointer-events:none}.comment.omit-bubble .bf2-comment-avatar{display:none}.bf2-gamma-frontend .highlighted .bf2-comment-avatar{top:4px;left:3px}.bf2-comments-with-avatars .comment-time{margin-right:5px}.bf2-comments-with-avatars .feed-comment-dot:after{margin-top:1px}.bf2-comments-with-avatars .comment{margin-top:10px}.bf2-comments-with-avatars .bf2-likecomm-shift{left:-9px}.bf2-comments-with-avatars .likes{position:relative;left:-2px}.bf2-comments-with-avatars .likes .icon{margin-right:7px}.bf2-comments-with-avatars .fold-comments-sticky{z-index:2}.bf2-comments-with-avatars .fold-comments-sticky i{left:-2px}.bf2-gamma-frontend.bf2-comments-with-avatars .comment.highlighted{margin-top:6px}\", \"\"]);\n\n// exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/css-loader!./~/less-loader!./src/styles/comment-clouds.less\n// module id = 33\n// module chunks = 0","import {registerModule} from \"./../base/modules\";\r\nimport h from \"../utils/html\";\r\n\r\nconst module = registerModule(\"hide-arabic\", false);\r\n\r\nlet style = null;\r\n\r\nmodule.init(() => {\r\n    style = document.head.appendChild(h(\"style.bf2-hide-posts\")).sheet;\r\n    style.insertRule(\".bf2-aggregate-page .bf2-lang-arabic { display: none; }\", 0);\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/hide-arabic.js","import {registerModule} from \"./../base/modules\";\r\nimport textWalk from \"../utils/text-walk\";\r\nimport escapeHTML from \"../utils/escape-html\";\r\nimport matches from \"../utils/matches\";\r\n\r\nconst module = registerModule(\"hanging-punct\");\r\n\r\nlet helper;\r\n\r\nmodule.init(() => {\r\n    helper = document.createElement(\"div\");\r\n});\r\n\r\nconst re = /(^|\\s)([(«“-]|&quot;)/g;\r\n\r\nmodule.watch(\".post-text, .comment-body\", node => {\r\n    if (matches(node, \".comment-body\")) {\r\n        const userNames = node.querySelectorAll(\".user-name-wrapper\");\r\n        const lastUserName = userNames[userNames.length - 1];\r\n        if (lastUserName && lastUserName.nextElementSibling) {\r\n            const actions = lastUserName.nextElementSibling;\r\n            textWalk(actions, node => {\r\n                if (node.nodeValue === \"(\") {\r\n                    node.nodeValue = \" (\";\r\n                }\r\n            });\r\n        }\r\n    }\r\n    textWalk(node, node => {\r\n        if (node.parentNode.classList.contains(\"bf2-hp\")) {\r\n            return;\r\n        }\r\n        let html = escapeHTML(node.nodeValue);\r\n        if (!re.test(html)) {\r\n            return;\r\n        }\r\n        html = html.replace(re, '<span class=\"bf2-hp bf2-hp-pre bf2-hp-pre-$2\">$1</span><span class=\"bf2-hp bf2-hp-$2\">$2</span>');\r\n        helper.innerHTML = html;\r\n        while (helper.firstChild) {\r\n            node.parentNode.insertBefore(helper.firstChild, node);\r\n        }\r\n        node.parentNode.removeChild(node);\r\n    });\r\n});\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/hanging-punct.js","/**\r\n *\r\n * @param {Node} node\r\n * @param {function} foo\r\n */\r\nexport default function textWalk(node, foo) {\r\n    if (node.nodeType === Node.TEXT_NODE) {\r\n        foo(node);\r\n    } else if (node.nodeType === Node.ELEMENT_NODE) {\r\n        let c = node.firstChild;\r\n        while (c) {\r\n            const next = c.nextSibling;\r\n            textWalk(c, foo);\r\n            c = next;\r\n        }\r\n    }\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/utils/text-walk.js","import {registerModule} from \"./../base/modules\";\r\n\r\nconst module = registerModule(\"show-timestamps\", false);\r\n\r\nmodule.watch(\".post-lock-icon\", t => {\r\n    const event = document.createEvent(\"MouseEvents\");\r\n    event.initEvent(\"click\", true, true);\r\n    t.dispatchEvent(event);\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/show-timestamps.js","import {registerModule} from \"../base/modules\";\r\n\r\nconst module = registerModule(\"no-comment-more\", false);\r\n\r\nmodule.watch(\".comment-tail__actions\", it => {\r\n    const actions = it.querySelectorAll(\".comment-tail__action\");\r\n    if (actions.length === 1) {\r\n        it.hidden = true;\r\n    } else {\r\n        actions[actions.length - 1].hidden = true;\r\n    }\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/js/modules/no-comment-more.js"],"sourceRoot":""}