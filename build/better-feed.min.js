!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e){var t=this;(0,s.startObserver)(e);var n=new b["default"];n.on("getSettings",function(){return e.toJSON()}),n.on("saveSettings",function(){var e=o(regeneratorRuntime.mark(function n(e){var r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l["default"].ready;case 2:return r=t.sent,t.next=5,r.saveProps(new m["default"](e));case 5:location.reload(!0);case 6:case"end":return t.stop()}},n,t)}));return function(t){return e.apply(this,arguments)}}()),n.on("checkUpdates",a)}function a(){var e=Date.now(),t=localStorage["bf2-version"];localStorage["bf2-next-update"]=e+36e5;var n=new XMLHttpRequest;n.open("GET","https://api.github.com/repos/davidmz/BetterFeed2/tags?page=1&per_page=1"),n.responseType="json",n.onload=function(){try{var r=n.response;if(1==r.length&&"name"in r[0]){var o=r[0].name;localStorage["bf2-version"]=o,localStorage["bf2-next-update"]=e+864e5,o!=t?confirm("Доступна новая версия: "+o+". Она будет установлена после перезагрузки страницы.\n\nПерезагрузить страницу сейчас?")&&location.reload(!0):alert("У вас установлена последняя версия ("+o+")")}}catch(i){}},n.send()}var u=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){o=!0,i=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();n(1);var s=n(5),c=n(8),f=n(9),l=r(f),d=n(17),h=r(d),p=n(18),m=r(p),v=n(19),b=r(v);n(20),n(23),n(26),n(27),n(28),n(29),n(32),n(37),n(38),n(39),/^\/(attachments|files)\//.test(location.pathname)||(MutationObserver&&Promise?null===c.userId?console.error("Can not start BetterFeed: user not logged in"):"__BetterFeed"in window?console.warn("BetterFeed already started"):(window.__BetterFeed=!0,Promise.all([l["default"].ready,h["default"]]).then(function(e){var t=u(e,1),n=t[0];i(new m["default"](n.bf2Props))})):console.error("Can not start BetterFeed: MutationObserver & Promise not supported"))},function(e,t,n){var r=n(2);"string"==typeof r&&(r=[[e.id,r,""]]);n(4)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(3)(),t.push([e.id,'.bf2-lightbox-container{left:0;top:0;width:100%;height:100%;position:fixed}.bf2-lightbox-shadow{left:0;top:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.5)}.bf2-lightbox-content{position:relative;border:1px solid #000;background-color:#ccc;box-shadow:0 0 50px rgba(0,0,0,.5)}.bf2-settings-lightbox .bf2-lightbox-content{width:90vw;height:90vh;max-width:800px}.bf2-settings-lightbox .bf2-lightbox-content iframe{left:0;top:0;width:100%;height:100%}.bf2-access-token-lightbox .bf2-lightbox-content{background-color:#fff;max-width:90vw;padding:2em}.bf2-access-token-lightbox .bf2-lightbox-content button{padding:.25em 2em;cursor:pointer}.bf2-access-token-lightbox .bf2-lightbox-content .bf2-access-token{word-wrap:break-word;font-family:monospace;color:#069;background-color:#eee;padding:1em}.bf2-green{padding:1em}.bf2-via-names{font-size:12px}.bf2-hide-aliens-cont{font-size:14px;font-weight:400;margin-left:1em;display:none}.bf2-homepage .bf2-hide-aliens-cont{display:inline}.bf2-hide-aliens .bf2-alien-post{display:none}.bf2-saving-settings-indicator{position:fixed;top:.66em;right:1em;background:#f66;color:#fff;padding:.25em 1em;border-radius:4px;z-index:100}.bf2-animated-gif{position:relative;display:inline-block}.bf2-animated-gif:after{content:"\\25B6   GIF";position:absolute;bottom:3px;right:4px;background-color:#069;color:#eee;font-weight:700;padding:.1em .4em;border-radius:3px;font-size:11px}.arrow-span{padding:0 .2em}.bf2-moon{width:18px;height:18px;margin-left:4px;margin-bottom:10px}.bf2-moon-shadow{fill:#666}.bf2-moon-light{fill:#f5eed9}h1{float:left;position:relative}.bf2-moon-cont{position:absolute;top:0;right:-20px}.bf2-switch-acc{color:#ccc;cursor:pointer;text-align:center}.bf2-switch-acc:hover{background-color:#eee;color:#000}.bf2-switch-account-box .bf2-lightbox-content{width:360px;height:auto;cursor:auto;border:1px solid #000;box-shadow:1px 1px 10px rgba(0,0,0,.5);background-color:#fff;padding:1em}.bf2-switch-dlg-header{font-size:120%}.bf2-switch-dlg-accounts{margin:1em 0}.bf2-switch-dlg-account{cursor:pointer;font-weight:700;border:1px solid #ddd;margin:.5em 0;position:relative}.bf2-switch-dlg-account.-current,.bf2-switch-dlg-account:hover{background-color:#eee}.bf2-switch-dlg-account.-current{cursor:not-allowed}.bf2-switch-dlg-account.-current .bf2-switch-dlg-del{display:none}.bf2-switch-dlg-upic{width:50px;height:50px;margin-right:1em;border-right:1px solid #ddd}.bf2-switch-dlg-new-form{display:none}.bf2-switch-dlg-del{position:absolute;right:0;top:50%;width:20px;height:20px;line-height:20px;text-align:center;margin-top:-10px}.bf2-switch-dlg-del:hover{color:#c00}.box{clear:both}',""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=h[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(c(r.parts[i],t))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(c(r.parts[i],t));h[r.id]={id:r.id,refs:1,parts:a}}}}function o(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],a=o[1],u=o[2],s=o[3],c={css:a,media:u,sourceMap:s};n[i]?n[i].parts.push(c):t.push(n[i]={id:i,parts:[c]})}return t}function i(e,t){var n=v(),r=g[g.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),g.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=g.indexOf(e);t>=0&&g.splice(t,1)}function u(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function s(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function c(e,t){var n,r,o;if(t.singleton){var i=y++;n=b||(b=u(t)),r=f.bind(null,n,i,!1),o=f.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(t),r=d.bind(null,n),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=u(t),r=l.bind(null,n),o=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function f(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=w(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function l(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function d(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var h={},p=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},m=p(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),v=p(function(){return document.head||document.getElementsByTagName("head")[0]}),b=null,y=0,g=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=m()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=o(e);return r(n,t),function(e){for(var i=[],a=0;a<n.length;a++){var u=n[a],s=h[u.id];s.refs--,i.push(s)}if(e){var c=o(e);r(c,t)}for(var a=0;a<i.length;a++){var s=i[a];if(0===s.refs){for(var f=0;f<s.parts.length;f++)s.parts[f]();delete h[s.id]}}}};var w=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2],r=new l(e,t,n);return f.set(e,r),r}function a(e){if(!d){d=e,f.forEach(function(e){d.isModuleEnabled(e)&&e._initiate(d)});var t=new MutationObserver(function(e){e.forEach(function(e){for(var t=function(t,n){var r=e.addedNodes[t];r.nodeType==Node.ELEMENT_NODE&&f.forEach(function(e){d.isModuleEnabled(e)&&e._trigger(r,d)})},n=0,r=e.addedNodes.length;r>n;n++)t(n,r)})});t.observe(document.body,{childList:!0,subtree:!0})}}Object.defineProperty(t,"__esModule",{value:!0}),t.registeredModules=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.registerModule=i,t.startObserver=a;var s=n(6),c=r(s),f=t.registeredModules=new Map,l=function(){function e(t){var n=arguments.length<=1||void 0===arguments[1]?!0:arguments[1],r=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];o(this,e),this.name=t,this.alwaysEnabled=r,this.enabledByDefault=n,this.requiredModules=[],this._watchers=[],this._initiators=[]}return u(e,[{key:"init",value:function(e){this._initiators.push(e)}},{key:"watch",value:function(e,t){this._watchers.push({selector:e,callback:t})}},{key:"required",value:function(e){this.requiredModules.push(e)}},{key:"_initiate",value:function(e){this._initiators.forEach(function(t){return t(e)}),this._watchers.forEach(function(t){var n=t.selector,r=t.callback;return(0,c["default"])(document.body,n,function(t){return r(t,e)})})}},{key:"_trigger",value:function(e){this._watchers.forEach(function(t){var n=t.selector,r=t.callback;return(0,c["default"])(e,n,function(e){return r(e,d)})})}}]),e}(),d=null},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),i=r(o);t["default"]=function(e,t,n){if(null===e)return[];var r=e.querySelectorAll(t),o=r?Array.prototype.slice.call(r):[];if((0,i["default"])(e,t)&&o.unshift(e),n)for(var a=0,u=o.length;u>a;a++)n(o[a]);return o}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t){return e[n](t)};var n="matches"in HTMLElement.prototype?"matches":"msMatchesSelector"},function(e,t){"use strict";function n(e){var t=document.cookie.match(new RegExp("(?:^|;\\s*)"+e+"=([^;]*)"));if(t){var n=t[1],r=n.split(".");if(3===r.length)try{var o=JSON.parse(atob(r[1]));if("userId"in o)return[o.userId,n]}catch(i){}}return[null,null]}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){o=!0,i=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=t.userId=null,i=t.authToken=null,a={"freefeed.net":{cookies:["freefeedBETA_authToken","freefeed_authToken"]},"gamma.freefeed.net":{cookies:["freefeed_authToken"]}},u=t.siteDomain=location.hostname,s=t.cookieName="freefeed_authToken";u in a&&a[u].cookies.some(function(e){var a=n(e),u=r(a,2);return t.userId=o=u[0],t.authToken=i=u[1],t.cookieName=s=e,null!==o})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(10),f=o(c),l=n(11),d=o(l),h=n(13),p=r(h),m="me.davidmz.BetterFeed2",v=function(){function e(){u(this,e),this.me=null,this.myID=null,this.myScreenName=null,this.friends=[],this.readers=[],this.banIds=[],this.bf2Props={},this._savePropsQueue=[],this._savingPropsNow=!1,this._savingIndicator=(0,p["default"])(".bf2-saving-settings-indicator","Saving settings…")}return s(e,[{key:"whoIs",value:function(t){var n=0;return t===this.me&&(n|=e.ME),-1!==this.friends.indexOf(t)&&(n|=e.FRIEND),-1!==this.readers.indexOf(t)&&(n|=e.READER),n}},{key:"isBanned",value:function(e){return-1!==this.banIds.indexOf(e)}},{key:"saveProps",value:function(e){return this._savePropsQueue.push(e.toJSON()),this._saveProps()}},{key:"_saveProps",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function n(){var e,t,r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!this._savingPropsNow){n.next=2;break}return n.abrupt("return");case 2:document.body.appendChild(this._savingIndicator),this._savingPropsNow=!0;case 4:if(!(this._savePropsQueue.length>0)){n.next=13;break}e=this._savePropsQueue.shift(),t={};for(r in e)e.hasOwnProperty(r)&&(t[r]=null);return n.next=9,f.put("/v1/users/"+this.myID,JSON.stringify({user:{frontendPreferences:i({},m,t)}}));case 9:return n.next=11,f.put("/v1/users/"+this.myID,JSON.stringify({user:{frontendPreferences:i({},m,e)}}));case 11:n.next=4;break;case 13:this._savingPropsNow=!1,document.body.removeChild(this._savingIndicator);case 15:case"end":return n.stop()}},n,this)}));return e}()}]),e}();t["default"]=v,v.ME=1,v.FRIEND=2,v.READER=4,v.ready=null,v.update=function(){v.ready=f.get("/v1/users/whoami").then(function(e){var t=new v;return t.me=e.users.username,t.myID=e.users.id,t.myScreenName=e.users.screenName,d.setPic(e.users.username,e.users.profilePictureMediumUrl),t.friends=(e.subscribers||[]).map(function(e){return d.setPic(e.username,e.profilePictureMediumUrl),e.username}),t.banIds=e.users.banIds,t.bf2Props=e.users.frontendPreferences[m]||{},f.get("/v1/users/"+t.me+"/subscribers").then(function(e){return t.readers=(e.subscribers||[]).map(function(e){return d.setPic(e.username,e.profilePictureMediumUrl),e.username}),t})})},v.update()},function(e,t,n){"use strict";function r(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",s+e),r.responseType="json",r.setRequestHeader("X-Authentication-Token",u.authToken),r.onload=function(){r.response&&"err"in r.response?n(r.response.err):t(r.response)},r.send()})}function o(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("PUT",s+e),o.responseType="json",o.setRequestHeader("X-Authentication-Token",u.authToken),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.onload=function(){o.response&&"err"in o.response?r(o.response.err):n(o.response)},o.send(t)})}function i(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("DELETE",s+e),o.responseType="json",o.setRequestHeader("X-Authentication-Token",u.authToken),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.onload=function(){o.response&&"err"in o.response?r(o.response.err):n(o.response)},o.send(t)})}function a(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("POST",s+e),o.responseType="json",o.setRequestHeader("X-Authentication-Token",u.authToken),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.onload=function(){o.response&&"err"in o.response?r(o.response.err):n(o.response)},o.send(t)})}Object.defineProperty(t,"__esModule",{value:!0}),t.get=r,t.put=o,t.del=i,t.post=a;var u=n(8),s="https://freefeed.net"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e){return l.has(e)||l.set(e,u(e)),l.get(e)}function a(e,t){l.set(e,Promise.resolve(t&&""!==t?t:f))}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultPic=void 0;var u=function(){var e=o(regeneratorRuntime.mark(function t(e){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,c["default"])(e);case 2:return n=t.sent,r=n.users.profilePictureMediumUrl,t.abrupt("return",r&&""!==r?r:f);case 5:case"end":return t.stop()}},t,this)}));return function(t){return e.apply(this,arguments)}}();t.getPic=i,t.setPic=a;var s=n(12),c=r(s),f=t.defaultPic="https://freefeed.net/img/default-userpic-48.png",l=new Map},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){var t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];return u.has(e)&&!t||u.set(e,a.get("/v1/users/"+e)),u.get(e)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(10),a=r(i),u=new Map},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t,n){var r,o,u,f=e.split("."),l=f.shift()||"div";"$"===l?u=document.createDocumentFragment():(u=document.createElement(l),f.length>0&&(u.className=f.join(" ")));var d=1;if(arguments.length>1&&"object"===("undefined"==typeof t?"undefined":a(t))&&!(t instanceof Node)&&!(0,s["default"])(t)&&!(0,c.isSafeHTML)(t)){for(o in t)t.hasOwnProperty(o)&&u.setAttribute(o,t[o]);d=2}if(arguments.length>d)for(r=d;r<arguments.length;r++)i(u,arguments[r]);return u}function i(e,t){t instanceof Node?e.appendChild(t):(0,s["default"])(t)?t.forEach(i.bind(null,e)):"string"==typeof t?e.appendChild(document.createTextNode(t)):(0,c.isSafeHTML)(t)&&e.insertAdjacentHTML("beforeEnd",t.toString())}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};t["default"]=o;var u=n(14),s=r(u),c=n(15)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return new l(e)}function a(e){return e instanceof l}function u(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return i(e.reduce(function(e,t,r){var o=n[r-1];return e+(a(o)?o:(0,f["default"])(o))+t}))}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.safeHTML=i,t.isSafeHTML=a,t.html=u;var c=n(16),f=r(c),l=function(){function e(t){o(this,e),this.text=t}return s(e,[{key:"toString",value:function(){return this.text}}]),e}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=new Promise(function(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,0):document.addEventListener("DOMContentLoaded",e)})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){o=!0,i=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(5),u=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?null:arguments[0],i=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];r(this,e),this.modules=new Map,a.registeredModules.forEach(function(e){e.alwaysEnabled||t.modules.set(e.name,e.enabledByDefault)}),this.hidePostsFrom=new Set,this.hideAliens=!1,n&&((n.modules||[]).forEach(function(e){var n=o(e,2),r=n[0],a=n[1];(i||t.modules.has(r))&&t.modules.set(r,!!a)}),(n.hidePostsFrom||[]).forEach(function(e){return t.hidePostsFrom.add(e)}),this.hideAliens=!!n.hideAliens)}return i(e,[{key:"toJSON",value:function(){var e={modules:[],hidePostsFrom:[]};return this.modules.forEach(function(t,n){return e.modules.push([n,t])}),this.hidePostsFrom.forEach(function(t){return e.hidePostsFrom.push(t)}),e.hideAliens=this.hideAliens,e}},{key:"isModuleEnabled",value:function(e){var t=this;return(e.alwaysEnabled||!this.modules.has(e.name)&&e.enabledByDefault||this.modules.get(e.name))&&!e.requiredModules.map(function(e){return a.registeredModules.get(e)}).some(function(e){return!t.isModuleEnabled(e)})}}]),e}();t["default"]=u},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=1,a="@response",u=function(){function e(){var t=this,o=arguments.length<=0||void 0===arguments[0]?null:arguments[0],i=arguments.length<=1||void 0===arguments[1]?"":arguments[1];n(this,e),this.__responders=new Map,this.__listeners=new Map,this.defaultWindow=o,this.defaultOrigin=i,window.addEventListener("message",function(e){if("object"===r(e.data)){var n=e.data,o=n.action,i=n.requestId,u=n.value,s=e.source,c=e.origin;if(o===a&&t.__responders.has(i))t.__responders.get(i)(u),t.__responders["delete"](i);else if(t.__listeners.has(o)){var f=t.__listeners.get(o)(u);s.postMessage({action:a,requestId:i,value:f},c)}}})}return o(e,[{key:"send",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1];return this.sendEx(this.defaultWindow,this.defaultOrigin,e,t)}},{key:"sendEx",value:function(e,t,n){var r=this,o=arguments.length<=3||void 0===arguments[3]?null:arguments[3];return new Promise(function(a){var u=i++;r.__responders.set(u,a),e.postMessage({action:n,requestId:u,value:o},t)})}},{key:"on",value:function(e,t){this.__listeners.set(e,t)}}]),e}();t["default"]=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var o=n(5),i=n(21),a=r(i),u=n(22),s=r(u),c=n(6),f=r(c),l=(0,o.registerModule)("common",!0,!0);l.init(function(){(0,s["default"])(function(e){return document.body.classList.toggle("bf2-homepage","/"===e.pathname)}),document.addEventListener("click",function(e){if(0==e.button&&e.target.classList.contains("bf2-user-link")){var t=document.querySelector('a:not(.bf2-user-link)[href="'+CSS.escape(e.target.getAttribute("href"))+'"]');t&&(e.preventDefault(),e.target.blur(),t.click())}})}),l.watch(".timeline-post, .single-post",function(e){var t=e.querySelector(".post-timestamp").getAttribute("href").match(/^\/.+?\/([\w-]+)/)[1];e.id="post-"+t,e.dataset.postId=t;var n=e.querySelector(".post-author").getAttribute("href").substr(1);e.dataset.postAuthor=n,e.classList.add("bf2-post-from-"+n),(0,f["default"])(e,".post-recipient").map(function(e){return e.getAttribute("href").substr(1)}).filter(function(e){return e!==n}).forEach(function(t){return e.classList.add("bf2-post-to-"+t)})}),l.watch(".user-card .display-name",function(e){(0,a["default"])(e,".user-card").dataset.userName=e.getAttribute("href").substr(1)})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){var n=arguments.length<=2||void 0===arguments[2]?!1:arguments[2];if(null===e)return null;var r=n?e:e.parentNode;return u?r.closest(t):r&&r.nodeType==Node.ELEMENT_NODE?(0,a["default"])(r,t)?r:o(r,t):null}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var i=n(7),a=r(i),u=!!Element.prototype.closest},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e){n.push(e),e(location)};var n=[],r=history.pushState.bind(history),o=history.replaceState.bind(history);history.pushState=function(e,t,o){r(e,t,o),n.forEach(function(e){return e(location)})},history.replaceState=function(e,t,r){o(e,t,r),n.forEach(function(e){return e(location)})},window.addEventListener("popstate",function(){return n.forEach(function(e){return e(location)})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=(0,c["default"])("a","configure settings"),n=(0,c["default"])("a","show access token");e.parentNode.insertBefore((0,c["default"])("p.bg-success.bf2-green","BetterFeed enabled ("+b+") | ",(0,c["default"])("i.fa.fa-cog")," ",t," | ",(0,c["default"])("i.fa.fa-exclamation-triangle")," ",n),e),t.addEventListener("click",function(){return i()}),n.addEventListener("click",function(){return a()})}function i(){var e=l["default"]+"/src/html/settings.html?origin="+encodeURIComponent(location.origin);return/iPhone|iPad/.test(navigator.userAgent)?void window.open(e,"_blank"):void new h["default"]("bf2-settings-lightbox").showContent((0,c["default"])("iframe",{src:e,frameborder:"0"}))}function a(){var e='\n        <p>\n            Your access token is:\n        </p>\n        <p class="bf2-access-token">\n            '+(0,v["default"])(p.authToken)+'\n        </p>\n        <p>\n            <strong>WARNING:</strong> Keep your token secure at all times and do not share it with services you do not fully trust.\n            They will be able to perform ANY operation on your behalf including changing your password and\n            <strong>locking you out of your account</strong>.\n        </p>\n        <p>\n            Giving your token to third party services provides them with FULL and UNLIMITED access to your account.\n            You can not change the token, you cannot revert access once you give it out.\n        </p>\n        <p>\n            If you suspect your token is being abused, contact <a href="mailto:freefeed.net@gmail.com">freefeed.net@gmail.com</a> <strong>immediately</strong>.\n        </p>\n        <p style="text-align: center">\n            <button>Close</button>\n        </p>\n    ',t=new h["default"]("bf2-access-token-lightbox");t.showContent(e),t.contentEl.querySelector("button").addEventListener("click",function(){return t.hide()})}var u=n(5),s=n(13),c=r(s),f=n(24),l=r(f),d=n(25),h=r(d),p=n(8),m=n(16),v=r(m),b=localStorage["bf2-version"]||"v0.0.0",y=(0,u.registerModule)("settings-link",!0,!0);y.watch(".sidebar",function(e){if(!e.querySelector(".bf2-sidebar-box")){var t=(0,c["default"])("a","BetterFeed settings"),n=(0,c["default"])(".bf2-sidebar-box.box",(0,c["default"])(".box-header-groups","Add-ons"),(0,c["default"])(".box-body",(0,c["default"])("ul",(0,c["default"])("li",t))),(0,c["default"])(".box-footer",b));e.insertBefore(n,null),t.addEventListener("click",function(){return i()})}}),"__BetterFeedOnSite"in window?y.watch(".bf2-settings-description",function(e){document.body.querySelector(".bf2-green")||o(e)}):y.watch(".box-body > form > h3",function(e){if(!document.body.querySelector(".bf2-green")&&"Change password"===e.textContent){var t=e.parentNode,n=(0,c["default"])("p.bf2-settings-description","BetterFeed is an add-on that improves or dramatically alters stock interface of FreeFeed (",(0,c["default"])("a",{href:"https://github.com/davidmz/BetterFeed2",target:"_blank"},"details"),"). "),r=(0,c["default"])("div",(0,c["default"])("h3.bf2-settings-header","Add-ons"),n,(0,c["default"])("hr"));t.parentNode.insertBefore(r,t),o(n)}})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="https://cdn.rawgit.com/davidmz/BetterFeed2/"+localStorage["bf2-version"];if(document.currentScript){var r=document.currentScript.src.split("/");n=r.slice(0,r.length-2).join("/")}t["default"]=n},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(13),u=r(a),s=function(){function e(){var t=this,n=arguments.length<=0||void 0===arguments[0]?"":arguments[0],r=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];o(this,e),this._container=(0,u["default"])(".bf2-lightbox-container"),""!==n&&this._container.classList.add(n);var i=this._container.appendChild((0,u["default"])(".bf2-lightbox-shadow"));this.contentEl=i.appendChild((0,u["default"])(".bf2-lightbox-content")),i.addEventListener("click",function(e){e.target!==i||r||t.hide()})}return i(e,[{key:"showContent",value:function(e){"string"==typeof e?this.contentEl.innerHTML=e:(this.contentEl.innerHTML="",this.contentEl.appendChild(e)),
document.body.appendChild(this._container)}},{key:"hide",value:function(){this.contentEl.innerHTML="",this._container.parentNode.removeChild(this._container)}}]),e}();t["default"]=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){e.title=(t?"Show":"Hide")+" user’s posts "+(t?"in":"from")+" home feed",e.innerHTML=(0,m["default"])((t?"Show":"Hide")+" posts")}function i(e){return".bf2-homepage .bf2-post-from-"+e}function a(e){return".bf2-homepage .bf2-post-to-"+e}var u=n(5),s=n(13),c=r(s),f=n(9),l=r(f),d=n(21),h=r(d),p=n(16),m=r(p),v=(0,u.registerModule)("hide-posts"),b=null;v.init(function(e){b=document.head.appendChild((0,c["default"])("style.bf2-hide-posts")).sheet,e.hidePostsFrom.forEach(function(e){b.insertRule(i(e)+" { display: none; }",0),b.insertRule(a(e)+" { display: none; }",0)})}),v.watch(".user-card-actions",function(e,t){var n=(0,h["default"])(e,".user-card").dataset.userName,r=t.hidePostsFrom.has(n),u=(0,c["default"])("a");o(u,r),e.appendChild((0,c["default"])("span"," - ",u)),u.addEventListener("click",function(){r?(Array.prototype.slice.call(b.rules).forEach(function(e,t){e.selectorText!==i(n)&&e.selectorText!==a(n)||b.deleteRule(t)}),t.hidePostsFrom["delete"](n)):(b.insertRule(i(n)+" { display: none; }",0),b.insertRule(a(n)+" { display: none; }",0),t.hidePostsFrom.add(n)),r=!r,o(u,r),l["default"].ready.then(function(e){return e.saveProps(t)})})})},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}var u=i(['<a href="/','" class="bf2-user-link">',"</a>"],['<a href="/','" class="bf2-user-link">',"</a>"]),s=n(5),c=n(6),f=o(c),l=n(10),d=r(l),h=n(15),p=n(9),m=o(p),v=(0,s.registerModule)("posts-via");v.watch(".timeline-post:not(.bf2-post-via)",function(){var e=a(regeneratorRuntime.mark(function t(e){var n,r,o,i,a,s,c,l,p,v,b,y,g;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if("/"===location.pathname){t.next=2;break}return t.abrupt("return");case 2:return e.classList.add("bf2-post-via"),t.next=5,m["default"].ready;case 5:if(n=t.sent,r=e.dataset.postId,o=e.dataset.postAuthor,i=(0,f["default"])(e,".post-recipient").map(function(e){return e.getAttribute("href").substr(1)}).filter(function(e){return e!==o}),!(n.whoIs(o)&(m["default"].ME|m["default"].FRIEND))){t.next=11;break}return t.abrupt("return");case 11:if(!i.some(function(e){return!!(n.whoIs(e)&m["default"].FRIEND)})){t.next=13;break}return t.abrupt("return");case 13:if(e.classList.add("bf2-alien-post"),a=(0,f["default"])(e,".likes a"),s=a.some(function(e){return!e.hasAttribute("href")}),c=a.filter(function(e){return e.hasAttribute("href")}).map(function(e){return e.getAttribute("href").substr(1)}).filter(function(e){return null!==e&&!!(n.whoIs(e)&(m["default"].ME|m["default"].FRIEND))}),l=(0,f["default"])(e,".comment-body > .user-name-wrapper a").map(function(e){return e.getAttribute("href").substr(1)}).filter(function(e){return!!(n.whoIs(e)&(m["default"].ME|m["default"].FRIEND))}),!s||0!=c.length||0!=l.length){t.next=20;break}return t.delegateYield(regeneratorRuntime.mark(function w(){var e,t,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,d.get("/v1/posts/"+r+"?maxLikes=all&maxComments=2");case 2:e=i.sent,t=e.posts.likes,o=e.users,c=t.map(function(e){var t=o.filter(function(t){return t.id=e}).map(function(e){return e.username});return t.length>0?t[1]:null}).filter(function(e){return null!==e&&!!(n.whoIs(e)&(m["default"].ME|m["default"].FRIEND))}).filter(function(e,t,n){return n.indexOf(e)===t});case 6:case"end":return i.stop()}},w,void 0)})(),"t0",20);case 20:p=!1,v=!1,b=[],y=0==c.length&&0==l.length,y||(p=c.some(function(e){return e==n.me}),v=l.some(function(e){return e==n.me}),b=c.concat(l).filter(function(e){return e!==n.me}).filter(function(e,t,n){return n.indexOf(e)===t})),g=[],y?g.push("somebody"):(v?g.push("your comment"):p&&g.push("your like"),b.forEach(function(e){return g.push((0,h.html)(u,e,e))})),g.length>1&&(g[g.length-2]=g[g.length-2]+" and "+g[g.length-1],g.length--),e.querySelector(".post-header").insertAdjacentHTML("beforeend",'<span class="bf2-via-names"> via '+g.join(", ")+"</span>");case 29:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var o=n(5),i=n(13),a=r(i),u=n(9),s=r(u),c=(0,o.registerModule)("hide-aliens");c.required("posts-via");var f=(0,a["default"])("input",{type:"checkbox"}),l=(0,a["default"])("span","0"),d=(0,a["default"])("label.bf2-hide-aliens-cont",f," hide non-friends posts (",l,")");c.init(function(e){setInterval(function(){return l.innerHTML=document.body.querySelectorAll(".bf2-alien-post").length},500),f.checked=e.hideAliens,document.body.classList.toggle("bf2-hide-aliens",e.hideAliens),f.addEventListener("click",function(){document.body.classList.toggle("bf2-hide-aliens",f.checked),e.hideAliens=f.checked,s["default"].ready.then(function(t){return t.saveProps(e)})})}),c.watch(".box-header-timeline",function(e){return e.appendChild(d)})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.addEventListener("load",function(){var e,o,i=new Uint8Array(r.response),a=i.length,u=0;if(71!==i[0]||73!==i[1]||70!==i[2]||56!==i[3])return void n("Not a gif file");for(e=0,o=a-3;o>e&&2>u;++e)if(33===i[e+1]&&249===i[e+2]){var s=i[e+3],c=e+4+s;a>c+1&&0===i[c]&&(44===i[c+1]||33===i[c+1])&&u++}t(u>1)}),r.send()})}function a(e){if(!e.src.match(/^data:/)){var t=document.createElement("canvas"),n=t.width=e.width,r=t.height=e.height,o=new Image;o.crossOrigin="anonymous",o.onload=function(){t.getContext("2d").drawImage(o,0,0,n,r),e.src=t.toDataURL()},o.src=e.src}}var u=function(){var e=o(regeneratorRuntime.mark(function t(e){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.match(/([\w-]+)\.gif$/)[1],t.next=4,d.getItem(n);case 4:if(r=t.sent,null!==r){t.next=10;break}return t.next=8,i(e);case 8:r=t.sent,d.setItem(n,r);case 10:return t.abrupt("return",r);case 13:return t.prev=13,t.t0=t["catch"](0),console.warn("Gif analyze problem ("+e+"): "+t.t0),t.abrupt("return",!1);case 17:case"end":return t.stop()}},t,this,[[0,13]])}));return function(t){return e.apply(this,arguments)}}(),s=n(30),c=r(s),f=n(5),l=(0,f.registerModule)("ani-gifs"),d=c["default"].createInstance({name:"BF2_aniGifs"});l.watch(".image-attachments img[src$='.gif'][src*='/attachments/']:not(.bf2-gif)",function(){var e=o(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.classList.add("bf2-gif"),t.next=3,u(e.src);case 3:if(!t.sent){t.next=6;break}e.parentNode.classList.add("bf2-animated-gif"),a(e);case 6:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}())},function(e,t,n){(function(t,n){/*!
	    localForage -- Offline Storage, Improved
	    Version 1.4.0
	    https://mozilla.github.io/localForage
	    (c) 2013-2015 Mozilla, Apache License 2.0
	*/
!function(){var e,r,o,i;!function(){var t={},n={};e=function(e,n,r){t[e]={deps:n,callback:r}},i=o=r=function(e){function o(t){if("."!==t.charAt(0))return t;for(var n=t.split("/"),r=e.split("/").slice(0,-1),o=0,i=n.length;i>o;o++){var a=n[o];if(".."===a)r.pop();else{if("."===a)continue;r.push(a)}}return r.join("/")}if(i._eak_seen=t,n[e])return n[e];if(n[e]={},!t[e])throw new Error("Could not find module "+e);for(var a,u=t[e],s=u.deps,c=u.callback,f=[],l=0,d=s.length;d>l;l++)"exports"===s[l]?f.push(a={}):f.push(r(o(s[l])));var h=c.apply(this,f);return n[e]=a||h}}(),e("promise/all",["./utils","exports"],function(e,t){"use strict";function n(e){var t=this;if(!r(e))throw new TypeError("You must pass an array to all.");return new t(function(t,n){function r(e){return function(t){i(e,t)}}function i(e,n){u[e]=n,0===--s&&t(u)}var a,u=[],s=e.length;0===s&&t([]);for(var c=0;c<e.length;c++)a=e[c],a&&o(a.then)?a.then(r(c),n):i(c,a)})}var r=e.isArray,o=e.isFunction;t.all=n}),e("promise/asap",["exports"],function(e){"use strict";function r(){return function(){n.nextTick(a)}}function o(){var e=0,t=new f(a),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}function i(){return function(){l.setTimeout(a,1)}}function a(){for(var e=0;e<d.length;e++){var t=d[e],n=t[0],r=t[1];n(r)}d=[]}function u(e,t){var n=d.push([e,t]);1===n&&s()}var s,c="undefined"!=typeof window?window:{},f=c.MutationObserver||c.WebKitMutationObserver,l="undefined"!=typeof t?t:void 0===this?window:this,d=[];s="undefined"!=typeof n&&"[object process]"==={}.toString.call(n)?r():f?o():i(),e.asap=u}),e("promise/config",["exports"],function(e){"use strict";function t(e,t){return 2!==arguments.length?n[e]:void(n[e]=t)}var n={instrument:!1};e.config=n,e.configure=t}),e("promise/polyfill",["./promise","./utils","exports"],function(e,n,r){"use strict";function o(){var e;e="undefined"!=typeof t?t:"undefined"!=typeof window&&window.document?window:self;var n="Promise"in e&&"resolve"in e.Promise&&"reject"in e.Promise&&"all"in e.Promise&&"race"in e.Promise&&function(){var t;return new e.Promise(function(e){t=e}),a(t)}();n||(e.Promise=i)}var i=e.Promise,a=n.isFunction;r.polyfill=o}),e("promise/promise",["./config","./utils","./all","./race","./resolve","./reject","./asap","exports"],function(e,t,n,r,o,i,a,u){"use strict";function s(e){if(!k(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof s))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._subscribers=[],c(e,this)}function c(e,t){function n(e){p(t,e)}function r(e){v(t,e)}try{e(n,r)}catch(o){r(o)}}function f(e,t,n,r){var o,i,a,u,s=k(n);if(s)try{o=n(r),a=!0}catch(c){u=!0,i=c}else o=r,a=!0;h(t,o)||(s&&a?p(t,o):u?v(t,i):e===I?p(t,o):e===O&&v(t,o))}function l(e,t,n,r){var o=e._subscribers,i=o.length;o[i]=t,o[i+I]=n,o[i+O]=r}function d(e,t){for(var n,r,o=e._subscribers,i=e._detail,a=0;a<o.length;a+=3)n=o[a],r=o[a+t],f(t,n,r,i);e._subscribers=null}function h(e,t){var n,r=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(w(t)&&(r=t.then,k(r)))return r.call(t,function(r){return n?!0:(n=!0,void(t!==r?p(e,r):m(e,r)))},function(t){return n?!0:(n=!0,void v(e,t))}),!0}catch(o){return n?!0:(v(e,o),!0)}return!1}function p(e,t){e===t?m(e,t):h(e,t)||m(e,t)}function m(e,t){e._state===M&&(e._state=T,e._detail=t,g.async(b,e))}function v(e,t){e._state===M&&(e._state=T,e._detail=t,g.async(y,e))}function b(e){d(e,e._state=I)}function y(e){d(e,e._state=O)}var g=e.config,w=(e.configure,t.objectOrFunction),k=t.isFunction,_=(t.now,n.all),x=r.race,S=o.resolve,E=i.reject,P=a.asap;g.async=P;var M=void 0,T=0,I=1,O=2;s.prototype={constructor:s,_state:void 0,_detail:void 0,_subscribers:void 0,then:function(e,t){var n=this,r=new this.constructor(function(){});if(this._state){var o=arguments;g.async(function(){f(n._state,r,o[n._state-1],n._detail)})}else l(this,r,e,t);return r},"catch":function(e){return this.then(null,e)}},s.all=_,s.race=x,s.resolve=S,s.reject=E,u.Promise=s}),e("promise/race",["./utils","exports"],function(e,t){"use strict";function n(e){var t=this;if(!r(e))throw new TypeError("You must pass an array to race.");return new t(function(t,n){for(var r,o=0;o<e.length;o++)r=e[o],r&&"function"==typeof r.then?r.then(t,n):t(r)})}var r=e.isArray;t.race=n}),e("promise/reject",["exports"],function(e){"use strict";function t(e){var t=this;return new t(function(t,n){n(e)})}e.reject=t}),e("promise/resolve",["exports"],function(e){"use strict";function t(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=this;return new t(function(t){t(e)})}e.resolve=t}),e("promise/utils",["exports"],function(e){"use strict";function t(e){return n(e)||"object"==typeof e&&null!==e}function n(e){return"function"==typeof e}function r(e){return"[object Array]"===Object.prototype.toString.call(e)}var o=Date.now||function(){return(new Date).getTime()};e.objectOrFunction=t,e.isFunction=n,e.isArray=r,e.now=o}),r("promise/polyfill").polyfill()}(),function(t,n){e.exports=n()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var o=function(e){function t(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function o(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(d(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}function i(e){for(var t in u)if(u.hasOwnProperty(t)&&u[t]===e)return!0;return!1}var a={},u={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},s=[u.INDEXEDDB,u.WEBSQL,u.LOCALSTORAGE],c=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],f={description:"",driver:s.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},l=function(e){var t={};return t[u.INDEXEDDB]=!!function(){try{var t=t||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB;return"undefined"!=typeof e.openDatabase&&e.navigator&&e.navigator.userAgent&&/Safari/.test(e.navigator.userAgent)&&!/Chrome/.test(e.navigator.userAgent)?!1:t&&"function"==typeof t.open&&"undefined"!=typeof e.IDBKeyRange}catch(n){return!1}}(),t[u.WEBSQL]=!!function(){try{return e.openDatabase}catch(t){return!1}}(),t[u.LOCALSTORAGE]=!!function(){try{return e.localStorage&&"setItem"in e.localStorage&&e.localStorage.setItem}catch(t){return!1}}(),t}(e),d=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},h=function(){function e(t){r(this,e),this.INDEXEDDB=u.INDEXEDDB,this.LOCALSTORAGE=u.LOCALSTORAGE,this.WEBSQL=u.WEBSQL,this._defaultConfig=o({},f),this._config=o({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return e.prototype.config=function(e){if("object"==typeof e){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e)"storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),this._config[t]=e[t];return"driver"in e&&e.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new Promise(function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),u=new Error("Custom driver name already in use: "+e._driver);if(!e._driver)return void n(o);if(i(e._driver))return void n(u);for(var s=c.concat("_initStorage"),f=0;f<s.length;f++){var d=s[f];if(!d||!e[d]||"function"!=typeof e[d])return void n(o)}var h=Promise.resolve(!0);"_support"in e&&(h=e._support&&"function"==typeof e._support?e._support():Promise.resolve(!!e._support)),h.then(function(n){l[r]=n,a[r]=e,t()},n)}catch(p){n(p)}});return r.then(t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,r){var o=this,u=function(){if(i(e))switch(e){case o.INDEXEDDB:return new Promise(function(e,t){e(n(1))});case o.LOCALSTORAGE:return new Promise(function(e,t){e(n(2))});case o.WEBSQL:return new Promise(function(e,t){e(n(4))})}else if(a[e])return Promise.resolve(a[e]);return Promise.reject(new Error("Driver not found."))}();return u.then(t,r),u},e.prototype.getSerializer=function(e){var t=new Promise(function(e,t){e(n(3))});return e&&"function"==typeof e&&t.then(function(t){e(t)}),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return n.then(e,e),n},e.prototype.setDriver=function(e,t,n){function r(){i._config.driver=i.driver()}function o(e){return function(){function t(){for(;n<e.length;){var o=e[n];return n++,i._dbInfo=null,i._ready=null,i.getDriver(o).then(function(e){return i._extend(e),r(),i._ready=i._initStorage(i._config),i._ready})["catch"](t)}r();var a=new Error("No available storage method found.");return i._driverSet=Promise.reject(a),i._driverSet}var n=0;return t()}}var i=this;d(e)||(e=[e]);var a=this._getSupportedDrivers(e),u=null!==this._driverSet?this._driverSet["catch"](function(){return Promise.resolve()}):Promise.resolve();return this._driverSet=u.then(function(){var e=a[0];return i._dbInfo=null,i._ready=null,i.getDriver(e).then(function(e){i._driver=e._driver,r(),i._wrapLibraryMethodsWithReady(),i._initDriver=o(a)})})["catch"](function(){r();var e=new Error("No available storage method found.");return i._driverSet=Promise.reject(e),i._driverSet}),this._driverSet.then(t,n),this._driverSet},e.prototype.supports=function(e){return!!l[e]},e.prototype._extend=function(e){o(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;r>n;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0;e<c.length;e++)t(this,c[e])},e.prototype.createInstance=function(t){return new e(t)},e}();return new h}("undefined"!=typeof window?window:self);t["default"]=o,e.exports=t["default"]},function(e,t){"use strict";t.__esModule=!0;var n=function(e){function t(t,n){t=t||[],n=n||{};try{return new Blob(t,n)}catch(r){if("TypeError"!==r.name)throw r;for(var o=e.BlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder||e.WebKitBlobBuilder,i=new o,a=0;a<t.length;a+=1)i.append(t[a]);return i.getBlob(n.type)}}function n(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;t>o;o++)r[o]=e.charCodeAt(o);return n}function r(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e),r.withCredentials=!0,r.responseType="arraybuffer",r.onreadystatechange=function(){return 4===r.readyState?200===r.status?t({response:r.response,type:r.getResponseHeader("Content-Type")}):void n({status:r.status,response:r.response}):void 0},r.send()})}function o(e){return new Promise(function(n,o){var i=t([""],{type:"image/png"}),a=e.transaction([I],"readwrite");a.objectStore(I).put(i,"key"),a.oncomplete=function(){var t=e.transaction([I],"readwrite"),i=t.objectStore(I).get("key");i.onerror=o,i.onsuccess=function(e){var t=e.target.result,o=URL.createObjectURL(t);r(o).then(function(e){n(!(!e||"image/png"!==e.type))},function(){n(!1)}).then(function(){URL.revokeObjectURL(o)})}},a.onerror=a.onabort=o})["catch"](function(){return!1})}function i(e){return"boolean"==typeof M?Promise.resolve(M):o(e).then(function(e){return M=e})}function a(e){return new Promise(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function u(e){var r=n(atob(e.data));return t([r],{type:e.type})}function s(e){return e&&e.__local_forage_encoded_blob}function c(e){var t=this,n=t._initReady().then(function(){var e=T[t._dbInfo.name];return e&&e.dbReady?e.dbReady:void 0});return n.then(e,e),n}function f(e){var t=T[e.name],n={};n.promise=new Promise(function(e){n.resolve=e}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function l(e){var t=T[e.name],n=t.deferredOperations.pop();n&&n.resolve()}function d(e){function t(){return Promise.resolve()}var n=this,r={db:null};if(e)for(var o in e)r[o]=e[o];T||(T={});var i=T[r.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},T[r.name]=i),i.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=c);for(var a=[],u=0;u<i.forages.length;u++){var s=i.forages[u];s!==n&&a.push(s._initReady()["catch"](t))}var f=i.forages.slice(0);return Promise.all(a).then(function(){return r.db=i.db,h(r)}).then(function(e){return r.db=e,v(r,n._defaultConfig.version)?p(r):e}).then(function(e){r.db=i.db=e,n._dbInfo=r;for(var t=0;t<f.length;t++){var o=f[t];o!==n&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})}function h(e){return m(e,!1)}function p(e){return m(e,!0)}function m(t,n){return new Promise(function(r,o){if(t.db){if(!n)return r(t.db);f(t),t.db.close()}var i=[t.name];n&&i.push(t.version);var a=P.open.apply(P,i);n&&(a.onupgradeneeded=function(n){var r=a.result;try{r.createObjectStore(t.storeName),n.oldVersion<=1&&r.createObjectStore(I)}catch(o){if("ConstraintError"!==o.name)throw o;e.console.warn('The database "'+t.name+'" has been upgraded from version '+n.oldVersion+" to version "+n.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),a.onerror=function(){o(a.error)},a.onsuccess=function(){r(a.result),l(t)}})}function v(t,n){if(!t.db)return!0;var r=!t.db.objectStoreNames.contains(t.storeName),o=t.version<t.db.version,i=t.version>t.db.version;if(o&&(t.version!==n&&e.console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),i||r){if(r){var a=t.db.version+1;a>t.version&&(t.version=a)}return!0}return!1}function b(t,n){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=new Promise(function(e,n){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.get(t);a.onsuccess=function(){var t=a.result;void 0===t&&(t=null),s(t)&&(t=u(t)),e(t)},a.onerror=function(){n(a.error)}})["catch"](n)});return E(o,n),o}function y(e,t){var n=this,r=new Promise(function(t,r){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.openCursor(),c=1;a.onsuccess=function(){var n=a.result;if(n){var r=n.value;s(r)&&(r=u(r));var o=e(r,n.key,c++);void 0!==o?t(o):n["continue"]()}else t()},a.onerror=function(){r(a.error)}})["catch"](r)});return E(r,t),r}function g(t,n,r){var o=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var u=new Promise(function(e,r){var u;o.ready().then(function(){return u=o._dbInfo,n instanceof Blob?i(u.db).then(function(e){return e?n:a(n)}):n}).then(function(n){var o=u.db.transaction(u.storeName,"readwrite"),i=o.objectStore(u.storeName);null===n&&(n=void 0),o.oncomplete=function(){void 0===n&&(n=null),e(n)},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;r(e)};var a=i.put(n,t)})["catch"](r)});return E(u,r),u}function w(t,n){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=new Promise(function(e,n){r.ready().then(function(){var o=r._dbInfo,i=o.db.transaction(o.storeName,"readwrite"),a=i.objectStore(o.storeName),u=a["delete"](t);i.oncomplete=function(){e()},i.onerror=function(){n(u.error)},i.onabort=function(){var e=u.error?u.error:u.transaction.error;n(e)}})["catch"](n)});return E(o,n),o}function k(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo,o=r.db.transaction(r.storeName,"readwrite"),i=o.objectStore(r.storeName),a=i.clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}})["catch"](n)});return E(n,e),n}function _(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),i=o.count();i.onsuccess=function(){e(i.result)},i.onerror=function(){n(i.error)}})["catch"](n)});return E(n,e),n}function x(e,t){var n=this,r=new Promise(function(t,r){return 0>e?void t(null):void n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=!1,u=i.openCursor();u.onsuccess=function(){var n=u.result;return n?void(0===e?t(n.key):a?t(n.key):(a=!0,n.advance(e))):void t(null)},u.onerror=function(){r(u.error)}})["catch"](r)});return E(r,t),r}function S(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),i=o.openCursor(),a=[];i.onsuccess=function(){var t=i.result;return t?(a.push(t.key),void t["continue"]()):void e(a)},i.onerror=function(){n(i.error)}})["catch"](n)});return E(n,e),n}function E(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var P=P||e.indexedDB||e.webkitIndexedDB||e.mozIndexedDB||e.OIndexedDB||e.msIndexedDB;if(P){var M,T,I="local-forage-detect-blob-support",O={_driver:"asyncStorage",_initStorage:d,iterate:y,getItem:b,setItem:g,removeItem:w,clear:k,length:_,key:x,keys:S};return O}}("undefined"!=typeof window?window:self);t["default"]=n,e.exports=t["default"]},function(e,t,n){"use strict";t.__esModule=!0;var r=function(e){function t(e){var t=this,r={};if(e)for(var o in e)r[o]=e[o];return r.keyPrefix=r.name+"/",r.storeName!==t._defaultConfig.storeName&&(r.keyPrefix+=r.storeName+"/"),t._dbInfo=r,new Promise(function(e,t){e(n(3))}).then(function(e){return r.serializer=e,Promise.resolve()})}function r(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=d.length-1;n>=0;n--){var r=d.key(n);0===r.indexOf(e)&&d.removeItem(r)}});return l(n,e),n}function o(t,n){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=r.ready().then(function(){var e=r._dbInfo,n=d.getItem(e.keyPrefix+t);return n&&(n=e.serializer.deserialize(n)),n});return l(o,n),o}function i(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,i=d.length,a=1,u=0;i>u;u++){var s=d.key(u);if(0===s.indexOf(r)){var c=d.getItem(s);if(c&&(c=t.serializer.deserialize(c)),c=e(c,s.substring(o),a++),void 0!==c)return c}}});return l(r,t),r}function a(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=d.key(e)}catch(o){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return l(r,t),r}function u(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=d.length,r=[],o=0;n>o;o++)0===d.key(o).indexOf(e.keyPrefix)&&r.push(d.key(o).substring(e.keyPrefix.length));return r});return l(n,e),n}function s(e){var t=this,n=t.keys().then(function(e){return e.length});return l(n,e),n}function c(t,n){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=r.ready().then(function(){var e=r._dbInfo;d.removeItem(e.keyPrefix+t)});return l(o,n),o}function f(t,n,r){var o=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=o.ready().then(function(){void 0===n&&(n=null);var e=n;return new Promise(function(r,i){var a=o._dbInfo;a.serializer.serialize(n,function(n,o){if(o)i(o);else try{d.setItem(a.keyPrefix+t,n),r(e)}catch(u){"QuotaExceededError"!==u.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==u.name||i(u),i(u)}})})});return l(i,r),i}function l(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var d=null;try{if(!(e.localStorage&&"setItem"in e.localStorage))return;d=e.localStorage}catch(h){return}var p={_driver:"localStorageWrapper",_initStorage:t,iterate:i,getItem:o,setItem:f,removeItem:c,clear:r,length:s,key:a,keys:u};return p}("undefined"!=typeof window?window:self);t["default"]=r,e.exports=t["default"]},function(e,t){"use strict";t.__esModule=!0;var n=function(e){function t(t,n){t=t||[],n=n||{};try{return new Blob(t,n)}catch(r){if("TypeError"!==r.name)throw r;for(var o=e.BlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder||e.WebKitBlobBuilder,i=new o,a=0;a<t.length;a+=1)i.append(t[a]);return i.getBlob(n.type)}}function n(e,t){var n="";if(e&&(n=e.toString()),e&&("[object ArrayBuffer]"===e.toString()||e.buffer&&"[object ArrayBuffer]"===e.buffer.toString())){var r,o=c;e instanceof ArrayBuffer?(r=e,o+=l):(r=e.buffer,"[object Int8Array]"===n?o+=h:"[object Uint8Array]"===n?o+=p:"[object Uint8ClampedArray]"===n?o+=m:"[object Int16Array]"===n?o+=v:"[object Uint16Array]"===n?o+=y:"[object Int32Array]"===n?o+=b:"[object Uint32Array]"===n?o+=g:"[object Float32Array]"===n?o+=w:"[object Float64Array]"===n?o+=k:t(new Error("Failed to get type for BinaryArray"))),t(o+i(r))}else if("[object Blob]"===n){var a=new FileReader;a.onload=function(){var n=u+e.type+"~"+i(this.result);t(c+d+n)},a.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),t(null,s)}}function r(e){if(e.substring(0,f)!==c)return JSON.parse(e);var n,r=e.substring(_),i=e.substring(f,_);if(i===d&&s.test(r)){var a=r.match(s);n=a[1],r=r.substring(a[0].length)}var u=o(r);switch(i){case l:return u;case d:return t([u],{type:n});case h:return new Int8Array(u);case p:return new Uint8Array(u);case m:return new Uint8ClampedArray(u);case v:return new Int16Array(u);case y:return new Uint16Array(u);case b:return new Int32Array(u);case g:return new Uint32Array(u);case w:return new Float32Array(u);case k:return new Float64Array(u);default:throw new Error("Unkown type: "+i)}}function o(e){var t,n,r,o,i,u=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(u--,"="===e[e.length-2]&&u--);var f=new ArrayBuffer(u),l=new Uint8Array(f);for(t=0;s>t;t+=4)n=a.indexOf(e[t]),r=a.indexOf(e[t+1]),o=a.indexOf(e[t+2]),i=a.indexOf(e[t+3]),l[c++]=n<<2|r>>4,l[c++]=(15&r)<<4|o>>2,l[c++]=(3&o)<<6|63&i;return f}function i(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=a[n[t]>>2],r+=a[(3&n[t])<<4|n[t+1]>>4],r+=a[(15&n[t+1])<<2|n[t+2]>>6],r+=a[63&n[t+2]];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="~~local_forage_type~",s=/^~~local_forage_type~([^~]+)~/,c="__lfsc__:",f=c.length,l="arbf",d="blob",h="si08",p="ui08",m="uic8",v="si16",b="si32",y="ur16",g="ui32",w="fl32",k="fl64",_=f+l.length,x={serialize:n,deserialize:r,stringToBuffer:o,bufferToString:i};return x}("undefined"!=typeof window?window:self);t["default"]=n,e.exports=t["default"]},function(e,t,n){"use strict";t.__esModule=!0;var r=function(e){function t(e){var t=this,r={db:null};if(e)for(var o in e)r[o]="string"!=typeof e[o]?e[o].toString():e[o];var i=new Promise(function(e,n){try{r.db=d(r.name,String(r.version),r.description,r.size)}catch(o){return n(o)}r.db.transaction(function(o){o.executeSql("CREATE TABLE IF NOT EXISTS "+r.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){t._dbInfo=r,e()},function(e,t){n(t)})})});return new Promise(function(e,t){e(n(3))}).then(function(e){return r.serializer=e,i})}function r(t,n){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=new Promise(function(e,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){r.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),e(r)},function(e,t){n(t)})})})["catch"](n)});return l(o,n),o}function o(e,t){var n=this,r=new Promise(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName,[],function(n,r){for(var i=r.rows,a=i.length,u=0;a>u;u++){var s=i.item(u),c=s.value;if(c&&(c=o.serializer.deserialize(c)),c=e(c,s.key,u+1),void 0!==c)return void t(c)}t()},function(e,t){r(t)})})})["catch"](r)});return l(r,t),r}function i(t,n,r){var o=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=new Promise(function(e,r){o.ready().then(function(){void 0===n&&(n=null);var i=n,a=o._dbInfo;a.serializer.serialize(n,function(n,o){o?r(o):a.db.transaction(function(o){o.executeSql("INSERT OR REPLACE INTO "+a.storeName+" (key, value) VALUES (?, ?)",[t,n],function(){e(i)},function(e,t){r(t)})},function(e){e.code===e.QUOTA_ERR&&r(e)})})})["catch"](r)});return l(i,r),i}function a(t,n){var r=this;"string"!=typeof t&&(e.console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=new Promise(function(e,n){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){r.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[t],function(){e()},function(e,t){n(t)})})})["catch"](n)});return l(o,n),o}function u(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})})["catch"](n)});return l(n,e),n}function s(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})})["catch"](n)});return l(n,e),n}function c(e,t){var n=this,r=new Promise(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})})["catch"](r)});return l(r,t),r}function f(e){var t=this,n=new Promise(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){t.executeSql("SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)},function(e,t){n(t)})})})["catch"](n)});return l(n,e),n}function l(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var d=e.openDatabase;if(d){var h={_driver:"webSQLStorage",_initStorage:t,iterate:o,getItem:r,setItem:i,removeItem:a,clear:u,length:s,key:c,keys:f};return h}}("undefined"!=typeof window?window:self);t["default"]=r,e.exports=t["default"]}])})}).call(t,function(){return this}(),n(31))},function(e,t){function n(){c=!1,a.length?s=a.concat(s):f=-1,s.length&&r()}function r(){if(!c){var e=setTimeout(n);c=!0;for(var t=s.length;t;){for(a=s,s=[];++f<t;)a&&a[f].run();f=-1,t=s.length}a=null,c=!1,clearTimeout(e)}}function o(e,t){this.fun=e,this.array=t}function i(){}var a,u=e.exports={},s=[],c=!1,f=-1;u.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];s.push(new o(e,t)),1!==s.length||c||setTimeout(r,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=i,u.addListener=i,u.once=i,u.off=i,u.removeListener=i,u.removeAllListeners=i,u.emit=i,u.binding=function(e){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(e){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e){var t=parseInt(e.dataset.lcCount),n=parseInt(e.dataset.lcMy),r=(0,_["default"])((0,w["default"])(e,".comments"),".bf2-likecomm-cont").reduce(function(e,t){var n=d(e,2),r=n[0],o=n[1];return[r+parseInt(t.dataset.lcCount),o+parseInt(t.dataset.lcMy)]},[0,0]),o=d(r,2),i=o[0],a=o[1];t-=i,n-=a,e.querySelector(".bf2-likecomm-count").innerHTML=t.toString(10),e.classList.toggle("bf2-likecomm-liked",t>0),e.classList.toggle("bf2-likecomm-with-my",n>0),e.querySelector(".bf2-likecomm-count-label").innerHTML=1==t?" like":" likes"}function a(){(0,_["default"])(document.body,".bf2-likecomm-cont, .bf2-likecomm-folded",function(e){var t=e.dataset;t.commId?u(t.commId):t.postId&&s(t.postId)})}function u(e){A.push(e),A.length>=L?c():(N&&clearTimeout(N),N=setTimeout(c,R))}function s(e){j.push(e),j.length>=L?c():(N&&clearTimeout(N),N=setTimeout(c,R))}function c(){A.length>0&&(I.allLikes(A),A.length=0),j.length>0&&(I.allPostsLikes(j),j.length=0),N&&(clearTimeout(N),N=null)}function f(e,t){C.innerHTML="",C.appendChild(t),e.appendChild(C)}function l(){C.parentNode&&C.parentNode.removeChild(C)}var d=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){o=!0,i=s}finally{try{!r&&u["return"]&&u["return"]()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},p=n(5),m=n(33),v=r(m),b=n(9),y=r(b),g=n(21),w=r(g),k=n(6),_=r(k),x=n(13),S=r(x),E=n(7),P=r(E);n(35);var M=(0,p.registerModule)("likecomm"),T=(0,p.registerModule)("likecomm-auth",!1),I=new v["default"];M.init(function(e){I.anonymous=!e.isModuleEnabled(T),!function(){var e=!0;I.onConnect(function(){e?e=!1:a()}),I.watch()}(),document.body.classList.toggle("bf2-likecomm-anon",I.anonymous),document.body.addEventListener("click",function(e){if(!I.anonymous&&(0,P["default"])(e.target,".bf2-likecomm-act")){var t=(0,w["default"])(e.target,".bf2-likecomm-cont"),n=(0,w["default"])(t,".comment").dataset.commId,r=(0,w["default"])(t,".post").dataset.postId,i=t.querySelector(".bf2-likecomm-count"),a=parseInt(i.innerHTML);if(!n)return;t.classList.contains("bf2-likecomm-with-my")?(I.unlike(n),i.innerHTML=(a-1).toString(10),t.classList.toggle("bf2-likecomm-liked",a>1),t.classList.remove("bf2-likecomm-with-my")):(I.like(n,r),i.innerHTML=(a+1).toString(10),t.classList.add("bf2-likecomm-liked"),t.classList.add("bf2-likecomm-with-my"))}if((0,P["default"])(e.target,".bf2-likecomm-count")){var u=function(){var t=(0,w["default"])(e.target,".comment").dataset.commId;if(!t)return{v:void 0};var n=(0,S["default"])("",(0,S["default"])("em","Loading…"));f((0,w["default"])(e.target,".bf2-likecomm-cont"),n),I.likes(t).then(function(){var e=o(regeneratorRuntime.mark(function t(e){var r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!=e.length){t.next=3;break}return n.innerHTML="<em>Not available.</em>",t.abrupt("return");case 3:return n.innerHTML="",t.next=6,y["default"].ready;case 6:r=t.sent,o=e.some(function(e){return e===r.me}),e.sort(),e=e.filter(function(e){return e!==r.me}),o&&e.unshift(r.me),e.forEach(function(e){n.appendChild((0,S["default"])("",(0,S["default"])("a.bf2-user-link",{href:"/"+e},e)))});case 12:case"end":return t.stop()}},t,void 0)}));return function(t){return e.apply(this,arguments)}}())}();if("object"===("undefined"==typeof u?"undefined":h(u)))return u.v}(0,w["default"])(e.target,".bf2-likecomm-cont")||l()})}),M.watch(".comments .comment .comment-icon",function(e){if(e.id){var t=(0,w["default"])(e,".comment");
if(!t.querySelector("textarea")){var n=e.id.match(/^comment-(.+)/)[1];t.dataset.commId=n,u(n),t.appendChild((0,S["default"])(".bf2-likecomm-shift",(0,S["default"])(".bf2-likecomm-cont",{id:"likecomm-"+n,"data-lc-updated":"0","data-lc-count":"0","data-lc-my":"0","data-comm-id":n},(0,S["default"])("span.bf2-likecomm-count","0"),(0,S["default"])("i.fa.fa-heart.bf2-likecomm-act"))))}}}),M.watch(".comments .comment .more-comments-link",function(e){var t=(0,w["default"])(e,".post").dataset.postId;s(t),e.appendChild((0,S["default"])(".bf2-likecomm-folded",{id:"lc-post-"+t,"data-lc-updated":"0","data-lc-count":"0","data-lc-my":"0","data-post-id":t}," with ",(0,S["default"])("span.bf2-likecomm-count","0"),(0,S["default"])("i.fa.fa-heart"),(0,S["default"])("span.bf2-likecomm-count-label"," likes")))});var O=0;I.onLike(function(e){var t=e.id,n=e.post_id,r=e.likes,o=e.my_likes,a=e.updated,u=t?document.getElementById("likecomm-"+t):null,c=n?document.getElementById("lc-post-"+n):null;if(a>O&&(O=a),t){if(u){var f=u.dataset;parseInt(f.lcUpdated)<a&&(u.querySelector(".bf2-likecomm-count").innerHTML=r.toString(10),u.classList.toggle("bf2-likecomm-liked",r>0),u.classList.toggle("bf2-likecomm-with-my",o>0),f.lcUpdated=a.toString(10),f.lcCount=r.toString(10),f.lcMy=o.toString(10))}c&&(parseInt(c.dataset.lcUpdated)<a?s(n):i(c))}else c&&parseInt(c.dataset.lcUpdated)<a&&(c.dataset.lcCount=r,c.dataset.lcMy=o,c.dataset.lcUpdated=a.toString(10),i(c))});var L=50,R=500,A=[],j=[],N=null,C=(0,S["default"])(".bf2-likecomm-list")},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),u=n(8),s=n(34),c=r(s),f="https://davidmz.me/frfrfr/likecomm",l="wss://davidmz.me/frfrfr/likecomm/watch",d=function(){function e(){i(this,e),this.anonymous=!0,this.listeners=[],this.connectListeners=[]}return a(e,[{key:"like",value:function(e,t){return this.anonymous?Promise.reject("Attempt to like in anonymous mode"):this.req(f+"/like?comm_id="+encodeURIComponent(e)+"&post_id="+encodeURIComponent(t),{method:"POST"})}},{key:"unlike",value:function(e){return this.anonymous?Promise.reject("Attempt to unlike in anonymous mode"):this.req(f+"/unlike?comm_id="+encodeURIComponent(e),{method:"POST"})}},{key:"allLikes",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.req(f+"/all-likes",{method:"POST",body:JSON.stringify(e)});case 2:return t=n.sent,t.forEach(function(e){return r.listeners.forEach(function(t){return t(e)})}),n.abrupt("return",null);case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"allPostsLikes",value:function(){function e(e){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.req(f+"/all-posts-likes",{method:"POST",body:JSON.stringify(e)});case 2:return t=n.sent,t.forEach(function(e){return r.listeners.forEach(function(t){return t(e)})}),n.abrupt("return",null);case 5:case"end":return n.stop()}},n,this)}));return e}()},{key:"likes",value:function(e){return this.req(f+"/likes?comm_id="+encodeURIComponent(e))}},{key:"watch",value:function(){var e=this,t=new c["default"](l);this.anonymous||(t.prepareConnect=o(regeneratorRuntime.mark(function n(){var r;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.req(f+"/auth",{method:"POST"});case 2:r=n.sent,t.url=l+"?auth="+encodeURIComponent(r);case 4:case"end":return n.stop()}},n,e)}))),t.onMessage=function(t){return e.listeners.forEach(function(e){return e(t)})},t.onConnect=function(){return e.connectListeners.forEach(function(e){return e()})},t.connect()}},{key:"onLike",value:function(e){this.listeners.push(e)}},{key:"onConnect",value:function(e){this.connectListeners.push(e)}},{key:"req",value:function(){function e(e,n){return t.apply(this,arguments)}var t=o(regeneratorRuntime.mark(function n(e){var t,r,o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o.mode="cors",this.anonymous||(o.headers||(o.headers={}),o.headers["X-Authentication-Token"]=u.authToken),n.next=4,fetch(e,o);case 4:return n.next=6,n.sent.json();case 6:if(t=n.sent,"error"!=t.status){n.next=11;break}throw r=new Error(t.msg),r.code=t.code,r;case 11:return n.abrupt("return",t.data);case 12:case"end":return n.stop()}},n,this)}));return e}()}]),e}();t["default"]=d},function(e,t){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0];r(this,e),this.url=t,this.ws=null,this.onMessage=function(){},this.prepareConnect=function(){return Promise.resolve()},this.onConnect=function(){},this._sendBuf=[],this._reconnectTimer=null,this._reconnectTimeout=e.minReconnectTimeout}return o(e,[{key:"send",value:function(e){this.ws&&this.ws.readyState==WebSocket.OPEN?this.ws.send(e):this._sendBuf.push(e)}},{key:"connect",value:function(){function t(){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function o(){var t=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return this._reconnectTimer=null,this._reconnectTimeout*=1.5,this._reconnectTimeout>e.maxReconnectTimeout&&(this._reconnectTimeout=e.maxReconnectTimeout),n.prev=3,n.next=6,this.prepareConnect();case 6:this.ws=new WebSocket(this.url),this.ws.onclose=function(){return t._reconnect()},this.ws.onerror=function(){return t._reconnect()},this.ws.onmessage=function(e){return t.onMessage(JSON.parse(e.data))},this.ws.onopen=function(){return t._onopen()},n.next=17;break;case 13:n.prev=13,n.t0=n["catch"](3),console.warn("WS prepare connect error: "+n.t0.message),this._reconnect();case 17:case"end":return n.stop()}},o,this,[[3,13]])}));return t}()},{key:"_onopen",value:function(){var t=this;this._reconnectTimeout=e.minReconnectTimeout,this._sendBuf.forEach(function(e){return t.ws.send(e)}),this._sendBuf=[],this.onConnect()}},{key:"_reconnect",value:function(){var e=this;this.ws.readyState!=WebSocket.CONNECTING&&this.ws.readyState!=WebSocket.OPEN||this.ws.close(),null===this._reconnectTimer&&(this._reconnectTimer=setTimeout(function(){return e.connect()},this._reconnectTimeout))}}]),e}();i.minReconnectTimeout=1e3,i.maxReconnectTimeout=2e4,t["default"]=i},function(e,t,n){var r=n(36);"string"==typeof r&&(r=[[e.id,r,""]]);n(4)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(3)(),t.push([e.id,'.comment{position:relative}.bf2-likecomm-shift{position:absolute;top:0;left:-6px}.bf2-likecomm-cont{position:absolute;top:1px;right:0;font-size:12px;color:#999;opacity:0;transition:opacity .5s;white-space:nowrap}.bf2-likecomm-cont.bf2-likecomm-liked{opacity:1}.comment:hover .bf2-likecomm-cont{opacity:1;transition:opacity .25s}.bf2-likecomm-anon .bf2-likecomm-cont{display:none}.bf2-likecomm-anon .bf2-likecomm-cont.bf2-likecomm-liked{display:block}.bf2-likecomm-count{margin-right:.3em;display:none;cursor:pointer}.bf2-likecomm-count:hover{text-decoration:underline}.bf2-likecomm-liked .bf2-likecomm-count{display:inline}.bf2-likecomm-act{position:relative;cursor:pointer;color:#ffce5b;transition:transform .25s}.bf2-likecomm-anon .bf2-likecomm-act{cursor:default}.bf2-likecomm-act:after{content:"";visibility:hidden;transition:visibility 0s}.bf2-likecomm-act:hover{transform:scale(1.5)}.bf2-likecomm-act:hover:after{content:"Like";position:absolute;top:-9px;left:-1px;font:8px Helvetica Neue,Helvetica,Arial,sans-serif;white-space:nowrap;visibility:visible;transition:visibility 0s .25s;background:hsla(0,0%,100%,.75);color:#999}.bf2-likecomm-with-my .bf2-likecomm-act:hover:after{content:"Un-like";left:-6px}.bf2-likecomm-anon .bf2-likecomm-act:hover{transform:none}.bf2-likecomm-anon .bf2-likecomm-act:hover:after{content:""}.bf2-likecomm-act .bf2-likecomm-act:after{content:"Like";position:absolute;top:-14px;left:-5px;font:12px Arial}.bf2-likecomm-cont.bf2-likecomm-with-my{color:#d00}.bf2-likecomm-cont.bf2-likecomm-with-my .bf2-likecomm-act{color:#e66}.bf2-likecomm-list{position:absolute;border:1px solid #999;color:#000;padding:.5em;background:#fff;box-shadow:1px 1px 10px rgba(0,0,0,.3);min-width:100px;max-height:200px;overflow:auto;top:20px;left:-4px;z-index:1}.bf2-likecomm-dash{position:absolute;top:-1px;right:-19px;color:#ddd}.bf2-likecomm-folded{display:none}.bf2-likecomm-folded.bf2-likecomm-liked{display:inline}.bf2-likecomm-folded .fa-heart{font-size:12px;color:#ffce5b}.bf2-likecomm-folded.bf2-likecomm-with-my .fa-heart{color:#e66}.bf2-likecomm-folded.bf2-likecomm-with-my .bf2-likecomm-count{color:#d00}',""])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var o=n(5),i=n(21),a=r(i),u=n(6),s=r(u),c=(0,o.registerModule)("cloud-clicks");c.init(function(){document.addEventListener("click",function(e){var t=(0,a["default"])(e.target,".comment-icon",!0),n=(0,a["default"])(t,".comment");if(t&&n&&0==e.button&&t.id&&!n.querySelector("textarea")){e.stopPropagation(),e.stopImmediatePropagation(),e.preventDefault();var r="";if(e.metaKey||e.ctrlKey){for(var o=n.nextSibling,i=1;o;){var u=o.querySelector(".more-comments-link");if(u){var c=parseInt(u.textContent);isNaN(c)||(i+=c)}else{if(n.querySelector("textarea")||n.querySelector(".add-comment-link"))break;i++}o=o.nextSibling}2>i&&(i=2),r=new Array(i).join("^")}var f=n.querySelectorAll(".user-name-wrapper"),l=f[f.length-1].querySelector("a").getAttribute("href").substr(1),d=(0,a["default"])(n,".post"),h=d.querySelector(".comment-textarea"),p=!h;h||((0,s["default"])(d,".post-footer a").filter(function(e){return"Comment"==e.textContent}).forEach(function(e){return e.click()}),h=d.querySelector(".comment-textarea")),h&&(p&&(h.value=""),""!==r?h.value+=r+" "+(e.shiftKey?"this":""):l&&(h.value+="@"+l+" "),h.focus(),h.blur(),h.focus(),h.selectionStart=h.selectionEnd=h.value.length)}},!0)})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){return((new Date).getTime()-l)/d%1}function i(e){var t=document.querySelector(".bf2-moon");if(t){var n=t.querySelector(".bf2-moon-light"),r=50,o=r*Math.abs(Math.cos(2*Math.PI*e)),i=void 0;i=.25>e?"M 50 0 a "+o+" 50 0 0 1 0 100 a 50 50 0 0 0 0 -100 Z":.5>e?"M 50 0 a "+o+" 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z":.75>e?"M 50 0 a 50 50 0 0 0 0 100 a "+o+" 50 0 0 0 0 -100 Z":"M 50 0 a 50 50 0 0 0 0 100 a "+o+" 50 0 0 1 0 -100 Z",n.setAttribute("d",i),Math.abs(.5-e)<.05?t.parentNode.setAttribute("title","Achtung Vollmond!"):t.parentNode.removeAttribute("title")}}var a=n(5),u=n(13),s=r(u),c=(0,a.registerModule)("moon"),f='<svg class="bf2-moon" viewBox="-4 -4 108 108" xmlns="http://www.w3.org/2000/svg" version="1.1">\n        <circle class="bf2-moon-shadow" cx="50" cy="50" r="54"></circle>\n        <path class="bf2-moon-light" d="M 50 0 a 30 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z"></path>\n    </svg>';c.watch("h1",function(e){e.appendChild((0,s["default"])(".bf2-moon-cont")).innerHTML=f,i(o()),setInterval(function(){return i(o())},36e5)});var l=new Date("Thu Apr 07 2016 14:22:37 GMT+0300").getTime(),d=Math.round(2551442813.5680003)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(s){return void n(s)}return a.done?void e(u):Promise.resolve(u).then(function(e){return r("next",e)},function(e){return r("throw",e)})}return r("next")})}}var a=function(){var e=i(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return M=new g["default"]("bf2-switch-account-box"),M.showContent("<p>Loading…</p>"),e.next=4,u();case 4:M.contentEl.innerHTML=e.sent;case 5:case"end":return e.stop()}},t,this)}));return function(){return e.apply(this,arguments)}}(),u=function(){var e=i(regeneratorRuntime.mark(function t(){var e,n,r,o,a=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e="bf2-switch-dlg-",t.next=3,k["default"].ready;case 3:return n=t.sent,r=n.me,o=(0,v["default"])("form."+e+"new-form",(0,b.html)(c)),o.addEventListener("submit",function(e){e.preventDefault();var t=o.elements.username.value,n=o.elements.password.value;i(regeneratorRuntime.mark(function r(){var e,o,i;return regeneratorRuntime.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,fetch("/v1/session",{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:"username="+encodeURIComponent(t)+"&password="+encodeURIComponent(n)}).then(function(e){return e.json()});case 2:if(e=r.sent,!e.err){r.next=6;break}return alert(e.err),r.abrupt("return");case 6:return o=e.users.username,i=e.authToken,r.next=10,u();case 10:M.contentEl.innerHTML=r.sent;case 11:case"end":return r.stop()}},r,a)}))()}),t.t0=(0,b.html)(f,e),t.t1="."+e+"accounts",t.next=11,s();case 11:return t.t2=function(t){var n=t.username,o=(0,v["default"])("img."+e+"upic",{src:_.defaultPic});(0,_.getPic)(n).then(function(e){return o.src=e});var i=(0,v["default"])("."+e+"del",{title:"Remove from list"},(0,v["default"])("i.fa.fa-times-circle"));return(0,v["default"])("."+e+"account"+(n==r?".-current":""),{"data-username":n},o,n,i)},t.t3=t.sent.map(t.t2),t.t4=(0,v["default"])(t.t1,t.t3),t.t5=(0,b.html)(l,e),t.t6=o,t.abrupt("return",(0,v["default"])("",t.t0,t.t4,t.t5,t.t6));case 17:case"end":return t.stop()}},t,this)}));return function(){return e.apply(this,arguments)}}(),s=function(){var e=i(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P.get(E);case 2:if(e=t.sent){t.next=10;break}return t.next=6,k["default"].ready;case 6:t.t0=t.sent.me,t.t1=x.authToken,t.t2={username:t.t0,token:t.t1},e=[t.t2];case 10:return t.abrupt("return",e);case 11:case"end":return t.stop()}},t,this)}));return function(){return e.apply(this,arguments)}}(),c=o(['\n        <p>Please enter username and password of your other account:</p>\n        <p><input class="form-control" type="text" name="username" placeholder="Username" required></p>\n        <p><input class="form-control" type="password" name="password" placeholder="Password" required></p>\n        <p><button type="submit" class="btn btn-default">Add</button></p>\n        '],['\n        <p>Please enter username and password of your other account:</p>\n        <p><input class="form-control" type="text" name="username" placeholder="Username" required></p>\n        <p><input class="form-control" type="password" name="password" placeholder="Password" required></p>\n        <p><button type="submit" class="btn btn-default">Add</button></p>\n        ']),f=o(['<div class="','header">Switch account to:</div>'],['<div class="','header">Switch account to:</div>']),l=o(['<div class="','add-new"><a><i class="fa fa-plus"></i> Add new account</a></div>'],['<div class="','add-new"><a><i class="fa fa-plus"></i> Add new account</a></div>']),d=n(5),h=n(40),p=r(h),m=n(13),v=r(m),b=n(15),y=n(25),g=r(y),w=n(9),k=r(w),_=n(11),x=n(8),S=(0,d.registerModule)("switch-accounts"),E="bfAccounts-freefeed.net",P=null;S.init(function(){P=new p["default"]}),S.watch(".logged-in .avatar",function(e){e.appendChild((0,v["default"])(".bf2-switch-acc",{title:"Switch account"},(0,v["default"])("span.fa.fa-exchange"))).addEventListener("click",a)});var M=null},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(19),u=r(a),s="https://davidmz.github.io/BetterFeed2/storage.html?_="+Math.random(),c="https://davidmz.github.io",f=function(){function e(){o(this,e),this.iframe=document.createElement("iframe"),this.iframe.src=s,this.iframe.style.cssText="visibility: hidden;\n            position: absolute;\n            left: 0; top: 0;\n            height:0; width:0;\n            border: none;",document.body.appendChild(this.iframe),this.msg=new u["default"](this.iframe.contentWindow,c)}return i(e,[{key:"get",value:function(e){return this.msg.send("get",e)}},{key:"set",value:function(e,t){return this.msg.send("set",{key:e,value:t})}}]),e}();t["default"]=f}]);
//# sourceMappingURL=better-feed.min.js.map