!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(e){return void n(e)}return a.done?void e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e){var t=this;(0,s.startObserver)(e);var n=new b.default;n.on("getSettings",function(){return e.toJSON()}),n.on("saveSettings",function(){var e=o(regeneratorRuntime.mark(function e(n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l.default.ready;case 2:return r=e.sent,e.next=5,r.saveProps(new v.default(n));case 5:location.reload(!0);case 6:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}()),n.on("checkUpdates",a)}function a(){var e=Date.now(),t="v2.17.4";localStorage["bf2-next-update"]=e+36e5;var n=new XMLHttpRequest;n.open("GET","https://api.github.com/repos/davidmz/BetterFeed2/tags?page=1&per_page=1"),n.responseType="json",n.onload=function(){try{var r=n.response;if(1==r.length&&"name"in r[0]){var o=r[0].name;localStorage["bf2-version"]=o,localStorage["bf2-next-update"]=e+864e5,o!=t?confirm("Доступна новая версия: "+o+". Она будет установлена после перезагрузки страницы.\n\nПерезагрузить страницу сейчас?")&&location.reload(!0):alert("У вас установлена последняя версия ("+o+")")}}catch(e){}},n.send()}var u=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();n(1);var s=n(5),c=n(8),f=n(9),l=r(f),d=n(18),h=r(d),p=n(19),v=r(p),m=n(20),b=r(m);n(21),n(24),n(26),n(28),n(29),n(31),n(32),n(35),n(36),/^\/(attachments\/|files\/|bookmarklet|v\d\/)/.test(location.pathname)||(MutationObserver&&Promise?null===c.userId?console.error("Can not start BetterFeed: user not logged in"):"__BetterFeed"in window?console.warn("BetterFeed already started"):(window.__BetterFeed=!0,Promise.all([l.default.ready,h.default]).then(function(e){var t=u(e,1),n=t[0];i(new v.default(n.bf2Props))})):console.error("Can not start BetterFeed: MutationObserver & Promise not supported"))},function(e,t,n){var r=n(2);"string"==typeof r&&(r=[[e.id,r,""]]);n(4)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(3)(),t.push([e.id,'.bf2-lightbox-container{left:0;top:0;width:100%;height:100%;position:fixed;z-index:10}.bf2-lightbox-shadow{left:0;top:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;background-color:rgba(0,0,0,.5)}.bf2-lightbox-content{position:relative;border:1px solid #000;background-color:#ccc;box-shadow:0 0 50px rgba(0,0,0,.5)}.bf2-settings-lightbox .bf2-lightbox-content{width:90vw;height:90vh;max-width:800px}.bf2-settings-lightbox .bf2-lightbox-content iframe{left:0;top:0;width:100%;height:100%}.bf2-access-token-lightbox .bf2-lightbox-content{background-color:#fff;max-width:90vw;padding:2em}.bf2-access-token-lightbox .bf2-lightbox-content button{padding:.25em 2em;cursor:pointer}.bf2-access-token-lightbox .bf2-lightbox-content .bf2-access-token{word-wrap:break-word;font-family:monospace;color:#069;background-color:#eee;padding:1em}.bf2-green{padding:1em}.bf2-via-names{font-size:12px}.bf2-hide-aliens-cont{font-size:14px;font-weight:400;margin-left:1em;display:none}.bf2-homepage .bf2-hide-aliens-cont{display:inline}.bf2-hide-aliens .bf2-alien-post{display:none}.bf2-saving-settings-indicator{position:fixed;top:.66em;right:1em;background:#f66;color:#fff;padding:.25em 1em;border-radius:4px;z-index:100}.bf2-animated-gif{position:relative;display:inline-block}.bf2-animated-gif:after{content:"\\25B6   GIF";position:absolute;bottom:3px;right:4px;background-color:#069;color:#eee;font-weight:700;padding:.1em .4em;border-radius:3px;font-size:11px;line-height:normal}.arrow-span{padding:0 .2em}.bf2-moon{width:18px;height:18px;margin-left:4px;margin-bottom:10px}.bf2-moon-shadow{fill:#666}.bf2-moon-light{fill:#f5eed9}h1{float:left;position:relative}.bf2-moon-cont{position:absolute;top:0;right:-20px}.bf2-switch-acc{color:#ccc;cursor:pointer;text-align:center}.bf2-switch-acc:hover{background-color:#eee;color:#000}.bf2-switch-account-box .bf2-lightbox-content{width:360px;height:auto;cursor:auto;border:1px solid #000;box-shadow:1px 1px 10px rgba(0,0,0,.5);background-color:#fff;padding:1em}.bf2-switch-dlg-header{font-size:120%}.bf2-switch-dlg-accounts{margin:1em 0}.bf2-switch-dlg-account{cursor:pointer;font-weight:700;border:1px solid #ddd;margin:.5em 0;position:relative}.bf2-switch-dlg-account.-current,.bf2-switch-dlg-account:hover{background-color:#eee}.bf2-switch-dlg-account.-current{cursor:not-allowed}.bf2-switch-dlg-account.-current .bf2-switch-dlg-del{display:none}.bf2-switch-dlg-upic{width:50px;height:50px;margin-right:1em;border-right:1px solid #ddd}.bf2-switch-dlg-new-form{display:none}.bf2-switch-dlg-del{position:absolute;right:0;top:50%;width:20px;height:20px;line-height:20px;text-align:center;margin-top:-10px}.bf2-switch-dlg-del:hover{color:#c00}.box{clear:both}.bf2-lightboxed-images .image-attachments a{cursor:zoom-in}.bf2-search-highlight{background-color:#ffff80}.bf2-hp-pre:empty{display:none}.bf2-hp-pre-\\({margin-right:.13em}.bf2-hp-\\({margin-left:-.13em}.bf2-hp-pre-«{margin-right:.2em}.bf2-hp-«{margin-left:-.2em}.bf2-hp-pre-\\"{margin-right:.2em}.bf2-hp-\\"{margin-left:-.2em}.bf2-hp-pre-“{margin-right:.33em}.bf2-hp-“{margin-left:-.33em}.bf2-hp-pre--{margin-right:.1em}.bf2-hp--{margin-left:-.1em}',""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<t.length;o++){var a=t[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function r(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=h[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(c(r.parts[i],t))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(c(r.parts[i],t));h[r.id]={id:r.id,refs:1,parts:a}}}}function o(e){for(var t=[],n={},r=0;r<e.length;r++){var o=e[r],i=o[0],a=o[1],u=o[2],s=o[3],c={css:a,media:u,sourceMap:s};n[i]?n[i].parts.push(c):t.push(n[i]={id:i,parts:[c]})}return t}function i(e,t){var n=m(),r=y[y.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),y.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(t)}}function a(e){e.parentNode.removeChild(e);var t=y.indexOf(e);t>=0&&y.splice(t,1)}function u(e){var t=document.createElement("style");return t.type="text/css",i(e,t),t}function s(e){var t=document.createElement("link");return t.rel="stylesheet",i(e,t),t}function c(e,t){var n,r,o;if(t.singleton){var i=g++;n=b||(b=u(t)),r=f.bind(null,n,i,!1),o=f.bind(null,n,i,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(t),r=d.bind(null,n),o=function(){a(n),n.href&&URL.revokeObjectURL(n.href)}):(n=u(t),r=l.bind(null,n),o=function(){a(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}function f(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=w(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function l(e,t){var n=t.css,r=t.media;if(r&&e.setAttribute("media",r),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}function d(e,t){var n=t.css,r=t.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var h={},p=function(e){var t;return function(){return"undefined"==typeof t&&(t=e.apply(this,arguments)),t}},v=p(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),m=p(function(){return document.head||document.getElementsByTagName("head")[0]}),b=null,g=0,y=[];e.exports=function(e,t){t=t||{},"undefined"==typeof t.singleton&&(t.singleton=v()),"undefined"==typeof t.insertAt&&(t.insertAt="bottom");var n=o(e);return r(n,t),function(e){for(var i=[],a=0;a<n.length;a++){var u=n[a],s=h[u.id];s.refs--,i.push(s)}if(e){var c=o(e);r(c,t)}for(var a=0;a<i.length;a++){var s=i[a];if(0===s.refs){for(var f=0;f<s.parts.length;f++)s.parts[f]();delete h[s.id]}}}};var w=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}()},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=new l(e,t,n);return f.set(e,r),r}function a(e){if(!d){d=e,f.forEach(function(e){d.isModuleEnabled(e)&&e._initiate(d)});var t=new MutationObserver(function(e){e.forEach(function(e){for(var t=function(t,n){var r=e.addedNodes[t];r.nodeType==Node.ELEMENT_NODE&&f.forEach(function(e){d.isModuleEnabled(e)&&e._trigger(r,d)})},n=0,r=e.addedNodes.length;n<r;n++)t(n,r)})});t.observe(document.body,{childList:!0,subtree:!0})}}Object.defineProperty(t,"__esModule",{value:!0}),t.registeredModules=void 0;var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.registerModule=i,t.startObserver=a;var s=n(6),c=r(s),f=t.registeredModules=new Map,l=function(){function e(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o(this,e),this.name=t,this.alwaysEnabled=r,this.enabledByDefault=n,this.requiredModules=[],this.active=!0,this._watchers=[],this._initiators=[]}return u(e,[{key:"init",value:function(e){this._initiators.push(e)}},{key:"watch",value:function(e,t){this._watchers.push({selector:e,callback:t})}},{key:"required",value:function(e){this.requiredModules.push(e)}},{key:"_initiate",value:function(e){this.active&&(this._initiators.forEach(function(t){return t(e)}),this._watchers.forEach(function(t){var n=t.selector,r=t.callback;return(0,c.default)(document.body,n,function(t){return r(t,e)})}))}},{key:"_trigger",value:function(e){this.active&&this._watchers.forEach(function(t){var n=t.selector,r=t.callback;return(0,c.default)(e,n,function(e){return r(e,d)})})}}]),e}(),d=null},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),i=r(o);t.default=function(e,t,n){if(null===e)return[];var r=e.querySelectorAll(t),o=r?Array.prototype.slice.call(r):[];if((0,i.default)(e,t)&&o.unshift(e),n)for(var a=0,u=o.length;a<u;a++)n(o[a]);return o}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return e[n](t)};var n="matches"in HTMLElement.prototype?"matches":"msMatchesSelector"},function(e,t){"use strict";function n(e){var t=document.cookie.match(new RegExp("(?:^|;\\s*)"+e+"=([^;]*)"));if(t){var n=t[1],r=n.split(".");if(3===r.length)try{var o=JSON.parse(atob(r[1]));if("userId"in o)return[o.userId,n]}catch(e){}}return[null,null]}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=t.userId=null,i=t.authToken=null,a={"freefeed.net":{cookies:["freefeedBETA_authToken","freefeed_authToken"]},"gamma.freefeed.net":{cookies:["freefeed_authToken"]}},u=t.siteDomain=location.hostname,s=t.cookieName="freefeed_authToken";u in a&&a[u].cookies.some(function(e){var a=n(e),u=r(a,2);return t.userId=o=u[0],t.authToken=i=u[1],t.cookieName=s=e,null!==o})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(e){return void n(e)}return a.done?void e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),c=n(10),f=o(c),l=n(11),d=o(l),h=n(14),p=r(h),v="me.davidmz.BetterFeed2",m=function(){function e(){u(this,e),this.me=null,this.myID=null,this.myScreenName=null,this.friends=[],this.readers=[],this.banIds=[],this.bf2Props={},this._savePropsQueue=[],this._savingPropsNow=!1,this._savingIndicator=(0,p.default)(".bf2-saving-settings-indicator","Saving settings…")}return s(e,[{key:"whoIs",value:function(t){var n=0;return t===this.me&&(n|=e.ME),this.friends.indexOf(t)!==-1&&(n|=e.FRIEND),this.readers.indexOf(t)!==-1&&(n|=e.READER),n}},{key:"isBanned",value:function(e){return this.banIds.indexOf(e)!==-1}},{key:"saveProps",value:function(e){return this._savePropsQueue.push(e.toJSON()),this._saveProps()}},{key:"_saveProps",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._savingPropsNow){e.next=2;break}return e.abrupt("return");case 2:document.body.appendChild(this._savingIndicator),this._savingPropsNow=!0;case 4:if(!(this._savePropsQueue.length>0)){e.next=11;break}t=this._savePropsQueue.shift(),n={};for(r in t)t.hasOwnProperty(r)&&(n[r]=null);return e.next=9,f.put("/v1/users/"+this.myID,JSON.stringify({user:{frontendPreferences:i({},v,t)}}));case 9:e.next=4;break;case 11:this._savingPropsNow=!1,document.body.removeChild(this._savingIndicator);case 13:case"end":return e.stop()}},e,this)}));return e}()}]),e}();t.default=m,m.ME=1,m.FRIEND=2,m.READER=4,m.ready=null,m.update=function(){m.ready=f.get("/v2/users/whoami").then(function(e){var t=new m;return t.me=e.users.username,t.myID=e.users.id,t.myScreenName=e.users.screenName,d.setPic(e.users.username,e.users.profilePictureMediumUrl),t.friends=e.subscribers.map(function(e){return d.setPic(e.username,e.profilePictureMediumUrl),e.username}),t.readers=e.users.subscribers.map(function(e){return d.setPic(e.username,e.profilePictureMediumUrl),e.username}),t.banIds=e.users.banIds,t.bf2Props=e.users.frontendPreferences[v]||{},t})},m.update()},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:c.authToken;return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("GET",s(e)),o.responseType="json",o.setRequestHeader("X-Authentication-Token",t),o.onload=function(){o.response&&"err"in o.response?r(o.response.err):n(o.response)},o.send()})}function o(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("PUT",s(e)),o.responseType="json",o.setRequestHeader("X-Authentication-Token",c.authToken),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.onload=function(){o.response&&"err"in o.response?r(o.response.err):n(o.response)},o.send(t)})}function i(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("DELETE",s(e)),o.responseType="json",o.setRequestHeader("X-Authentication-Token",c.authToken),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.onload=function(){o.response&&"err"in o.response?r(o.response.err):n(o.response)},o.send(t)})}function a(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("POST",s(e)),o.responseType="json",o.setRequestHeader("X-Authentication-Token",c.authToken),o.setRequestHeader("Content-Type","application/json; charset=UTF-8"),o.onload=function(){o.response&&"err"in o.response?r(o.response.err):n(o.response)},o.send(t)})}function u(e,t){return new Promise(function(n,r){var o=new XMLHttpRequest;o.open("POST",s(e)),o.responseType="json",o.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),o.onload=function(){o.response&&"err"in o.response?r(o.response.err):n(o.response)},o.send(t)})}function s(e){return f+e+(e.indexOf("?")!==-1?"&":"?")+"_initiator=betterfeed2"}Object.defineProperty(t,"__esModule",{value:!0}),t.get=r,t.put=o,t.del=i,t.post=a,t.anonFormPost=u;var c=n(8),f="https://freefeed.net"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(e){return void n(e)}return a.done?void e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e){return l.has(e)||l.set(e,u(e)),l.get(e)}function a(e,t){l.set(e,Promise.resolve(t&&""!==t?t:f))}Object.defineProperty(t,"__esModule",{value:!0}),t.defaultPic=void 0;var u=function(){var e=o(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://davidmz.me/frfrfr/uinfo/upic?username="+t);case 2:return e.next=4,e.sent.json();case 4:return n=e.sent,e.abrupt("return","ok"===n.status&&""!==n.data?n.data:f);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}();t.getPic=i,t.setPic=a;var s=n(12),c=r(s);n(13);var f=t.defaultPic=c.default+"/build/default-userpic-50.png",l=new Map},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="https://davidmz.me/betterfeed-cdn/"+localStorage["bf2-version"];if(document.currentScript){var r=document.currentScript.src.split("/");n=r.slice(0,r.length-2).join("/")}t.default=n},function(e,t,n){e.exports=n.p+"default-userpic-50.png"},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t,n){var r,o,u,f=e.split("."),l=f.shift()||"div";"$"===l?u=document.createDocumentFragment():(u=document.createElement(l),f.length>0&&(u.className=f.join(" ")));var d=1;if(arguments.length>1&&"object"===("undefined"==typeof t?"undefined":a(t))&&!(t instanceof Node)&&!(0,s.default)(t)&&!(0,c.isSafeHTML)(t)){for(o in t)t.hasOwnProperty(o)&&u.setAttribute(o,t[o]);d=2}if(arguments.length>d)for(r=d;r<arguments.length;r++)i(u,arguments[r]);return u}function i(e,t){t instanceof Node?e.appendChild(t):(0,s.default)(t)?t.forEach(i.bind(null,e)):"string"==typeof t?e.appendChild(document.createTextNode(t)):(0,c.isSafeHTML)(t)&&e.insertAdjacentHTML("beforeEnd",t.toString())}Object.defineProperty(t,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.default=o;var u=n(15),s=r(u),c=n(16)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return new l(e)}function a(e){return e instanceof l}function u(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return i(e.reduce(function(e,t,r){var o=n[r-1];return e+(a(o)?o:(0,f.default)(o))+t}))}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.safeHTML=i,t.isSafeHTML=a,t.html=u;var c=n(17),f=r(c),l=function(){function e(t){o(this,e),this.text=t}return s(e,[{key:"toString",value:function(){return this.text}}]),e}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;")}},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=new Promise(function(e){"complete"===document.readyState||"interactive"===document.readyState?setTimeout(e,0):document.addEventListener("DOMContentLoaded",e)})},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(5),u=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r(this,e),this.modules=new Map,a.registeredModules.forEach(function(e){e.alwaysEnabled||t.modules.set(e.name,e.enabledByDefault)}),this.hideAliens=!1,this.commentCloudsMode=2,n&&((n.modules||[]).forEach(function(e){var n=o(e,2),r=n[0],a=n[1];(i||t.modules.has(r))&&t.modules.set(r,!!a)}),this.hideAliens=!!n.hideAliens,1!==n.commentCloudsMode&&2!==n.commentCloudsMode||(this.commentCloudsMode=n.commentCloudsMode))}return i(e,[{key:"toJSON",value:function(){var e={modules:[]};return this.modules.forEach(function(t,n){return e.modules.push([n,t])}),e.hideAliens=this.hideAliens,e.commentCloudsMode=this.commentCloudsMode,e}},{key:"isModuleEnabled",value:function(e){var t=this;return e&&(e.alwaysEnabled||!this.modules.has(e.name)&&e.enabledByDefault||this.modules.get(e.name))&&!e.requiredModules.map(function(e){return a.registeredModules.get(e)}).some(function(e){return!t.isModuleEnabled(e)})}}]),e}();t.default=u},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=1,a="@response",u=function(){function e(){var t=this,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n(this,e),this.__responders=new Map,this.__listeners=new Map,this.defaultWindow=o,this.defaultOrigin=i,window.addEventListener("message",function(e){if("object"===r(e.data)){var n=e.data,o=n.action,i=n.requestId,u=n.value,s=e.source,c=e.origin;if(o===a&&t.__responders.has(i))t.__responders.get(i)(u),t.__responders.delete(i);else if(t.__listeners.has(o)){var f=t.__listeners.get(o)(u);s.postMessage({action:a,requestId:i,value:f},c)}}})}return o(e,[{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.sendEx(this.defaultWindow,this.defaultOrigin,e,t)}},{key:"sendEx",value:function(e,t,n){var r=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new Promise(function(a){var u=i++;r.__responders.set(u,a),e.postMessage({action:n,requestId:u,value:o},t)})}},{key:"on",value:function(e,t){this.__listeners.set(e,t)}}]),e}();t.default=u},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(e){return void n(e)}return a.done?void e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e){var t=e.dataset.author;if(!t){var n=e.querySelector(".comment-body > .user-name-wrapper > a");n&&(t=n.getAttribute("href").substr(1),e.dataset.author=t)}return t}function a(e){var t=e.dataset.author;if(!t){var n=e.querySelector(".post-header a.post-author");n&&(t=n.getAttribute("href").substr(1),e.dataset.author=t)}return t}function u(e){return/[\u0600-\u06ff\u0700-\u077f\u08A0-\u08ff]/.test(e)}var s=n(5),c=n(22),f=r(c),l=n(23),d=r(l),h=n(6),p=r(h),v=n(9),m=r(v),b=n(8),g=(0,s.registerModule)("common",!0,!0);g.init(function(){(0,d.default)(function(e){var t="/"===e.pathname,n="/filter/best_of"===e.pathname;document.body.classList.toggle("bf2-homepage",t),document.body.classList.toggle("bf2-best-of",n),document.body.classList.toggle("bf2-aggregate-page",t||n)}),document.addEventListener("click",function(e){if(0==e.button&&e.target.classList.contains("bf2-user-link")){var t=document.querySelector('a:not(.bf2-user-link)[href="'+CSS.escape(e.target.getAttribute("href"))+'"]');t&&(e.preventDefault(),e.target.blur(),t.click())}}),"gamma.freefeed.net"===b.siteDomain&&document.body.classList.add("bf2-gamma-frontend")}),g.watch(".timeline-post, .single-post",function(e){var t=e.querySelector(".post-timestamp").getAttribute("href").match(/^\/.+?\/([\w-]+)/)[1];e.id="post-"+t,e.dataset.postId=t;var n=e.querySelector(".post-author").getAttribute("href").substr(1);e.dataset.postAuthor=n,e.classList.add("bf2-post-from-"+n),(0,p.default)(e,".post-recipient").map(function(e){return e.getAttribute("href").substr(1)}).filter(function(e){return e!==n}).forEach(function(t){return e.classList.add("bf2-post-to-"+t)});var r=e.querySelector(".post-text"),o=e.querySelector(".comment-body");(u(r.textContent)||o&&u(o.textContent))&&e.classList.add("bf2-lang-arabic")}),g.watch(".user-card .display-name",function(e){(0,f.default)(e,".user-card").dataset.userName=e.getAttribute("href").substr(1)}),g.watch(".comment",function(){var e=o(regeneratorRuntime.mark(function e(t){var n,r,o,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i(t)){e.next=3;break}return e.abrupt("return");case 3:if(r=a((0,f.default)(t,".post"))){e.next=6;break}return e.abrupt("return");case 6:return o=[],o.push("from"),r===n&&o.push("from-post-author"),e.next=11,m.default.ready;case 11:e.t0=n,u=e.sent.whoIs(e.t0),u&m.default.ME?o.push("from-me"):u&m.default.FRIEND?o.push("from-friend"):u&m.default.READER&&o.push("from-reader"),t.dataset.commProps=o.join(" ");case 15:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===e)return null;var r=n?e:e.parentNode;return u&&r?r.closest(t):r&&r.nodeType==Node.ELEMENT_NODE?(0,a.default)(r,t)?r:o(r,t):null}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=n(7),a=r(i),u=!!Element.prototype.closest},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){n.push(e),e(location)};var n=[],r=history.pushState.bind(history),o=history.replaceState.bind(history);history.pushState=function(e,t,o){r(e,t,o),n.forEach(function(e){return e(location)})},history.replaceState=function(e,t,r){o(e,t,r),n.forEach(function(e){return e(location)})},window.addEventListener("popstate",function(){return n.forEach(function(e){return e(location)})})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){var t=(0,c.default)("a","configure settings"),n=(0,c.default)("a","show access token");e.parentNode.insertBefore((0,c.default)("p.bg-success.bf2-green","BetterFeed enabled ("+b+") | ",(0,c.default)("i.fa.fa-cog")," ",t," | ",(0,c.default)("i.fa.fa-exclamation-triangle")," ",n),e),t.addEventListener("click",function(){return i()}),n.addEventListener("click",function(){return a()})}function i(){var e=l.default+"/src/html/settings.html?origin="+encodeURIComponent(location.origin);return/iPhone|iPad/.test(navigator.userAgent)?void window.open(e,"_blank"):void new h.default("bf2-settings-lightbox").showContent((0,c.default)("iframe",{src:e,frameborder:"0"}))}function a(){var e='\n        <p>\n            Your access token is:\n        </p>\n        <p class="bf2-access-token">\n            '+(0,m.default)(p.authToken)+'\n        </p>\n        <p>\n            <strong>WARNING:</strong> Keep your token secure at all times and do not share it with services you do not fully trust.\n            They will be able to perform ANY operation on your behalf including changing your password and\n            <strong>locking you out of your account</strong>.\n        </p>\n        <p>\n            Giving your token to third party services provides them with FULL and UNLIMITED access to your account.\n            You can not change the token, you cannot revert access once you give it out.\n        </p>\n        <p>\n            If you suspect your token is being abused, contact <a href="mailto:freefeed.net@gmail.com">freefeed.net@gmail.com</a> <strong>immediately</strong>.\n        </p>\n        <p style="text-align: center">\n            <button>Close</button>\n        </p>\n    ',t=new h.default("bf2-access-token-lightbox");t.showContent(e),t.contentEl.querySelector("button").addEventListener("click",function(){return t.hide()})}var u=n(5),s=n(14),c=r(s),f=n(12),l=r(f),d=n(25),h=r(d),p=n(8),v=n(17),m=r(v),b="v2.17.4",g=(0,u.registerModule)("settings-link",!0,!0);g.watch(".sidebar",function(e){if(!e.querySelector(".bf2-sidebar-box")){var t=(0,c.default)("a","BetterFeed settings"),n=(0,c.default)(".bf2-sidebar-box.box",(0,
c.default)(".box-header-groups","Add-ons"),(0,c.default)(".box-body",(0,c.default)("ul",(0,c.default)("li",t))),(0,c.default)(".box-footer",b));e.insertBefore(n,null),t.addEventListener("click",function(){return i()})}}),"__BetterFeedOnSite"in window?g.watch(".bf2-settings-description",function(e){document.body.querySelector(".bf2-green")||o(e)}):g.watch(".box-body > form > h3",function(e){if(!document.body.querySelector(".bf2-green")&&"Change password"===e.textContent){var t=e.parentNode,n=(0,c.default)("p.bf2-settings-description","BetterFeed is an add-on that improves or dramatically alters stock interface of FreeFeed (",(0,c.default)("a",{href:"https://github.com/davidmz/BetterFeed2",target:"_blank"},"details"),"). "),r=(0,c.default)("div",(0,c.default)("h3.bf2-settings-header","Add-ons"),n,(0,c.default)("hr"));t.parentNode.insertBefore(r,t),o(n)}})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(14),u=r(a),s=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];o(this,e),this._container=(0,u.default)(".bf2-lightbox-container"),""!==n&&this._container.classList.add(n);var i=this._container.appendChild((0,u.default)(".bf2-lightbox-shadow"));this.contentEl=i.appendChild((0,u.default)(".bf2-lightbox-content")),i.addEventListener("click",function(e){e.target!==i||r||t.hide()})}return i(e,[{key:"showContent",value:function(e){"string"==typeof e?this.contentEl.innerHTML=e:(this.contentEl.innerHTML="",this.contentEl.appendChild(e)),document.body.appendChild(this._container)}},{key:"hide",value:function(){this.contentEl.innerHTML="",this._container.parentNode.removeChild(this._container)}}]),e}();t.default=s},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(e){return void n(e)}return a.done?void e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function i(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="arraybuffer",r.addEventListener("load",function(){var e,o,i=new Uint8Array(r.response),a=i.length,u=0;if(71!==i[0]||73!==i[1]||70!==i[2]||56!==i[3])return void n("Not a gif file");for(e=0,o=a-3;e<o&&u<2;++e)if(33===i[e+1]&&249===i[e+2]){var s=i[e+3],c=e+4+s;c+1<a&&0===i[c]&&(44===i[c+1]||33===i[c+1])&&u++}t(u>1)}),r.send()})}function a(e){if(!e.src.match(/^data:/)){var t=document.createElement("canvas"),n=t.width=e.width,r=t.height=e.height,o=new Image;o.crossOrigin="anonymous",o.onload=function(){t.getContext("2d").drawImage(o,0,0,n,r),e.src=t.toDataURL()},o.src=e.src}}var u=function(){var e=o(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=t.match(/([\w-]+)\.gif$/)[1],e.next=4,d.getItem(n);case 4:if(r=e.sent,null!==r){e.next=10;break}return e.next=8,i(t);case 8:r=e.sent,d.setItem(n,r);case 10:return e.abrupt("return",r);case 13:return e.prev=13,e.t0=e.catch(0),console.warn("Gif analyze problem ("+t+"): "+e.t0),e.abrupt("return",!1);case 17:case"end":return e.stop()}},e,this,[[0,13]])}));return function(t){return e.apply(this,arguments)}}(),s=n(27),c=r(s),f=n(5),l=(0,f.registerModule)("ani-gifs"),d=c.default.createInstance({name:"BF2_aniGifs"});l.watch(".image-attachments .attachment img[src$='.gif'][src*='/attachments/']:not(.bf2-gif)",function(){var e=o(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.classList.add("bf2-gif"),e.next=3,u(t.src);case 3:if(!e.sent){e.next=7;break}t.parentNode.classList.add("bf2-animated-gif"),t.removeAttribute("srcSet"),a(t);case 7:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}())},function(e,t,n){var r,r;(function(t){/*!
	    localForage -- Offline Storage, Improved
	    Version 1.7.3
	    https://localforage.github.io/localForage
	    (c) 2013-2017 Mozilla, Apache License 2.0
	*/
!function(t){e.exports=t()}(function(){return function e(t,n,o){function i(u,s){if(!n[u]){if(!t[u]){var c="function"==typeof r&&r;if(!s&&c)return r(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[u]={exports:{}};t[u][0].call(l.exports,function(e){var n=t[u][1][e];return i(n?n:e)},l,l.exports,e,t,n,o)}return n[u].exports}for(var a="function"==typeof r&&r,u=0;u<o.length;u++)i(o[u]);return i}({1:[function(e,n,r){(function(e){"use strict";function t(){f=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}f=!1}function r(e){1!==l.push(e)||f||o()}var o,i=e.MutationObserver||e.WebKitMutationObserver;if(i){var a=0,u=new i(t),s=e.document.createTextNode("");u.observe(s,{characterData:!0}),o=function(){s.data=a=++a%2}}else if(e.setImmediate||"undefined"==typeof e.MessageChannel)o="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var n=e.document.createElement("script");n.onreadystatechange=function(){t(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},e.document.documentElement.appendChild(n)}:function(){setTimeout(t,0)};else{var c=new e.MessageChannel;c.port1.onmessage=t,o=function(){c.port2.postMessage(0)}}var f,l=[];n.exports=r}).call(this,"undefined"!=typeof t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(e,t,n){"use strict";function r(){}function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=g,this.queue=[],this.outcome=void 0,e!==r&&s(this,e)}function i(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(e,t,n){p(function(){var r;try{r=t(n)}catch(t){return v.reject(e,t)}r===e?v.reject(e,new TypeError("Cannot resolve promise with itself")):v.resolve(e,r)})}function u(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function s(e,t){function n(t){i||(i=!0,v.reject(e,t))}function r(t){i||(i=!0,v.resolve(e,t))}function o(){t(r,n)}var i=!1,a=c(o);"error"===a.status&&n(a.value)}function c(e,t){var n={};try{n.value=e(t),n.status="success"}catch(e){n.status="error",n.value=e}return n}function f(e){return e instanceof this?e:v.resolve(new this(r),e)}function l(e){var t=new this(r);return v.reject(t,e)}function d(e){function t(e,t){function r(e){a[t]=e,++u!==o||i||(i=!0,v.resolve(c,a))}n.resolve(e).then(r,function(e){i||(i=!0,v.reject(c,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var a=new Array(o),u=0,s=-1,c=new this(r);++s<o;)t(e[s],s);return c}function h(e){function t(e){n.resolve(e).then(function(e){i||(i=!0,v.resolve(u,e))},function(e){i||(i=!0,v.reject(u,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var o=e.length,i=!1;if(!o)return this.resolve([]);for(var a=-1,u=new this(r);++a<o;)t(e[a]);return u}var p=e(1),v={},m=["REJECTED"],b=["FULFILLED"],g=["PENDING"];t.exports=o,o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if("function"!=typeof e&&this.state===b||"function"!=typeof t&&this.state===m)return this;var n=new this.constructor(r);if(this.state!==g){var o=this.state===b?e:t;a(n,o,this.outcome)}else this.queue.push(new i(n,e,t));return n},i.prototype.callFulfilled=function(e){v.resolve(this.promise,e)},i.prototype.otherCallFulfilled=function(e){a(this.promise,this.onFulfilled,e)},i.prototype.callRejected=function(e){v.reject(this.promise,e)},i.prototype.otherCallRejected=function(e){a(this.promise,this.onRejected,e)},v.resolve=function(e,t){var n=c(u,t);if("error"===n.status)return v.reject(e,n.value);var r=n.value;if(r)s(e,r);else{e.state=b,e.outcome=t;for(var o=-1,i=e.queue.length;++o<i;)e.queue[o].callFulfilled(t)}return e},v.reject=function(e,t){e.state=m,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e},o.resolve=f,o.reject=l,o.all=d,o.race=h},{1:1}],3:[function(e,n,r){(function(t){"use strict";"function"!=typeof t.Promise&&(t.Promise=e(2))}).call(this,"undefined"!=typeof t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}function i(){try{if(!we)return!1;var e="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t="function"==typeof fetch&&fetch.toString().indexOf("[native code")!==-1;return(!e||t)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}function a(e,t){e=e||[],t=t||{};try{return new Blob(e,t)}catch(i){if("TypeError"!==i.name)throw i;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,r=new n,o=0;o<e.length;o+=1)r.append(e[o]);return r.getBlob(t.type)}}function u(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function s(e,t,n){"function"==typeof t&&e.then(t),"function"==typeof n&&e.catch(n)}function c(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function f(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}function l(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),o=0;o<t;o++)r[o]=e.charCodeAt(o);return n}function d(e){return new _e(function(t){var n=e.transaction(xe,Me),r=a([""]);n.objectStore(xe).put(r,"key"),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function h(e){return"boolean"==typeof ke?_e.resolve(ke):d(e).then(function(e){return ke=e})}function p(e){var t=Se[e.name],n={};n.promise=new _e(function(e,t){n.resolve=e,n.reject=t}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function v(e){var t=Se[e.name],n=t.deferredOperations.pop();if(n)return n.resolve(),n.promise}function m(e,t){var n=Se[e.name],r=n.deferredOperations.pop();if(r)return r.reject(t),r.promise}function b(e,t){return new _e(function(n,r){if(Se[e.name]=Se[e.name]||M(),e.db){if(!t)return n(e.db);p(e),e.db.close()}var o=[e.name];t&&o.push(e.version);var i=we.open.apply(we,o);t&&(i.onupgradeneeded=function(t){var n=i.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(xe)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+e.name+'" has been upgraded from version '+t.oldVersion+" to version "+t.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),i.onerror=function(e){e.preventDefault(),r(i.error)},i.onsuccess=function(){n(i.result),v(e)}})}function g(e){return b(e,!1)}function y(e){return b(e,!0)}function w(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,o=e.version>e.db.version;if(r&&(e.version!==t&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||n){if(n){var i=e.db.version+1;i>e.version&&(e.version=i)}return!0}return!1}function _(e){return new _e(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function x(e){var t=l(atob(e.data));return a([t],{type:e.type})}function k(e){return e&&e.__local_forage_encoded_blob}function S(e){var t=this,n=t._initReady().then(function(){var e=Se[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return s(n,e,e),n}function E(e){p(e);for(var t=Se[e.name],n=t.forages,r=0;r<n.length;r++){var o=n[r];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,g(e).then(function(t){return e.db=t,w(e)?y(e):t}).then(function(r){e.db=t.db=r;for(var o=0;o<n.length;o++)n[o]._dbInfo.db=r}).catch(function(t){throw m(e,t),t})}function I(e,t,n,r){void 0===r&&(r=1);try{var o=e.db.transaction(e.storeName,t);n(null,o)}catch(o){if(r>0&&(!e.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return _e.resolve().then(function(){if(!e.db||"NotFoundError"===o.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),y(e)}).then(function(){return E(e).then(function(){I(e,t,n,r-1)})}).catch(n);n(o)}}function M(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function N(e){function t(){return _e.resolve()}var n=this,r={db:null};if(e)for(var o in e)r[o]=e[o];var i=Se[r.name];i||(i=M(),Se[r.name]=i),i.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=S);for(var a=[],u=0;u<i.forages.length;u++){var s=i.forages[u];s!==n&&a.push(s._initReady().catch(t))}var c=i.forages.slice(0);return _e.all(a).then(function(){return r.db=i.db,g(r)}).then(function(e){return r.db=e,w(r,n._defaultConfig.version)?y(r):e}).then(function(e){r.db=i.db=e,n._dbInfo=r;for(var t=0;t<c.length;t++){var o=c[t];o!==n&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})}function R(e,t){var n=this;e=c(e);var r=new _e(function(t,r){n.ready().then(function(){I(n._dbInfo,Ie,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),u=a.get(e);u.onsuccess=function(){var e=u.result;void 0===e&&(e=null),k(e)&&(e=x(e)),t(e)},u.onerror=function(){r(u.error)}}catch(e){r(e)}})}).catch(r)});return u(r,t),r}function j(e,t){var n=this,r=new _e(function(t,r){n.ready().then(function(){I(n._dbInfo,Ie,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),u=a.openCursor(),s=1;u.onsuccess=function(){var n=u.result;if(n){var r=n.value;k(r)&&(r=x(r));var o=e(r,n.key,s++);void 0!==o?t(o):n.continue()}else t()},u.onerror=function(){r(u.error)}}catch(e){r(e)}})}).catch(r)});return u(r,t),r}function O(e,t,n){var r=this;e=c(e);var o=new _e(function(n,o){var i;r.ready().then(function(){return i=r._dbInfo,"[object Blob]"===Ee.call(t)?h(i.db).then(function(e){return e?t:_(t)}):t}).then(function(t){I(r._dbInfo,Me,function(i,a){if(i)return o(i);try{var u=a.objectStore(r._dbInfo.storeName);null===t&&(t=void 0);var s=u.put(t,e);a.oncomplete=function(){void 0===t&&(t=null),n(t)},a.onabort=a.onerror=function(){var e=s.error?s.error:s.transaction.error;o(e)}}catch(e){o(e)}})}).catch(o)});return u(o,n),o}function T(e,t){var n=this;e=c(e);var r=new _e(function(t,r){n.ready().then(function(){I(n._dbInfo,Me,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),u=a.delete(e);i.oncomplete=function(){t()},i.onerror=function(){r(u.error)},i.onabort=function(){var e=u.error?u.error:u.transaction.error;r(e)}}catch(e){r(e)}})}).catch(r)});return u(r,t),r}function P(e){var t=this,n=new _e(function(e,n){t.ready().then(function(){I(t._dbInfo,Me,function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName),a=i.clear();o.oncomplete=function(){e()},o.onabort=o.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}}catch(e){n(e)}})}).catch(n)});return u(n,e),n}function A(e){var t=this,n=new _e(function(e,n){t.ready().then(function(){I(t._dbInfo,Ie,function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName),a=i.count();a.onsuccess=function(){e(a.result)},a.onerror=function(){n(a.error)}}catch(e){n(e)}})}).catch(n)});return u(n,e),n}function C(e,t){var n=this,r=new _e(function(t,r){return e<0?void t(null):void n.ready().then(function(){I(n._dbInfo,Ie,function(o,i){if(o)return r(o);try{var a=i.objectStore(n._dbInfo.storeName),u=!1,s=a.openCursor();s.onsuccess=function(){var n=s.result;return n?void(0===e?t(n.key):u?t(n.key):(u=!0,n.advance(e))):void t(null)},s.onerror=function(){r(s.error)}}catch(e){r(e)}})}).catch(r)});return u(r,t),r}function L(e){var t=this,n=new _e(function(e,n){t.ready().then(function(){I(t._dbInfo,Ie,function(r,o){if(r)return n(r);try{var i=o.objectStore(t._dbInfo.storeName),a=i.openCursor(),u=[];a.onsuccess=function(){var t=a.result;return t?(u.push(t.key),void t.continue()):void e(u)},a.onerror=function(){n(a.error)}}catch(e){n(e)}})}).catch(n)});return u(n,e),n}function D(e,t){t=f.apply(this,arguments);var n=this.config();e="function"!=typeof e&&e||{},e.name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;if(e.name){var i=e.name===n.name&&o._dbInfo.db,a=i?_e.resolve(o._dbInfo.db):g(e).then(function(t){var n=Se[e.name],r=n.forages;n.db=t;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=t;return t});r=e.storeName?a.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;p(e);var r=Se[e.name],o=r.forages;t.close();for(var i=0;i<o.length;i++){var a=o[i];a._dbInfo.db=null,a._dbInfo.version=n}var u=new _e(function(t,r){var o=we.open(e.name,n);o.onerror=function(e){var t=o.result;t.close(),r(e)},o.onupgradeneeded=function(){var t=o.result;t.deleteObjectStore(e.storeName)},o.onsuccess=function(){var e=o.result;e.close(),t(e)}});return u.then(function(e){r.db=e;for(var t=0;t<o.length;t++){var n=o[t];n._dbInfo.db=e,v(n._dbInfo)}}).catch(function(t){throw(m(e,t)||_e.resolve()).catch(function(){}),t})}}):a.then(function(t){p(e);var n=Se[e.name],r=n.forages;t.close();for(var o=0;o<r.length;o++){var i=r[o];i._dbInfo.db=null}var a=new _e(function(t,n){var r=we.deleteDatabase(e.name);r.onerror=r.onblocked=function(e){var t=r.result;t&&t.close(),n(e)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}});return a.then(function(e){n.db=e;for(var t=0;t<r.length;t++){var o=r[t];v(o._dbInfo)}}).catch(function(t){throw(m(e,t)||_e.resolve()).catch(function(){}),t})})}else r=_e.reject("Invalid arguments");return u(r,t),r}function B(){return"function"==typeof openDatabase}function q(e){var t,n,r,o,i,a=.75*e.length,u=e.length,s=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);var c=new ArrayBuffer(a),f=new Uint8Array(c);for(t=0;t<u;t+=4)n=Re.indexOf(e[t]),r=Re.indexOf(e[t+1]),o=Re.indexOf(e[t+2]),i=Re.indexOf(e[t+3]),f[s++]=n<<2|r>>4,f[s++]=(15&r)<<4|o>>2,f[s++]=(3&o)<<6|63&i;return c}function F(e){var t,n=new Uint8Array(e),r="";for(t=0;t<n.length;t+=3)r+=Re[n[t]>>2],r+=Re[(3&n[t])<<4|n[t+1]>>4],r+=Re[(15&n[t+1])<<2|n[t+2]>>6],r+=Re[63&n[t+2]];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function U(e,t){var n="";if(e&&(n=Ge.call(e)),e&&("[object ArrayBuffer]"===n||e.buffer&&"[object ArrayBuffer]"===Ge.call(e.buffer))){var r,o=Te;e instanceof ArrayBuffer?(r=e,o+=Ae):(r=e.buffer,"[object Int8Array]"===n?o+=Le:"[object Uint8Array]"===n?o+=De:"[object Uint8ClampedArray]"===n?o+=Be:"[object Int16Array]"===n?o+=qe:"[object Uint16Array]"===n?o+=Ue:"[object Int32Array]"===n?o+=Fe:"[object Uint32Array]"===n?o+=ze:"[object Float32Array]"===n?o+=He:"[object Float64Array]"===n?o+=We:t(new Error("Failed to get type for BinaryArray"))),t(o+F(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=je+e.type+"~"+F(this.result);t(Te+Ce+n)},i.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error("Couldn't convert value into a JSON string: ",e),t(null,n)}}function z(e){if(e.substring(0,Pe)!==Te)return JSON.parse(e);var t,n=e.substring(Xe),r=e.substring(Pe,Xe);if(r===Ce&&Oe.test(n)){var o=n.match(Oe);t=o[1],n=n.substring(o[0].length)}var i=q(n);switch(r){case Ae:return i;case Ce:return a([i],{type:t});case Le:return new Int8Array(i);case De:return new Uint8Array(i);case Be:return new Uint8ClampedArray(i);case qe:return new Int16Array(i);case Ue:return new Uint16Array(i);case Fe:return new Int32Array(i);case ze:return new Uint32Array(i);case He:return new Float32Array(i);case We:return new Float64Array(i);default:throw new Error("Unkown type: "+r)}}function H(e,t,n,r){e.executeSql("CREATE TABLE IF NOT EXISTS "+t.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],n,r)}function W(e){var t=this,n={db:null};if(e)for(var r in e)n[r]="string"!=typeof e[r]?e[r].toString():e[r];var o=new _e(function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction(function(o){H(o,n,function(){t._dbInfo=n,e()},function(e,t){r(t)})},r)});return n.serializer=Je,o}function X(e,t,n,r,o,i){e.executeSql(n,r,o,function(e,a){a.code===a.SYNTAX_ERR?e.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[t.storeName],function(e,u){u.rows.length?i(e,a):H(e,t,function(){e.executeSql(n,r,o,i)},i)},i):i(e,a)},i)}function G(e,t){var n=this;e=c(e);var r=new _e(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){X(n,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),t(r)},function(e,t){r(t)})})}).catch(r)});return u(r,t),r}function J(e,t){var n=this,r=new _e(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){X(n,o,"SELECT * FROM "+o.storeName,[],function(n,r){for(var i=r.rows,a=i.length,u=0;u<a;u++){var s=i.item(u),c=s.value;if(c&&(c=o.serializer.deserialize(c)),c=e(c,s.key,u+1),void 0!==c)return void t(c)}t()},function(e,t){r(t)})})}).catch(r)});return u(r,t),r}function Q(e,t,n,r){var o=this;e=c(e);var i=new _e(function(i,a){o.ready().then(function(){void 0===t&&(t=null);var u=t,s=o._dbInfo;s.serializer.serialize(t,function(t,c){c?a(c):s.db.transaction(function(n){X(n,s,"INSERT OR REPLACE INTO "+s.storeName+" (key, value) VALUES (?, ?)",[e,t],function(){i(u)},function(e,t){a(t)})},function(t){if(t.code===t.QUOTA_ERR){if(r>0)return void i(Q.apply(o,[e,u,n,r-1]));a(t)}})})}).catch(a)});return u(i,n),i}function V(e,t,n){return Q.apply(this,[e,t,n,1])}function K(e,t){var n=this;e=c(e);var r=new _e(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){X(n,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[e],function(){t()},function(e,t){r(t)})})}).catch(r)});return u(r,t),r}function Y(e){var t=this,n=new _e(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){X(t,r,"DELETE FROM "+r.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return u(n,e),n}function $(e){var t=this,n=new _e(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){X(t,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})}).catch(n)});return u(n,e),n}function Z(e,t){var n=this,r=new _e(function(t,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){X(n,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})}).catch(r)});return u(r,t),r}function ee(e){var t=this,n=new _e(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){X(t,r,"SELECT key FROM "+r.storeName,[],function(t,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);e(r)},function(e,t){n(t)})})}).catch(n)});return u(n,e),n}function te(e){return new _e(function(t,n){e.transaction(function(r){r.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,r){for(var o=[],i=0;i<r.rows.length;i++)o.push(r.rows.item(i).name);t({db:e,storeNames:o})},function(e,t){n(t)})},function(e){n(e)})})}function ne(e,t){t=f.apply(this,arguments);var n=this.config();e="function"!=typeof e&&e||{},e.name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r,o=this;return r=e.name?new _e(function(t){var r;r=e.name===n.name?o._dbInfo.db:openDatabase(e.name,"","",0),t(e.storeName?{db:r,storeNames:[e.storeName]}:te(r))}).then(function(e){return new _e(function(t,n){e.db.transaction(function(r){function o(e){return new _e(function(t,n){r.executeSql("DROP TABLE IF EXISTS "+e,[],function(){t()},function(e,t){n(t)})})}for(var i=[],a=0,u=e.storeNames.length;a<u;a++)i.push(o(e.storeNames[a]));_e.all(i).then(function(){t()}).catch(function(e){n(e)})},function(e){n(e)})})}):_e.reject("Invalid arguments"),u(r,t),r}function re(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}function oe(e,t){var n=e.name+"/";return e.storeName!==t.storeName&&(n+=e.storeName+"/"),n}function ie(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch(e){return!0}}function ae(){return!ie()||localStorage.length>0}function ue(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=oe(e,t._defaultConfig),ae()?(t._dbInfo=n,n.serializer=Je,_e.resolve()):_e.reject()}function se(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(e)&&localStorage.removeItem(r)}});return u(n,e),n}function ce(e,t){var n=this;e=c(e);var r=n.ready().then(function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&(r=t.serializer.deserialize(r)),r});return u(r,t),r}function fe(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,o=r.length,i=localStorage.length,a=1,u=0;u<i;u++){var s=localStorage.key(u);if(0===s.indexOf(r)){var c=localStorage.getItem(s);if(c&&(c=t.serializer.deserialize(c)),c=e(c,s.substring(o),a++),void 0!==c)return c}}});return u(r,t),r}function le(e,t){var n=this,r=n.ready().then(function(){var t,r=n._dbInfo;try{t=localStorage.key(e)}catch(e){t=null}return t&&(t=t.substring(r.keyPrefix.length)),t});return u(r,t),r}function de(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++){var i=localStorage.key(o);0===i.indexOf(e.keyPrefix)&&r.push(i.substring(e.keyPrefix.length))}return r});return u(n,e),n}function he(e){var t=this,n=t.keys().then(function(e){return e.length});return u(n,e),n}function pe(e,t){var n=this;e=c(e);var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return u(r,t),r}function ve(e,t,n){var r=this;e=c(e);var o=r.ready().then(function(){void 0===t&&(t=null);var n=t;return new _e(function(o,i){var a=r._dbInfo;a.serializer.serialize(t,function(t,r){if(r)i(r);else try{localStorage.setItem(a.keyPrefix+e,t),o(n)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||i(e),i(e)}})})});return u(o,n),o}function me(e,t){if(t=f.apply(this,arguments),e="function"!=typeof e&&e||{},!e.name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r,o=this;return r=e.name?new _e(function(t){t(e.storeName?oe(e,o._defaultConfig):e.name+"/")}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);0===n.indexOf(e)&&localStorage.removeItem(n)}}):_e.reject("Invalid arguments"),u(r,t),r}function be(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function ge(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&($e(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}var ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},we=o();"undefined"==typeof Promise&&e(3);var _e=Promise,xe="local-forage-detect-blob-support",ke=void 0,Se={},Ee=Object.prototype.toString,Ie="readonly",Me="readwrite",Ne={_driver:"asyncStorage",_initStorage:N,_support:i(),iterate:j,getItem:R,setItem:O,removeItem:T,clear:P,length:A,key:C,keys:L,dropInstance:D},Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",je="~~local_forage_type~",Oe=/^~~local_forage_type~([^~]+)~/,Te="__lfsc__:",Pe=Te.length,Ae="arbf",Ce="blob",Le="si08",De="ui08",Be="uic8",qe="si16",Fe="si32",Ue="ur16",ze="ui32",He="fl32",We="fl64",Xe=Pe+Ae.length,Ge=Object.prototype.toString,Je={serialize:U,deserialize:z,stringToBuffer:q,bufferToString:F},Qe={_driver:"webSQLStorage",_initStorage:W,_support:B(),iterate:J,getItem:G,setItem:V,removeItem:K,clear:Y,length:$,key:Z,keys:ee,dropInstance:ne},Ve={_driver:"localStorageWrapper",_initStorage:ue,_support:re(),iterate:fe,getItem:ce,setItem:ve,removeItem:pe,clear:se,length:he,key:le,keys:de,dropInstance:me},Ke=function(e,t){return e===t||"number"==typeof e&&"number"==typeof t&&isNaN(e)&&isNaN(t)},Ye=function(e,t){for(var n=e.length,r=0;r<n;){if(Ke(e[r],t))return!0;r++}return!1},$e=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Ze={},et={},tt={INDEXEDDB:Ne,WEBSQL:Qe,LOCALSTORAGE:Ve},nt=[tt.INDEXEDDB._driver,tt.WEBSQL._driver,tt.LOCALSTORAGE._driver],rt=["dropInstance"],ot=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(rt),it={description:"",driver:nt.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},at=function(){function e(t){r(this,e);for(var n in tt)if(tt.hasOwnProperty(n)){var o=tt[n],i=o._driver;this[n]=i,Ze[i]||this.defineDriver(o)}this._defaultConfig=ge({},it),this._config=ge({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if("object"===("undefined"==typeof e?"undefined":ye(e))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var t in e){if("storeName"===t&&(e[t]=e[t].replace(/\W/g,"_")),"version"===t&&"number"!=typeof e[t])return new Error("Database version must be a number.");this._config[t]=e[t]}return!("driver"in e&&e.driver)||this.setDriver(this._config.driver)}return"string"==typeof e?this._config[e]:this._config},e.prototype.defineDriver=function(e,t,n){var r=new _e(function(t,n){try{var r=e._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!e._driver)return void n(o);for(var i=ot.concat("_initStorage"),a=0,s=i.length;a<s;a++){var c=i[a],f=!Ye(rt,c);if((f||e[c])&&"function"!=typeof e[c])return void n(o)}var l=function(){for(var t=function(e){return function(){var t=new Error("Method "+e+" is not implemented by the current driver"),n=_e.reject(t);return u(n,arguments[arguments.length-1]),n}},n=0,r=rt.length;n<r;n++){var o=rt[n];e[o]||(e[o]=t(o))}};l();var d=function(n){Ze[r]&&console.info("Redefining LocalForage driver: "+r),Ze[r]=e,et[r]=n,t()};"_support"in e?e._support&&"function"==typeof e._support?e._support().then(d,n):d(!!e._support):d(!0)}catch(e){n(e)}});return s(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=Ze[e]?_e.resolve(Ze[e]):_e.reject(new Error("Driver not found."));return s(r,t,n),r},e.prototype.getSerializer=function(e){var t=_e.resolve(Je);return s(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return null===t._ready&&(t._ready=t._initDriver()),t._ready});return s(n,e,e),n},e.prototype.setDriver=function(e,t,n){function r(){a._config.driver=a.driver()}function o(e){return a._extend(e),r(),a._ready=a._initStorage(a._config),a._ready}function i(e){return function(){function t(){for(;n<e.length;){var i=e[n];return n++,a._dbInfo=null,a._ready=null,a.getDriver(i).then(o).catch(t)}r();var u=new Error("No available storage method found.");return a._driverSet=_e.reject(u),a._driverSet}var n=0;return t()}}var a=this;$e(e)||(e=[e]);var u=this._getSupportedDrivers(e),c=null!==this._driverSet?this._driverSet.catch(function(){return _e.resolve()}):_e.resolve();return this._driverSet=c.then(function(){var e=u[0];return a._dbInfo=null,a._ready=null,a.getDriver(e).then(function(e){a._driver=e._driver,r(),a._wrapLibraryMethodsWithReady(),a._initDriver=i(u)})}).catch(function(){r();var e=new Error("No available storage method found.");return a._driverSet=_e.reject(e),a._driverSet}),s(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!et[e]},e.prototype._extend=function(e){ge(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];this.supports(o)&&t.push(o)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ot.length;e<t;e++)be(this,ot[e])},e.prototype.createInstance=function(t){return new e(t)},e}(),ut=new at;t.exports=ut},{3:3}]},{},[4])(4)})}).call(t,function(){return this}())},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(){return((new Date).getTime()-l)/d%1}function i(e){var t=document.querySelector(".bf2-moon");if(t){var n=t.querySelector(".bf2-moon-light"),r=50,o=r*Math.abs(Math.cos(2*Math.PI*e)),i=void 0;i=e<.25?"M 50 0 a "+o+" 50 0 0 1 0 100 a 50 50 0 0 0 0 -100 Z":e<.5?"M 50 0 a "+o+" 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z":e<.75?"M 50 0 a 50 50 0 0 0 0 100 a "+o+" 50 0 0 0 0 -100 Z":"M 50 0 a 50 50 0 0 0 0 100 a "+o+" 50 0 0 1 0 -100 Z",n.setAttribute("d",i),Math.abs(.5-e)<.05?t.parentNode.setAttribute("title","Achtung Vollmond!"):t.parentNode.removeAttribute("title")}}var a=n(5),u=n(14),s=r(u),c=(0,a.registerModule)("moon"),f='<svg class="bf2-moon" viewBox="-4 -4 108 108" xmlns="http://www.w3.org/2000/svg" version="1.1">\n        <circle class="bf2-moon-shadow" cx="50" cy="50" r="54"></circle>\n        <path class="bf2-moon-light" d="M 50 0 a 30 50 0 0 0 0 100 a 50 50 0 0 0 0 -100 Z"></path>\n    </svg>';c.watch("h1",function(e){e.appendChild((0,s.default)(".bf2-moon-cont")).innerHTML=f,i(o()),setInterval(function(){return i(o())},36e5)});var l=new Date("Thu Apr 07 2016 14:22:37 GMT+0300").getTime(),d=Math.round(2551442813.5680003)},function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(e){return void n(e)}return a.done?void e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}function u(e){e.style.display="none",document.body.querySelector("."+A+"new-form").style.display="block"}function s(e){var t=this;return confirm("Are you sure?")?a(regeneratorRuntime.mark(function n(){var r,o,i,a;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,I.default.ready;case 2:if(r=t.sent,o=r.me,i=(0,T.default)(e,"."+A+"account").dataset.username,i!==o){t.next=7;break}return t.abrupt("return");case 7:return t.next=9,l();case 9:if(t.t0=function(e){return e.username!==i},a=t.sent.filter(t.t0),1!=a.length||a[0].username!==o){t.next=16;break}return t.next=14,D.set(C,null);case 14:t.next=18;break;case 16:return t.next=18,D.set(C,a);case 18:return t.t1=B,t.next=21,f();case 21:t.t2=t.sent,t.t1.showContent.call(t.t1,t.t2);case 23:case"end":return t.stop()}},n,t)}))():Promise.resolve()}var c=function(){var e=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){
case 0:return B=new S.default("bf2-switch-account-box"),B.showContent("<p>Loading…</p>"),e.t0=B,e.next=5,f();case 5:e.t1=e.sent,e.t0.showContent.call(e.t0,e.t1);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),f=function(){var e=a(regeneratorRuntime.mark(function e(){var t,n,r,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.default.ready;case 2:return t=e.sent,n=t.me,r=(0,_.default)("form."+A+"new-form",(0,x.html)(p)),r.addEventListener("submit",function(e){e.preventDefault();var t=r.elements.username.value,n=r.elements.password.value;a(regeneratorRuntime.mark(function e(){var r,i,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.anonFormPost("/v1/session","username="+encodeURIComponent(t)+"&password="+encodeURIComponent(n));case 2:if(r=e.sent,!r.err){e.next=6;break}return alert(r.err),e.abrupt("return");case 6:return i=r.users.username,a=r.authToken,e.next=9,d(i,a);case 9:return e.t0=B,e.next=12,f();case 12:e.t1=e.sent,e.t0.showContent.call(e.t0,e.t1);case 14:case"end":return e.stop()}},e,o)}))()}),e.t0=_.default,e.t1=(0,x.html)(v,A),e.t2=_.default,e.t3="."+A+"accounts",e.next=12,l();case 12:return e.t4=function(e){var t=e.username,r=(0,_.default)("img."+A+"upic",{src:R.defaultPic});(0,R.getPic)(t).then(function(e){return r.src=e});var o=(0,_.default)("."+A+"del",{title:"Remove from list"},(0,_.default)("i.fa.fa-times-circle"));return(0,_.default)("."+A+"account"+(t==n?".-current":""),{"data-username":t},r,t,o)},e.t5=e.sent.map(e.t4),e.t6=(0,e.t2)(e.t3,e.t5),e.t7=(0,x.html)(m,A),e.t8=r,e.abrupt("return",(0,e.t0)("",e.t1,e.t6,e.t7,e.t8));case 18:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),l=function(){var e=a(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.get(C);case 2:if(t=e.sent){e.next=10;break}return e.next=6,I.default.ready;case 6:e.t0=e.sent.me,e.t1=j.authToken,e.t2={username:e.t0,token:e.t1},t=[e.t2];case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),d=function(){var e=a(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l();case 2:if(r=e.sent,!r.some(function(e){return e.username===t})){e.next=5;break}return e.abrupt("return");case 5:return r.push({username:t,token:n}),e.next=8,D.set(C,r);case 8:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}(),h=function(){var e=a(regeneratorRuntime.mark(function e(t){var n,r,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.dataset.username,e.t0=n,e.next=4,I.default.ready;case 4:if(e.t1=e.sent.me,e.t0!==e.t1){e.next=7;break}return e.abrupt("return");case 7:return r=null,e.next=10,l();case 10:if(e.t2=function(e){return e.username==n&&(r=e.token,!0)},e.sent.some(e.t2),!r){e.next=22;break}return B.showContent("Please wait…"),o=new Date,o.setTime(o.getTime()+31536e6),document.cookie=j.cookieName+"="+encodeURIComponent(r)+"; path=/; expires="+o.toUTCString(),e.next=19,N.get("/v2/users/whoami",r);case 19:i=e.sent,localStorage.setItem("whoamiCache",JSON.stringify(i.users)),location.reload();case 22:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),p=i(['\n        <p>Please enter username and password of your other account:</p>\n        <p><input class="form-control" type="text" name="username" placeholder="Username" required></p>\n        <p><input class="form-control" type="password" name="password" placeholder="Password" required></p>\n        <p><button type="submit" class="btn btn-default">Add</button></p>\n        '],['\n        <p>Please enter username and password of your other account:</p>\n        <p><input class="form-control" type="text" name="username" placeholder="Username" required></p>\n        <p><input class="form-control" type="password" name="password" placeholder="Password" required></p>\n        <p><button type="submit" class="btn btn-default">Add</button></p>\n        ']),v=i(['<div class="','header">Switch account to:</div>'],['<div class="','header">Switch account to:</div>']),m=i(['<div class="','add-new"><a><i class="fa fa-plus"></i> Add new account</a></div>'],['<div class="','add-new"><a><i class="fa fa-plus"></i> Add new account</a></div>']),b=n(5),g=n(30),y=o(g),w=n(14),_=o(w),x=n(16),k=n(25),S=o(k),E=n(9),I=o(E),M=n(10),N=r(M),R=n(11),j=n(8),O=n(22),T=o(O),P=(0,b.registerModule)("switch-accounts"),A="bf2-switch-dlg-",C="bfAccounts-freefeed.net",L=[{selector:"."+A+"del",handler:s},{selector:"."+A+"account",handler:h},{selector:"."+A+"add-new",handler:u}],D=null;P.init(function(){D=new y.default,document.body.addEventListener("click",function(e){L.some(function(t){var n=(0,T.default)(e.target,t.selector,!0);return!!n&&(e.preventDefault(),t.handler(n),!0)})})}),P.watch(".logged-in > .avatar, .logged-in > .userpic",function(e){e.appendChild((0,_.default)(".bf2-switch-acc",{title:"Switch account"},(0,_.default)("span.fa.fa-exchange"))).addEventListener("click",c)});var B=null},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(20),u=r(a),s="https://davidmz.github.io/BetterFeed2/storage.html?_="+Math.random(),c="https://davidmz.github.io",f=function(){function e(){o(this,e),this.iframe=document.createElement("iframe"),this.iframe.src=s,this.iframe.style.cssText="visibility: hidden;\n            position: absolute;\n            left: 0; top: 0;\n            height:0; width:0;\n            border: none;",document.body.appendChild(this.iframe),this.msg=new u.default(this.iframe.contentWindow,c)}return i(e,[{key:"get",value:function(e){return this.msg.send("get",e)}},{key:"set",value:function(e,t){return this.msg.send("set",{key:e,value:t})}}]),e}();t.default=f},function(e,t,n){"use strict";var r=n(5),o=(0,r.registerModule)("no-read-more",!1);o.watch("a.read-more",function(e){return e.click()}),o.watch(".expand-button > i",function(e){return e.click()})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function o(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,i){try{var a=t[o](i),u=a.value}catch(e){return void n(e)}return a.done?void e(u):Promise.resolve(u).then(function(e){r("next",e)},function(e){r("throw",e)})}return r("next")})}}var i=n(5),a=n(14),u=r(a),s=n(11),c=n(9),f=r(c);n(33);var l=(0,i.registerModule)("comment-clouds"),d=new Map,h=!1,p=null;l.init(function(e){p=document.head.appendChild((0,u.default)("style.bf2-comments-avatars")).sheet,h=2===e.commentCloudsMode,h&&document.body.classList.add("bf2-comments-with-avatars")}),l.watch(".comment[data-author]",function(){var e=o(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.querySelector(".bf2-comment-ex")){e.next=2;break}return e.abrupt("return");case 2:if(!h){e.next=20;break}if(n=t.dataset.author,t.appendChild((0,u.default)(".bf2-comment-avatar.bf2-comment-ex")),d.has(n)){e.next=18;break}if(d.set(n,!0),e.t0=s.getPic,e.t1=n,e.t1){e.next=13;break}return e.next=12,f.default.ready;case 12:e.t1=e.sent.me;case 13:return e.t2=e.t1,e.next=16,(0,e.t0)(e.t2);case 16:r=e.sent,p.insertRule('.comment[data-author="'+n+'"] .bf2-comment-avatar { background-image: url('+r+"); }",0);case 18:e.next=21;break;case 20:t.appendChild((0,u.default)("i.fa.fa-comment.icon.bf2-ico-bg.bf2-comment-ex"));case 21:case"end":return e.stop()}},e,void 0)}));return function(t){return e.apply(this,arguments)}}())},function(e,t,n){var r=n(34);"string"==typeof r&&(r=[[e.id,r,""]]);n(4)(r,{});r.locals&&(e.exports=r.locals)},function(e,t,n){t=e.exports=n(3)(),t.push([e.id,".comment .comment-icon:not(.fa-stack){position:relative;top:-2px;left:-1px;z-index:1}.comment-likes .comment-likes-list{z-index:2}.bf2-ico-bg{position:absolute;top:0;left:0;color:#fff;display:none}.comment[data-comm-props~=from] .bf2-ico-bg{display:block}.comment[data-comm-props~=from-reader] .bf2-ico-bg{color:#ededed}.comment[data-comm-props~=from-friend] .bf2-ico-bg{color:#cef4fc}.comment[data-comm-props~=from-post-author] .bf2-ico-bg{color:#b5b5b5}.comment[data-comm-props~=from-me] .bf2-ico-bg{color:#ffd061}.comment.omit-bubble .bf2-ico-bg{display:none}.bf2-comment-avatar{position:absolute;width:16px;height:16px;background-size:cover;top:0;left:-4px;z-index:1;background-color:#fff;border-radius:50%;border:1px solid #ccc;box-sizing:content-box;pointer-events:none}.comment.omit-bubble .bf2-comment-avatar{display:none}.bf2-gamma-frontend .highlighted .bf2-comment-avatar{top:4px;left:3px}.bf2-comments-with-avatars .comment .comment-icon{width:17px;height:17px;position:relative;top:1px;left:-4px;margin:0}.bf2-comments-with-avatars .comment .comment-icon:before{display:none}.bf2-comments-with-avatars .comment .comment-time{margin-right:2px}.bf2-comments-with-avatars .feed-comment-dot:after{margin-top:1px}.bf2-comments-with-avatars .comment{margin-top:10px}.bf2-comments-with-avatars .bf2-likecomm-shift{left:-9px}.bf2-comments-with-avatars .likes{position:relative;left:-2px}.bf2-comments-with-avatars .likes .icon{margin-right:7px}.bf2-comments-with-avatars .fold-comments-sticky{z-index:2}.bf2-comments-with-avatars .fold-comments-sticky i{left:-2px}.bf2-gamma-frontend.bf2-comments-with-avatars .comment.highlighted{margin-top:6px}",""])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(5),i=n(14),a=r(i),u=(0,o.registerModule)("hide-arabic",!1),s=null;u.init(function(){s=document.head.appendChild((0,a.default)("style.bf2-hide-posts")).sheet,s.insertRule(".bf2-aggregate-page .bf2-lang-arabic { display: none; }",0)})},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}var o=n(5),i=n(37),a=r(i),u=n(17),s=r(u),c=n(7),f=r(c),l=(0,o.registerModule)("hanging-punct"),d=void 0;l.init(function(){d=document.createElement("div")});var h=/(^|\s)([(«“-]|&quot;)/g;l.watch(".post-text, .comment-body",function(e){if((0,f.default)(e,".comment-body")){var t=e.querySelectorAll(".user-name-wrapper"),n=t[t.length-1];if(n&&n.nextElementSibling){var r=n.nextElementSibling;(0,a.default)(r,function(e){"("===e.nodeValue&&(e.nodeValue=" (")})}}(0,a.default)(e,function(e){if(!e.parentNode.classList.contains("bf2-hp")){var t=(0,s.default)(e.nodeValue);if(h.test(t)){for(t=t.replace(h,'<span class="bf2-hp bf2-hp-pre bf2-hp-pre-$2">$1</span><span class="bf2-hp bf2-hp-$2">$2</span>'),d.innerHTML=t;d.firstChild;)e.parentNode.insertBefore(d.firstChild,e);e.parentNode.removeChild(e)}}})})},function(e,t){"use strict";function n(e,t){if(e.nodeType===Node.TEXT_NODE)t(e);else if(e.nodeType===Node.ELEMENT_NODE)for(var r=e.firstChild;r;){var o=r.nextSibling;n(r,t),r=o}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n}]);
//# sourceMappingURL=better-feed.min.js.map