{"version":3,"sources":["webpack:///settings.min.js","webpack:///webpack/bootstrap 9aa28adf1a798b8c6caa?7c96","webpack:///./src/js/settings.js","webpack:///./src/js/base/modules.js?9f07","webpack:///./src/js/utils/for-select.js?ebda","webpack:///./src/js/utils/matches.js?d30e","webpack:///./src/js/base/settings.js?d926","webpack:///./src/js/utils/message-rpc.js?2bdd","webpack:///./src/js/utils/escape-html.js?b1be","webpack:///./src/js/utils/cell.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p",0,"_interopRequireDefault","obj","__esModule","default","_cell","_cell2","_settings","_settings2","_messageRpc","_messageRpc2","_forSelect","_forSelect2","_escapeHtml","_escapeHtml2","version","location","pathname","match","document","querySelector","appendChild","createTextNode","body","link","href","search","sPage","parentWindow","window","parent","opener","exec","alert","parentOrigin","decodeURIComponent","saveButton","getElementById","checkBoxes","hidePostsFromTA","msg","settings","sendMsg","send","bind","addEventListener","e","btn","target","disabled","then","style","width","offsetWidth","innerHTML","forEach","box","set","checked","hidePostsFrom","clear","value","toLowerCase","u","add","toJSON","isChanged","initialState","Map","currentState","state","input","type","updateInputs","get","s","substr","sData","node","k","dataset","fromInput","onValue","classList","remove","previousElementSibling","changeHandler","st","changed","v","distinct",5,"_classCallCheck","instance","Constructor","TypeError","registerModule","name","enabledByDefault","arguments","length","undefined","alwaysEnabled","Module","startObserver","aSettings","isModuleEnabled","_initiate","observer","MutationObserver","mutations","mutation","_loop","i","l","addedNodes","nodeType","Node","ELEMENT_NODE","_trigger","observe","childList","subtree","Object","defineProperty","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","this","_watchers","_initiators","callback","push","selector","_ref","n","_ref2",6,"_matches","_matches2","foo","nodeList","querySelectorAll","nodes","Array","slice","unshift",7,"matchesMethod","HTMLElement",14,"_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","err","isArray","_modules","Settings","_this","o","trustedData","Set","has",15,"_typeof","constructor","nextRequestId","responseAction","Messenger","__responders","__listeners","event","data","_event$data","action","requestId","source","origin","resp","postMessage","_this2","Promise","resolve",21,"replace",27,"Cell","_value","_listeners","lst","initial","derive","duration","val","timer","setTimeout","lastProm","prom","res","poke","_len","cells","_key","cell","map","vv","eventNames","property","HTMLInputElement","HTMLTextAreaElement","HTMLSelectElement","defaultProperty","events","split","getVal","ticker","timeout","setInterval"],"mappings":"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","file":"settings.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _cell = __webpack_require__(27);\n\t\n\tvar _cell2 = _interopRequireDefault(_cell);\n\t\n\tvar _settings = __webpack_require__(14);\n\t\n\tvar _settings2 = _interopRequireDefault(_settings);\n\t\n\tvar _messageRpc = __webpack_require__(15);\n\t\n\tvar _messageRpc2 = _interopRequireDefault(_messageRpc);\n\t\n\tvar _forSelect = __webpack_require__(6);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tvar _escapeHtml = __webpack_require__(21);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/** page elements fix **/\n\tvar version = location.pathname.match(/BetterFeed2\\/([^\\/]+)/);\n\tif (version) {\n\t    document.querySelector(\".version\").appendChild(document.createTextNode(version[1]));\n\t}\n\t(0, _forSelect2.default)(document.body, \".local-link\", function (link) {\n\t    return link.href += location.search;\n\t});\n\t/** page elements fix **/\n\t\n\tvar sPage = document.querySelector(\".content.settings\");\n\t\n\t// мы на странице настроек\n\tif (sPage) {\n\t    (function () {\n\t        var parentWindow = window.parent === window ? window.opener : window.parent;\n\t\n\t        if (!parentWindow || !/[?&]origin=([^&]+)/.exec(location.search)) {\n\t            alert(\"Пожалуйста, откройте эту страницу по ссылке из FreeFeed-а\");\n\t        }\n\t\n\t        var parentOrigin = decodeURIComponent(/[?&]origin=([^&]+)/.exec(location.search)[1]),\n\t            saveButton = document.getElementById(\"save-settings\"),\n\t            checkBoxes = (0, _forSelect2.default)(sPage, \"input[type='checkbox']\"),\n\t            hidePostsFromTA = document.getElementById(\"hide-posts-from-users\"),\n\t            msg = new _messageRpc2.default();\n\t\n\t        /** @type {Settings|null} */\n\t        var settings = null;\n\t\n\t        var sendMsg = msg.send.bind(msg, parentWindow, parentOrigin);\n\t\n\t        document.getElementById(\"check-updates\").addEventListener(\"click\", function (e) {\n\t            var btn = e.target;\n\t            btn.disabled = true;\n\t            sendMsg(\"checkUpdates\").then(function () {\n\t                return btn.disabled = false;\n\t            });\n\t        });\n\t\n\t        saveButton.addEventListener(\"click\", function () {\n\t            saveButton.disabled = true;\n\t            saveButton.style.width = saveButton.offsetWidth + \"px\";\n\t            saveButton.innerHTML = (0, _escapeHtml2.default)(\"Сохраняем…\");\n\t\n\t            checkBoxes.forEach(function (box) {\n\t                return settings.modules.set(box.id, box.checked);\n\t            });\n\t            {\n\t                settings.hidePostsFrom.clear();\n\t                (hidePostsFromTA.value.toLowerCase().match(/\\w+/g) || []).forEach(function (u) {\n\t                    return settings.hidePostsFrom.add(u);\n\t                });\n\t            }\n\t            sendMsg(\"saveSettings\", settings.toJSON());\n\t        });\n\t\n\t        var isChanged = new _cell2.default(false);\n\t        var initialState = new Map();\n\t        var currentState = function currentState() {\n\t            var state = new Map();\n\t            (0, _forSelect2.default)(sPage, \"input, textarea\", function (input) {\n\t                state.set(input.id, input.type === \"checkbox\" ? input.checked : input.value);\n\t            });\n\t            return state;\n\t        };\n\t        var updateInputs = function updateInputs() {\n\t            checkBoxes.forEach(function (box) {\n\t                return box.checked = settings.modules.get(box.id);\n\t            });\n\t            {\n\t                var s = \"\";\n\t                settings.hidePostsFrom.forEach(function (u) {\n\t                    return s += \", \" + u;\n\t                });\n\t                hidePostsFromTA.value = s.substr(2);\n\t            }\n\t        };\n\t\n\t        sendMsg(\"getSettings\").then(function (sData) {\n\t            settings = new _settings2.default(sData, true);\n\t            updateInputs();\n\t\n\t            // Взаимосвязь между флагами\n\t            (0, _forSelect2.default)(sPage, \"[data-disabled-if]\", function (node) {\n\t                var k = node.dataset[\"disabledIf\"],\n\t                    c = document.getElementById(k);\n\t                if (c) {\n\t                    _cell2.default.fromInput(c).onValue(function (checked) {\n\t                        return node.disabled = checked;\n\t                    });\n\t                }\n\t            });\n\t\n\t            (0, _forSelect2.default)(sPage, \"[data-enabled-if]\", function (node) {\n\t                var k = node.dataset[\"enabledIf\"],\n\t                    c = document.getElementById(k);\n\t                if (c) {\n\t                    _cell2.default.fromInput(c).onValue(function (checked) {\n\t                        return node.disabled = !checked;\n\t                    });\n\t                }\n\t            });\n\t\n\t            initialState = currentState();\n\t\n\t            sPage.classList.remove(\"hidden\");\n\t            sPage.previousElementSibling.classList.add(\"hidden\");\n\t        });\n\t\n\t        var changeHandler = function changeHandler() {\n\t            var st = currentState(),\n\t                changed = false;\n\t            st.forEach(function (v, k) {\n\t                return changed = changed || v !== initialState.get(k);\n\t            });\n\t            isChanged.value = changed;\n\t        };\n\t\n\t        sPage.addEventListener(\"input\", changeHandler);\n\t        sPage.addEventListener(\"change\", changeHandler);\n\t\n\t        isChanged.distinct().onValue(function (s) {\n\t            return saveButton.disabled = !s;\n\t        });\n\t    })();\n\t}\n\n/***/ },\n\n/***/ 5:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.modules = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.registerModule = registerModule;\n\texports.startObserver = startObserver;\n\t\n\tvar _forSelect = __webpack_require__(6);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar modules = exports.modules = new Map(); // name → module\n\t\n\tvar Module = function () {\n\t    function Module(name) {\n\t        var enabledByDefault = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\t        var alwaysEnabled = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t        _classCallCheck(this, Module);\n\t\n\t        this.name = name;\n\t        this.alwaysEnabled = alwaysEnabled;\n\t        this.enabledByDefault = enabledByDefault;\n\t        this._watchers = [];\n\t        this._initiators = [];\n\t    }\n\t\n\t    _createClass(Module, [{\n\t        key: \"init\",\n\t        value: function init(callback) {\n\t            this._initiators.push(callback);\n\t        }\n\t    }, {\n\t        key: \"watch\",\n\t        value: function watch(selector, callback) {\n\t            this._watchers.push({ selector: selector, callback: callback });\n\t        }\n\t    }, {\n\t        key: \"_initiate\",\n\t        value: function _initiate(settings) {\n\t            this._initiators.forEach(function (c) {\n\t                return c(settings);\n\t            });\n\t            this._watchers.forEach(function (_ref) {\n\t                var selector = _ref.selector;\n\t                var callback = _ref.callback;\n\t                return (0, _forSelect2.default)(document.body, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }, {\n\t        key: \"_trigger\",\n\t        value: function _trigger(node) {\n\t            this._watchers.forEach(function (_ref2) {\n\t                var selector = _ref2.selector;\n\t                var callback = _ref2.callback;\n\t                return (0, _forSelect2.default)(node, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Module;\n\t}();\n\t\n\tfunction registerModule(name) {\n\t    var enabledByDefault = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\t    var alwaysEnabled = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t    var m = new Module(name, enabledByDefault, alwaysEnabled);\n\t    modules.set(name, m);\n\t    return m;\n\t}\n\t\n\tvar settings = null;\n\t/**\r\n\t *\r\n\t * @param {Settings} aSettings\r\n\t */\n\tfunction startObserver(aSettings) {\n\t    if (settings) {\n\t        return;\n\t    }\n\t    settings = aSettings;\n\t\n\t    modules.forEach(function (m) {\n\t        if (settings.isModuleEnabled(m)) {\n\t            m._initiate(settings);\n\t        }\n\t    });\n\t\n\t    var observer = new MutationObserver(function (mutations) {\n\t        mutations.forEach(function (mutation) {\n\t            var _loop = function _loop(i, l) {\n\t                var node = mutation.addedNodes[i];\n\t                if (node.nodeType == Node.ELEMENT_NODE) {\n\t                    modules.forEach(function (m) {\n\t                        if (settings.isModuleEnabled(m)) {\n\t                            m._trigger(node, settings);\n\t                        }\n\t                    });\n\t                }\n\t            };\n\t\n\t            for (var i = 0, l = mutation.addedNodes.length; i < l; i++) {\n\t                _loop(i, l);\n\t            }\n\t        });\n\t    });\n\t\n\t    observer.observe(document.body, { childList: true, subtree: true });\n\t}\n\n/***/ },\n\n/***/ 6:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _matches = __webpack_require__(7);\n\t\n\tvar _matches2 = _interopRequireDefault(_matches);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\r\n\t * @param {Document|DocumentFragment|Element} node\r\n\t * @param {string} selector\r\n\t * @param {function(Node)} [foo]\r\n\t */\n\t\n\texports.default = function (node, selector, foo) {\n\t    if (node === null) return [];\n\t    var nodeList = node.querySelectorAll(selector);\n\t    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\n\t    if ((0, _matches2.default)(node, selector)) nodes.unshift(node);\n\t    if (foo) {\n\t        for (var i = 0, l = nodes.length; i < l; i++) {\n\t            foo(nodes[i]);\n\t        }\n\t    }\n\t    return nodes;\n\t};\n\n/***/ },\n\n/***/ 7:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (node, selector) {\n\t  return node[matchesMethod](selector);\n\t};\n\t\n\tvar matchesMethod = \"matches\" in HTMLElement.prototype ? \"matches\" : \"msMatchesSelector\";\n\t\n\t/**\r\n\t *\r\n\t * @param {HTMLElement} node\r\n\t * @param {String} selector\r\n\t * @return {Boolean}\r\n\t */\n\n/***/ },\n\n/***/ 14:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _modules = __webpack_require__(5);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Settings = function () {\n\t    function Settings() {\n\t        var _this = this;\n\t\n\t        var o = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n\t        var trustedData = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\t\n\t        _classCallCheck(this, Settings);\n\t\n\t        this.modules = new Map();\n\t        _modules.modules.forEach(function (m) {\n\t            if (!m.alwaysEnabled) {\n\t                _this.modules.set(m.name, m.enabledByDefault);\n\t            }\n\t        });\n\t\n\t        this.hidePostsFrom = new Set();\n\t\n\t        // инициализация из объекта\n\t        if (o) {\n\t            (o.modules || []).forEach(function (_ref) {\n\t                var _ref2 = _slicedToArray(_ref, 2);\n\t\n\t                var k = _ref2[0];\n\t                var v = _ref2[1];\n\t\n\t                if (trustedData || _this.modules.has(k)) {\n\t                    _this.modules.set(k, !!v);\n\t                }\n\t            });\n\t            (o.hidePostsFrom || []).forEach(function (u) {\n\t                return _this.hidePostsFrom.add(u);\n\t            });\n\t        }\n\t    }\n\t\n\t    _createClass(Settings, [{\n\t        key: \"toJSON\",\n\t        value: function toJSON() {\n\t            var o = { modules: [], hidePostsFrom: [] };\n\t            this.modules.forEach(function (v, k) {\n\t                return o.modules.push([k, v]);\n\t            });\n\t            this.hidePostsFrom.forEach(function (u) {\n\t                return o.hidePostsFrom.push(u);\n\t            });\n\t            return o;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Module} m\r\n\t         * @return {boolean}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"isModuleEnabled\",\n\t        value: function isModuleEnabled(m) {\n\t            return m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name);\n\t        }\n\t    }]);\n\t\n\t    return Settings;\n\t}();\n\n\texports.default = Settings;\n\n/***/ },\n\n/***/ 15:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nextRequestId = 1;\n\t\n\tvar responseAction = \"@response\";\n\t\n\tvar Messenger = function () {\n\t    function Messenger() {\n\t        var _this = this;\n\t\n\t        _classCallCheck(this, Messenger);\n\t\n\t        this.__responders = new Map();\n\t        this.__listeners = new Map();\n\t\n\t        window.addEventListener('message', function (event) {\n\t            if (_typeof(event.data) !== \"object\") {\n\t                return;\n\t            }\n\t            //noinspection UnnecessaryLocalVariableJS\n\t            var _event$data = event.data;\n\t            var action = _event$data.action;\n\t            var requestId = _event$data.requestId;\n\t            var value = _event$data.value;\n\t            var source = event.source;\n\t            var origin = event.origin;\n\t\n\t\n\t            if (action === responseAction && _this.__responders.has(requestId)) {\n\t                _this.__responders.get(requestId)(value);\n\t                _this.__responders.delete(requestId);\n\t            } else if (_this.__listeners.has(action)) {\n\t                var resp = _this.__listeners.get(action)(value);\n\t                source.postMessage({ action: responseAction, requestId: requestId, value: resp }, origin);\n\t            }\n\t        });\n\t    }\n\t\n\t    /**\r\n\t     *\r\n\t     * @param {Window} window\r\n\t     * @param {String} origin\r\n\t     * @param {String} action\r\n\t     * @param {*} value\r\n\t     * @return {Promise}\r\n\t     */\n\t\n\t\n\t    _createClass(Messenger, [{\n\t        key: \"send\",\n\t        value: function send(window, origin, action) {\n\t            var _this2 = this;\n\t\n\t            var value = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t            return new Promise(function (resolve) {\n\t                var requestId = nextRequestId++;\n\t                _this2.__responders.set(requestId, resolve);\n\t                window.postMessage({ action: action, requestId: requestId, value: value }, origin);\n\t            });\n\t        }\n\t\n\t        /**\r\n\t         *\r\n\t         * @param {String} action\r\n\t         * @param {function} callback\r\n\t         */\n\t\n\t    }, {\n\t        key: \"on\",\n\t        value: function on(action, callback) {\n\t            this.__listeners.set(action, callback);\n\t        }\n\t    }]);\n\t\n\t    return Messenger;\n\t}();\n\n\texports.default = Messenger;\n\n/***/ },\n\n/***/ 21:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function () {\n\t  var s = arguments.length <= 0 || arguments[0] === undefined ? \"\" : arguments[0];\n\t\n\t  return s.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\n\t};\n\n/***/ },\n\n/***/ 27:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Cell = function () {\n\t    function Cell(value) {\n\t        _classCallCheck(this, Cell);\n\t\n\t        this._value = value;\n\t        this._listeners = new Set();\n\t    }\n\t\n\t    _createClass(Cell, [{\n\t        key: \"poke\",\n\t        value: function poke() {\n\t            var _this = this;\n\t\n\t            this._listeners.forEach(function (l) {\n\t                return l(_this._value);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"onValue\",\n\t        value: function onValue(lst) {\n\t            this._listeners.add(lst);\n\t            lst(this.value);\n\t            return this;\n\t        }\n\t    }, {\n\t        key: \"unListen\",\n\t        value: function unListen(lst) {\n\t            this._listeners.delete(lst);\n\t            return this;\n\t        }\n\t\n\t        /**\r\n\t         * @param {function(Cell, *)} foo\r\n\t         * @param {*} [initial]\r\n\t         * @return {Cell}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"derive\",\n\t        value: function derive(foo, initial) {\n\t            var c = new Cell(initial);\n\t            this.onValue(function (v) {\n\t                return foo(c, v);\n\t            });\n\t            return c;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Array.<Cell>} cells\r\n\t         * @return {Cell}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"map\",\n\t        value: function map(foo) {\n\t            return this.derive(function (c, v) {\n\t                return c.value = foo(v);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"filter\",\n\t        value: function filter(foo) {\n\t            return this.derive(function (c, v) {\n\t                return foo(v) && (c.value = v);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"throttle\",\n\t        value: function throttle(duration) {\n\t            var _this2 = this;\n\t\n\t            var val = undefined,\n\t                timer = null;\n\t\n\t            return this.derive(function (c, v) {\n\t                val = v;\n\t                if (!timer) {\n\t                    timer = setTimeout(function () {\n\t                        if (val !== undefined) {\n\t                            c.value = _this2.value;\n\t                            val = undefined;\n\t                        }\n\t                        timer = null;\n\t                    }, duration);\n\t                }\n\t            }, this.value);\n\t        }\n\t\n\t        /**\r\n\t         * For cell with Promise's values\r\n\t         * @param {*} [initial]\r\n\t         * @return {Cell}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"latestPromise\",\n\t        value: function latestPromise(initial) {\n\t            var lastProm = null;\n\t            return this.derive(function (c, v) {\n\t                var prom = v;\n\t                lastProm = prom;\n\t                prom.then(function (res) {\n\t                    if (prom === lastProm) {\n\t                        c.value = res;\n\t                    }\n\t                });\n\t            }, initial);\n\t        }\n\t    }, {\n\t        key: \"distinct\",\n\t        value: function distinct() {\n\t            var val;\n\t            return this.derive(function (c, v) {\n\t                if (v !== val) {\n\t                    val = v;\n\t                    c.value = v;\n\t                }\n\t            });\n\t        }\n\t    }, {\n\t        key: \"value\",\n\t        get: function get() {\n\t            return this._value;\n\t        },\n\t        set: function set(v) {\n\t            this._value = v;\n\t            this.poke();\n\t        }\n\t    }], [{\n\t        key: \"combine\",\n\t        value: function combine() {\n\t            for (var _len = arguments.length, cells = Array(_len), _key = 0; _key < _len; _key++) {\n\t                cells[_key] = arguments[_key];\n\t            }\n\t\n\t            var cell = new Cell(cells.map(function (c) {\n\t                return c.value;\n\t            }));\n\t            cells.forEach(function (c, i) {\n\t                return c.onValue(function (v) {\n\t                    var vv = cell.value;\n\t                    vv[i] = v;\n\t                    cell.value = vv;\n\t                });\n\t            });\n\t            return cell;\n\t        }\n\t    }, {\n\t        key: \"fromInput\",\n\t        value: function fromInput(input, eventNames, property) {\n\t            if (!input || !(input instanceof HTMLInputElement || input instanceof HTMLTextAreaElement || input instanceof HTMLSelectElement)) {\n\t                return new Cell(null);\n\t            }\n\t\n\t            var defaultProperty = \"value\";\n\t            if (input instanceof HTMLInputElement && (input.type === \"checkbox\" || input.type === \"radio\")) {\n\t                defaultProperty = \"checked\";\n\t            }\n\t\n\t            var events = eventNames ? eventNames.split(\" \") : [\"input\", \"change\"];\n\t            property = property || defaultProperty;\n\t\n\t            var getVal = function getVal() {\n\t                return property === \"self\" ? input : input[property];\n\t            };\n\t\n\t            var cell = new Cell(getVal());\n\t            events.forEach(function (event) {\n\t                return input.addEventListener(event, function () {\n\t                    return cell.value = getVal();\n\t                });\n\t            });\n\t            return cell;\n\t        }\n\t    }, {\n\t        key: \"ticker\",\n\t        value: function ticker(timeout) {\n\t            var ticker = new Cell(true);\n\t            setInterval(function () {\n\t                return ticker.value = true;\n\t            }, timeout);\n\t            return ticker;\n\t        }\n\t    }]);\n\t\n\t    return Cell;\n\t}();\n\n\texports.default = Cell;\n\n/***/ }\n\n/******/ });\n\n\n/** WEBPACK FOOTER **\n ** settings.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 9aa28adf1a798b8c6caa\n **/","import Cell      from \"./utils/cell\";\r\nimport Settings  from \"./base/settings\";\r\nimport Messenger from \"./utils/message-rpc\";\r\nimport forSelect from \"./utils/for-select\";\r\nimport escapeHTML from \"./utils/escape-html\";\r\n\r\n\r\n/** page elements fix **/\r\nconst version = location.pathname.match(/BetterFeed2\\/([^\\/]+)/);\r\nif (version) {\r\n    document.querySelector(\".version\").appendChild(document.createTextNode(version[1]));\r\n}\r\nforSelect(document.body, \".local-link\", link => link.href += location.search);\r\n/** page elements fix **/\r\n\r\nconst sPage = document.querySelector(\".content.settings\");\r\n\r\n// мы на странице настроек\r\nif (sPage) {\r\n    const parentWindow = (window.parent === window) ? window.opener : window.parent;\r\n\r\n    if (!parentWindow || !/[?&]origin=([^&]+)/.exec(location.search)) {\r\n        alert(\"Пожалуйста, откройте эту страницу по ссылке из FreeFeed-а\");\r\n    }\r\n\r\n    const\r\n        parentOrigin = decodeURIComponent(/[?&]origin=([^&]+)/.exec(location.search)[1]),\r\n        saveButton = document.getElementById(\"save-settings\"),\r\n        checkBoxes = forSelect(sPage, \"input[type='checkbox']\"),\r\n        hidePostsFromTA = document.getElementById(\"hide-posts-from-users\"),\r\n        msg = new Messenger();\r\n\r\n    /** @type {Settings|null} */\r\n    let settings = null;\r\n\r\n    const sendMsg = msg.send.bind(msg, parentWindow, parentOrigin);\r\n\r\n    document.getElementById(\"check-updates\").addEventListener(\"click\", e => {\r\n        const btn = e.target;\r\n        btn.disabled = true;\r\n        sendMsg(\"checkUpdates\").then(() => btn.disabled = false);\r\n    });\r\n\r\n    saveButton.addEventListener(\"click\", () => {\r\n        saveButton.disabled = true;\r\n        saveButton.style.width = saveButton.offsetWidth + \"px\";\r\n        saveButton.innerHTML = escapeHTML(\"Сохраняем\\u2026\");\r\n\r\n        checkBoxes.forEach(box => settings.modules.set(box.id, box.checked));\r\n        {\r\n            settings.hidePostsFrom.clear();\r\n            (hidePostsFromTA.value.toLowerCase().match(/\\w+/g) || []).forEach(u => settings.hidePostsFrom.add(u));\r\n        }\r\n        sendMsg(\"saveSettings\", settings.toJSON());\r\n    });\r\n\r\n    let isChanged = new Cell(false);\r\n    let initialState = new Map;\r\n    let currentState = () => {\r\n        let state = new Map;\r\n        forSelect(sPage, \"input, textarea\", input => {\r\n            state.set(input.id, (input.type === \"checkbox\") ? input.checked : input.value);\r\n        });\r\n        return state;\r\n    };\r\n    let updateInputs = () => {\r\n        checkBoxes.forEach(box => box.checked = settings.modules.get(box.id));\r\n        {\r\n            let s = \"\";\r\n            settings.hidePostsFrom.forEach(u => s += `, ${u}`);\r\n            hidePostsFromTA.value = s.substr(2);\r\n        }\r\n    };\r\n\r\n    sendMsg(\"getSettings\").then(sData => {\r\n        settings = new Settings(sData, true);\r\n        updateInputs();\r\n\r\n        // Взаимосвязь между флагами\r\n        forSelect(sPage, \"[data-disabled-if]\", node => {\r\n            let k = node.dataset[\"disabledIf\"],\r\n                c = document.getElementById(k);\r\n            if (c) {\r\n                Cell.fromInput(c).onValue(checked => node.disabled = checked);\r\n            }\r\n        });\r\n\r\n        forSelect(sPage, \"[data-enabled-if]\", node => {\r\n            let k = node.dataset[\"enabledIf\"],\r\n                c = document.getElementById(k);\r\n            if (c) {\r\n                Cell.fromInput(c).onValue(checked => node.disabled = !checked);\r\n            }\r\n        });\r\n\r\n        initialState = currentState();\r\n\r\n        sPage.classList.remove(\"hidden\");\r\n        sPage.previousElementSibling.classList.add(\"hidden\");\r\n    });\r\n\r\n    let changeHandler = () => {\r\n        let st = currentState(), changed = false;\r\n        st.forEach((v, k) => changed = changed || (v !== initialState.get(k)));\r\n        isChanged.value = changed;\r\n    };\r\n\r\n    sPage.addEventListener(\"input\", changeHandler);\r\n    sPage.addEventListener(\"change\", changeHandler);\r\n\r\n    isChanged.distinct().onValue(s => saveButton.disabled = !s);\r\n}\r\n\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/settings.js\n **/","import forSelect from \"../utils/for-select\";\r\n\r\nexport const modules = new Map; // name → module\r\n\r\nclass Module {\r\n    constructor(name, enabledByDefault = true, alwaysEnabled = false) {\r\n        this.name = name;\r\n        this.alwaysEnabled = alwaysEnabled;\r\n        this.enabledByDefault = enabledByDefault;\r\n        this._watchers = [];\r\n        this._initiators = [];\r\n    }\r\n\r\n    init(callback) {\r\n        this._initiators.push(callback);\r\n    }\r\n\r\n    watch(selector, callback) {\r\n        this._watchers.push({selector, callback});\r\n    }\r\n\r\n    _initiate(settings) {\r\n        this._initiators.forEach(c => c(settings));\r\n        this._watchers.forEach(({selector, callback}) => forSelect(document.body, selector, n => callback(n, settings)));\r\n    }\r\n\r\n    _trigger(node) {\r\n        this._watchers.forEach(({selector, callback}) => forSelect(node, selector, n => callback(n, settings)));\r\n    }\r\n}\r\n\r\nexport function registerModule(name, enabledByDefault = true, alwaysEnabled = false) {\r\n    const m = new Module(name, enabledByDefault, alwaysEnabled);\r\n    modules.set(name, m);\r\n    return m;\r\n}\r\n\r\nlet settings = null;\r\n/**\r\n *\r\n * @param {Settings} aSettings\r\n */\r\nexport function startObserver(aSettings) {\r\n    if (settings) {\r\n        return;\r\n    }\r\n    settings = aSettings;\r\n\r\n    modules.forEach(m => {\r\n        if (settings.isModuleEnabled(m)) {\r\n            m._initiate(settings);\r\n        }\r\n    });\r\n\r\n    let observer = new MutationObserver(mutations => {\r\n        mutations.forEach(mutation => {\r\n            for (let i = 0, l = mutation.addedNodes.length; i < l; i++) {\r\n                let node = mutation.addedNodes[i];\r\n                if (node.nodeType == Node.ELEMENT_NODE) {\r\n                    modules.forEach(m => {\r\n                        if (settings.isModuleEnabled(m)) {\r\n                            m._trigger(node, settings);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    observer.observe(document.body, {childList: true, subtree: true});\r\n\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/base/modules.js\n **/","import matches from \"./matches\";\r\n\r\n/**\r\n * @param {Document|DocumentFragment|Element} node\r\n * @param {string} selector\r\n * @param {function(Node)} [foo]\r\n */\r\nexport default (node, selector, foo) => {\r\n    if (node === null) return [];\r\n    var nodeList = node.querySelectorAll(selector);\r\n    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\r\n    if (matches(node, selector)) nodes.unshift(node);\r\n    if (foo) {\r\n        for (var i = 0, l = nodes.length; i < l; i++) {\r\n            foo(nodes[i]);\r\n        }\r\n    }\r\n    return nodes;\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/for-select.js\n **/","const matchesMethod = (\"matches\" in HTMLElement.prototype) ? \"matches\" : \"msMatchesSelector\";\r\n\r\n/**\r\n *\r\n * @param {HTMLElement} node\r\n * @param {String} selector\r\n * @return {Boolean}\r\n */\r\nexport default function (node, selector) { return node[matchesMethod](selector); }\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/matches.js\n **/","import {modules} from \"./modules\";\r\n\r\nexport default class Settings {\r\n\r\n    constructor(o = null, trustedData = false) {\r\n        this.modules = new Map;\r\n        modules.forEach(m => {\r\n            if (!m.alwaysEnabled) {\r\n                this.modules.set(m.name, m.enabledByDefault);\r\n            }\r\n        });\r\n\r\n        this.hidePostsFrom = new Set;\r\n\r\n        // инициализация из объекта\r\n        if (o) {\r\n            (o.modules || []).forEach(([k, v]) => {\r\n                if (trustedData || this.modules.has(k)) {\r\n                    this.modules.set(k, !!v);\r\n                }\r\n            });\r\n            (o.hidePostsFrom || []).forEach(u => this.hidePostsFrom.add(u));\r\n        }\r\n    }\r\n\r\n    toJSON() {\r\n        const o = {modules: [], hidePostsFrom: []};\r\n        this.modules.forEach((v, k) => o.modules.push([k, v]));\r\n        this.hidePostsFrom.forEach(u => o.hidePostsFrom.push(u));\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * @param {Module} m\r\n     * @return {boolean}\r\n     */\r\n    isModuleEnabled(m) {\r\n        return (m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name));\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/base/settings.js\n **/","let nextRequestId = 1;\r\n\r\nconst responseAction = \"@response\";\r\n\r\nexport default class Messenger {\r\n\r\n    constructor() {\r\n        this.__responders = new Map();\r\n        this.__listeners = new Map();\r\n\r\n        window.addEventListener('message', event => {\r\n            if (typeof event.data !== \"object\") {\r\n                return;\r\n            }\r\n            //noinspection UnnecessaryLocalVariableJS\r\n            const {data:{action, requestId, value}, source, origin} = event;\r\n\r\n            if (action === responseAction && this.__responders.has(requestId)) {\r\n                this.__responders.get(requestId)(value);\r\n                this.__responders.delete(requestId);\r\n\r\n            } else if (this.__listeners.has(action)) {\r\n                let resp = this.__listeners.get(action)(value);\r\n                source.postMessage({action: responseAction, requestId, value: resp}, origin);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {Window} window\r\n     * @param {String} origin\r\n     * @param {String} action\r\n     * @param {*} value\r\n     * @return {Promise}\r\n     */\r\n    send(window, origin, action, value = null) {\r\n        return new Promise(resolve => {\r\n            const requestId = nextRequestId++;\r\n            this.__responders.set(requestId, resolve);\r\n            window.postMessage({action, requestId, value}, origin);\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} action\r\n     * @param {function} callback\r\n     */\r\n    on(action, callback) {\r\n        this.__listeners.set(action, callback);\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/message-rpc.js\n **/","/**\r\n * @param {string} s\r\n * @return {string}\r\n */\r\nexport default function (s = \"\") {\r\n    return s.replace(/&/g, \"&amp;\")\r\n        .replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")\r\n        .replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/escape-html.js\n **/","export default class Cell {\r\n\r\n    constructor(value) {\r\n        this._value = value;\r\n        this._listeners = new Set();\r\n    }\r\n\r\n    get value() { return this._value; }\r\n\r\n    set value(v) {\r\n        this._value = v;\r\n        this.poke();\r\n    }\r\n\r\n    poke() {\r\n        this._listeners.forEach(l => l(this._value));\r\n    }\r\n\r\n    onValue(lst) {\r\n        this._listeners.add(lst);\r\n        lst(this.value);\r\n        return this;\r\n    }\r\n\r\n    unListen(lst) {\r\n        this._listeners.delete(lst);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {function(Cell, *)} foo\r\n     * @param {*} [initial]\r\n     * @return {Cell}\r\n     */\r\n    derive(foo, initial) {\r\n        var c = new Cell(initial);\r\n        this.onValue(v => foo(c, v));\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<Cell>} cells\r\n     * @return {Cell}\r\n     */\r\n    static combine(...cells) {\r\n        const cell = new Cell(cells.map(c => c.value));\r\n        cells.forEach((c, i) => c.onValue(v => {\r\n            let vv = cell.value;\r\n            vv[i] = v;\r\n            cell.value = vv;\r\n        }));\r\n        return cell;\r\n    }\r\n\r\n    map(foo) { return this.derive((c, v) => c.value = foo(v)); }\r\n\r\n    filter(foo) { return this.derive((c, v) => foo(v) && (c.value = v)); }\r\n\r\n    throttle(duration) {\r\n        let val = undefined,\r\n            timer = null;\r\n\r\n        return this.derive((c, v) => {\r\n            val = v;\r\n            if (!timer) {\r\n                timer = setTimeout(() => {\r\n                    if (val !== undefined) {\r\n                        c.value = this.value;\r\n                        val = undefined;\r\n                    }\r\n                    timer = null;\r\n                }, duration);\r\n            }\r\n        }, this.value);\r\n    }\r\n\r\n    /**\r\n     * For cell with Promise's values\r\n     * @param {*} [initial]\r\n     * @return {Cell}\r\n     */\r\n    latestPromise(initial) {\r\n        var lastProm = null;\r\n        return this.derive((c, v) => {\r\n            let prom = v;\r\n            lastProm = prom;\r\n            prom.then(res => {\r\n                if (prom === lastProm) {\r\n                    c.value = res;\r\n                }\r\n            });\r\n        }, initial);\r\n    }\r\n\r\n    distinct() {\r\n        var val;\r\n        return this.derive((c, v) => {\r\n            if (v !== val) {\r\n                val = v;\r\n                c.value = v;\r\n            }\r\n        });\r\n    }\r\n\r\n    static fromInput(input, eventNames, property) {\r\n        if (!input || !(input instanceof HTMLInputElement || input instanceof HTMLTextAreaElement || input instanceof HTMLSelectElement)) {\r\n            return new Cell(null);\r\n        }\r\n\r\n        var defaultProperty = \"value\";\r\n        if (input instanceof HTMLInputElement && (input.type === \"checkbox\" || input.type === \"radio\")) {\r\n            defaultProperty = \"checked\";\r\n        }\r\n\r\n        var events = eventNames ? eventNames.split(\" \") : [\"input\", \"change\"];\r\n        property = property || defaultProperty;\r\n\r\n        var getVal = () => (property === \"self\") ? input : input[property];\r\n\r\n        var cell = new Cell(getVal());\r\n        events.forEach(event => input.addEventListener(event, () => cell.value = getVal()));\r\n        return cell;\r\n    }\r\n\r\n    static ticker(timeout) {\r\n        let ticker = new Cell(true);\r\n        setInterval(() => ticker.value = true, timeout);\r\n        return ticker;\r\n    }\r\n\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/cell.js\n **/"],"sourceRoot":""}