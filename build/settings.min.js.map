{"version":3,"sources":["webpack:///settings.min.js","webpack:///webpack/bootstrap e2694544ea0d23d3b734?62d1","webpack:///./src/js/settings.js","webpack:///./src/js/base/modules.js?9f07","webpack:///./src/js/utils/for-select.js?ebda","webpack:///./src/js/utils/matches.js?d30e","webpack:///./src/js/utils/escape-html.js?b1be","webpack:///./src/js/base/settings.js?d926","webpack:///./src/js/utils/message-rpc.js?2bdd","webpack:///./src/js/utils/cell.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","0","_interopRequireDefault","obj","__esModule","default","getRadioValue","radioInputs","reduce","prevValue","r","checked","value","setRadioValue","forEach","_cell","_cell2","_settings","_settings2","_messageRpc","_messageRpc2","_forSelect","_forSelect2","_escapeHtml","_escapeHtml2","version","location","pathname","match","document","querySelector","appendChild","createTextNode","body","link","href","search","sPage","parentWindow","window","parent","opener","exec","alert","parentOrigin","decodeURIComponent","saveButton","getElementById","checkUpdatesButton","checkBoxes","ccModeInputs","msg","settings","addEventListener","disabled","style","width","offsetWidth","innerHTML","box","set","commentCloudsMode","parseInt","send","toJSON","e","btn","target","then","isChanged","initialState","Map","currentState","state","input","type","updateInputs","get","sData","node","k","dataset","fromInput","onValue","classList","remove","previousElementSibling","add","changeHandler","st","changed","v","distinct","s","5","_classCallCheck","instance","Constructor","TypeError","registerModule","name","enabledByDefault","arguments","length","undefined","alwaysEnabled","Module","registeredModules","startObserver","aSettings","isModuleEnabled","_initiate","observer","MutationObserver","mutations","mutation","_loop","i","l","addedNodes","nodeType","Node","ELEMENT_NODE","_trigger","observe","childList","subtree","Object","defineProperty","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","this","requiredModules","active","_watchers","_initiators","callback","push","selector","_ref","n","_ref2","6","_matches","_matches2","foo","nodeList","querySelectorAll","nodes","Array","slice","unshift","7","matchesMethod","HTMLElement","17","replace","19","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","err","isArray","_modules","Settings","_this","o","trustedData","hideAliens","has","_this2","map","some","20","_typeof","constructor","nextRequestId","responseAction","Messenger","__responders","__listeners","defaultWindow","defaultOrigin","event","data","_event$data","action","requestId","source","origin","resp","postMessage","sendEx","Promise","resolve","45","Cell","_value","_listeners","Set","lst","initial","derive","duration","val","timer","setTimeout","lastProm","prom","res","poke","_len","cells","_key","cell","vv","eventNames","property","HTMLInputElement","HTMLTextAreaElement","HTMLSelectElement","defaultProperty","events","split","getVal","ticker","timeout","setInterval"],"mappings":"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","file":"settings.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _cell = __webpack_require__(45);\n\t\n\tvar _cell2 = _interopRequireDefault(_cell);\n\t\n\tvar _settings = __webpack_require__(19);\n\t\n\tvar _settings2 = _interopRequireDefault(_settings);\n\t\n\tvar _messageRpc = __webpack_require__(20);\n\t\n\tvar _messageRpc2 = _interopRequireDefault(_messageRpc);\n\t\n\tvar _forSelect = __webpack_require__(6);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tvar _escapeHtml = __webpack_require__(17);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/** page elements fix **/\n\tvar version = location.pathname.match(/BetterFeed2\\/([^\\/]+)/);\n\tif (version) {\n\t    document.querySelector(\".version\").appendChild(document.createTextNode(version[1]));\n\t}\n\t(0, _forSelect2.default)(document.body, \".local-link\", function (link) {\n\t    return link.href += location.search;\n\t});\n\t/** page elements fix **/\n\t\n\tvar sPage = document.querySelector(\".content.settings\");\n\t\n\t// мы на странице настроек\n\tif (sPage) {\n\t    (function () {\n\t        var parentWindow = window.parent === window ? window.opener : window.parent;\n\t\n\t        if (!parentWindow || !/[?&]origin=([^&]+)/.exec(location.search)) {\n\t            alert(\"Пожалуйста, откройте эту страницу по ссылке из FreeFeed-а\");\n\t        }\n\t\n\t        var parentOrigin = decodeURIComponent(/[?&]origin=([^&]+)/.exec(location.search)[1]),\n\t            saveButton = document.getElementById(\"save-settings\"),\n\t            checkUpdatesButton = document.getElementById(\"check-updates\"),\n\t            checkBoxes = (0, _forSelect2.default)(sPage, \"input[type='checkbox']\"),\n\t            ccModeInputs = (0, _forSelect2.default)(sPage, \"input[name='comment-clouds-mode']\"),\n\t            msg = new _messageRpc2.default(parentWindow, parentOrigin);\n\t\n\t        /** @type {Settings|null} */\n\t        var settings = null;\n\t\n\t        saveButton.addEventListener(\"click\", function () {\n\t            saveButton.disabled = true;\n\t            saveButton.style.width = saveButton.offsetWidth + \"px\";\n\t            saveButton.innerHTML = (0, _escapeHtml2.default)(\"Сохраняем…\");\n\t\n\t            checkBoxes.forEach(function (box) {\n\t                return settings.modules.set(box.id, box.checked);\n\t            });\n\t            settings.commentCloudsMode = parseInt(getRadioValue(ccModeInputs));\n\t            msg.send(\"saveSettings\", settings.toJSON());\n\t        });\n\t\n\t        checkUpdatesButton.addEventListener(\"click\", function (e) {\n\t            var btn = e.target;\n\t            btn.disabled = true;\n\t            msg.send(\"checkUpdates\").then(function () {\n\t                return btn.disabled = false;\n\t            });\n\t        });\n\t\n\t        var isChanged = new _cell2.default(false);\n\t        var initialState = new Map();\n\t        var currentState = function currentState() {\n\t            var state = new Map();\n\t            (0, _forSelect2.default)(sPage, \"input, textarea\", function (input) {\n\t                if (input.id) {\n\t                    state.set(input.id, input.type === \"checkbox\" ? input.checked : input.value);\n\t                }\n\t            });\n\t            state.set(\"comment-clouds-mode\", getRadioValue(ccModeInputs));\n\t            return state;\n\t        };\n\t        var updateInputs = function updateInputs() {\n\t            checkBoxes.forEach(function (box) {\n\t                return box.checked = settings.modules.get(box.id);\n\t            });\n\t            setRadioValue(ccModeInputs, settings.commentCloudsMode);\n\t        };\n\t\n\t        msg.send(\"getSettings\").then(function (sData) {\n\t            settings = new _settings2.default(sData, true);\n\t            updateInputs();\n\t\n\t            // Взаимосвязь между флагами\n\t            (0, _forSelect2.default)(sPage, \"[data-disabled-if]\", function (node) {\n\t                var k = node.dataset[\"disabledIf\"],\n\t                    c = document.getElementById(k);\n\t                if (c) {\n\t                    _cell2.default.fromInput(c).onValue(function (checked) {\n\t                        return node.disabled = checked;\n\t                    });\n\t                }\n\t            });\n\t\n\t            (0, _forSelect2.default)(sPage, \"[data-enabled-if]\", function (node) {\n\t                var k = node.dataset[\"enabledIf\"],\n\t                    c = document.getElementById(k);\n\t                if (c) {\n\t                    _cell2.default.fromInput(c).onValue(function (checked) {\n\t                        return node.disabled = !checked;\n\t                    });\n\t                }\n\t            });\n\t\n\t            initialState = currentState();\n\t\n\t            sPage.classList.remove(\"hidden\");\n\t            sPage.previousElementSibling.classList.add(\"hidden\");\n\t        });\n\t\n\t        var changeHandler = function changeHandler() {\n\t            var st = currentState(),\n\t                changed = false;\n\t            st.forEach(function (v, k) {\n\t                return changed = changed || v !== initialState.get(k);\n\t            });\n\t            isChanged.value = changed;\n\t        };\n\t\n\t        sPage.addEventListener(\"input\", changeHandler);\n\t        sPage.addEventListener(\"change\", changeHandler);\n\t\n\t        isChanged.distinct().onValue(function (s) {\n\t            return saveButton.disabled = !s;\n\t        });\n\t    })();\n\t}\n\t\n\tfunction getRadioValue(radioInputs) {\n\t    return radioInputs.reduce(function (prevValue, r) {\n\t        return r.checked ? r.value : prevValue;\n\t    }, null);\n\t}\n\t\n\tfunction setRadioValue(radioInputs, value) {\n\t    radioInputs.forEach(function (r) {\n\t        return r.checked = r.value == value;\n\t    });\n\t}\n\n/***/ },\n\n/***/ 5:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.registeredModules = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.registerModule = registerModule;\n\texports.startObserver = startObserver;\n\t\n\tvar _forSelect = __webpack_require__(6);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar registeredModules = exports.registeredModules = new Map(); // name → module\n\t\n\tvar Module = function () {\n\t    function Module(name) {\n\t        var enabledByDefault = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\t        var alwaysEnabled = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t        _classCallCheck(this, Module);\n\t\n\t        this.name = name;\n\t        this.alwaysEnabled = alwaysEnabled;\n\t        this.enabledByDefault = enabledByDefault;\n\t        this.requiredModules = [];\n\t        /**\r\n\t         * Флаг, позволяющий отключить активность модуля, даже если он разрешён в настройках.\r\n\t         * Например, если фронтенд или браузер не поддерживает необходимые фичи.\r\n\t         * @type {boolean}\r\n\t         */\n\t        this.active = true;\n\t        this._watchers = [];\n\t        this._initiators = [];\n\t    }\n\t\n\t    _createClass(Module, [{\n\t        key: \"init\",\n\t        value: function init(callback) {\n\t            this._initiators.push(callback);\n\t        }\n\t    }, {\n\t        key: \"watch\",\n\t        value: function watch(selector, callback) {\n\t            this._watchers.push({ selector: selector, callback: callback });\n\t        }\n\t    }, {\n\t        key: \"required\",\n\t        value: function required(name) {\n\t            this.requiredModules.push(name);\n\t        }\n\t    }, {\n\t        key: \"_initiate\",\n\t        value: function _initiate(settings) {\n\t            if (!this.active) {\n\t                return;\n\t            }\n\t            this._initiators.forEach(function (c) {\n\t                return c(settings);\n\t            });\n\t            this._watchers.forEach(function (_ref) {\n\t                var selector = _ref.selector;\n\t                var callback = _ref.callback;\n\t                return (0, _forSelect2.default)(document.body, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }, {\n\t        key: \"_trigger\",\n\t        value: function _trigger(node) {\n\t            if (!this.active) {\n\t                return;\n\t            }\n\t            this._watchers.forEach(function (_ref2) {\n\t                var selector = _ref2.selector;\n\t                var callback = _ref2.callback;\n\t                return (0, _forSelect2.default)(node, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Module;\n\t}();\n\t\n\tfunction registerModule(name) {\n\t    var enabledByDefault = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\t    var alwaysEnabled = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t    var m = new Module(name, enabledByDefault, alwaysEnabled);\n\t    registeredModules.set(name, m);\n\t    return m;\n\t}\n\t\n\tvar settings = null;\n\t/**\r\n\t *\r\n\t * @param {Settings} aSettings\r\n\t */\n\tfunction startObserver(aSettings) {\n\t    if (settings) {\n\t        return;\n\t    }\n\t    settings = aSettings;\n\t\n\t    registeredModules.forEach(function (m) {\n\t        if (settings.isModuleEnabled(m)) {\n\t            m._initiate(settings);\n\t        }\n\t    });\n\t\n\t    var observer = new MutationObserver(function (mutations) {\n\t        mutations.forEach(function (mutation) {\n\t            var _loop = function _loop(i, l) {\n\t                var node = mutation.addedNodes[i];\n\t                if (node.nodeType == Node.ELEMENT_NODE) {\n\t                    registeredModules.forEach(function (m) {\n\t                        if (settings.isModuleEnabled(m)) {\n\t                            m._trigger(node, settings);\n\t                        }\n\t                    });\n\t                }\n\t            };\n\t\n\t            for (var i = 0, l = mutation.addedNodes.length; i < l; i++) {\n\t                _loop(i, l);\n\t            }\n\t        });\n\t    });\n\t\n\t    observer.observe(document.body, { childList: true, subtree: true });\n\t}\n\n/***/ },\n\n/***/ 6:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _matches = __webpack_require__(7);\n\t\n\tvar _matches2 = _interopRequireDefault(_matches);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\r\n\t * @param {Document|DocumentFragment|Element} node\r\n\t * @param {string} selector\r\n\t * @param {function(Node)} [foo]\r\n\t */\n\t\n\texports.default = function (node, selector, foo) {\n\t    if (node === null) return [];\n\t    var nodeList = node.querySelectorAll(selector);\n\t    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\n\t    if ((0, _matches2.default)(node, selector)) nodes.unshift(node);\n\t    if (foo) {\n\t        for (var i = 0, l = nodes.length; i < l; i++) {\n\t            foo(nodes[i]);\n\t        }\n\t    }\n\t    return nodes;\n\t};\n\n/***/ },\n\n/***/ 7:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (node, selector) {\n\t  return node[matchesMethod](selector);\n\t};\n\t\n\tvar matchesMethod = \"matches\" in HTMLElement.prototype ? \"matches\" : \"msMatchesSelector\";\n\t\n\t/**\r\n\t *\r\n\t * @param {HTMLElement} node\r\n\t * @param {String} selector\r\n\t * @return {Boolean}\r\n\t */\n\n/***/ },\n\n/***/ 17:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function () {\n\t  var s = arguments.length <= 0 || arguments[0] === undefined ? \"\" : arguments[0];\n\t\n\t  return s.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\n\t};\n\n/***/ },\n\n/***/ 19:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _modules = __webpack_require__(5);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Settings = function () {\n\t    function Settings() {\n\t        var _this = this;\n\t\n\t        var o = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n\t        var trustedData = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\t\n\t        _classCallCheck(this, Settings);\n\t\n\t        this.modules = new Map();\n\t        _modules.registeredModules.forEach(function (m) {\n\t            if (!m.alwaysEnabled) {\n\t                _this.modules.set(m.name, m.enabledByDefault);\n\t            }\n\t        });\n\t\n\t        this.hideAliens = false;\n\t        this.commentCloudsMode = 2;\n\t\n\t        // инициализация из объекта\n\t        if (o) {\n\t            (o.modules || []).forEach(function (_ref) {\n\t                var _ref2 = _slicedToArray(_ref, 2);\n\t\n\t                var k = _ref2[0];\n\t                var v = _ref2[1];\n\t\n\t                if (trustedData || _this.modules.has(k)) {\n\t                    _this.modules.set(k, !!v);\n\t                }\n\t            });\n\t            this.hideAliens = !!o.hideAliens;\n\t            if (o.commentCloudsMode === 1 || o.commentCloudsMode === 2) {\n\t                this.commentCloudsMode = o.commentCloudsMode;\n\t            }\n\t        }\n\t    }\n\t\n\t    _createClass(Settings, [{\n\t        key: \"toJSON\",\n\t        value: function toJSON() {\n\t            var o = { modules: [] };\n\t            this.modules.forEach(function (v, k) {\n\t                return o.modules.push([k, v]);\n\t            });\n\t            o.hideAliens = this.hideAliens;\n\t            o.commentCloudsMode = this.commentCloudsMode;\n\t            return o;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Module} m\r\n\t         * @return {boolean}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"isModuleEnabled\",\n\t        value: function isModuleEnabled(m) {\n\t            var _this2 = this;\n\t\n\t            return m && (m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name)) && !m.requiredModules.map(function (name) {\n\t                return _modules.registeredModules.get(name);\n\t            }).some(function (m) {\n\t                return !_this2.isModuleEnabled(m);\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Settings;\n\t}();\n\t\n\texports.default = Settings;\n\n/***/ },\n\n/***/ 20:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nextRequestId = 1;\n\t\n\tvar responseAction = \"@response\";\n\t\n\tvar Messenger = function () {\n\t    function Messenger() {\n\t        var _this = this;\n\t\n\t        var parentWindow = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n\t        var parentOrigin = arguments.length <= 1 || arguments[1] === undefined ? \"\" : arguments[1];\n\t\n\t        _classCallCheck(this, Messenger);\n\t\n\t        this.__responders = new Map();\n\t        this.__listeners = new Map();\n\t\n\t        this.defaultWindow = parentWindow;\n\t        this.defaultOrigin = parentOrigin;\n\t\n\t        window.addEventListener('message', function (event) {\n\t            if (_typeof(event.data) !== \"object\") {\n\t                return;\n\t            }\n\t            //noinspection UnnecessaryLocalVariableJS\n\t            var _event$data = event.data;\n\t            var action = _event$data.action;\n\t            var requestId = _event$data.requestId;\n\t            var value = _event$data.value;\n\t            var source = event.source;\n\t            var origin = event.origin;\n\t\n\t\n\t            if (action === responseAction && _this.__responders.has(requestId)) {\n\t                _this.__responders.get(requestId)(value);\n\t                _this.__responders.delete(requestId);\n\t            } else if (_this.__listeners.has(action)) {\n\t                var resp = _this.__listeners.get(action)(value);\n\t                source.postMessage({ action: responseAction, requestId: requestId, value: resp }, origin);\n\t            }\n\t        });\n\t    }\n\t\n\t    /**\r\n\t     *\r\n\t     * @param {String} action\r\n\t     * @param {*} value\r\n\t     * @return {Promise}\r\n\t     */\n\t\n\t\n\t    _createClass(Messenger, [{\n\t        key: \"send\",\n\t        value: function send(action) {\n\t            var value = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];\n\t\n\t            return this.sendEx(this.defaultWindow, this.defaultOrigin, action, value);\n\t        }\n\t\n\t        /**\r\n\t         *\r\n\t         * @param {Window} window\r\n\t         * @param {String} origin\r\n\t         * @param {String} action\r\n\t         * @param {*} value\r\n\t         * @return {Promise}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"sendEx\",\n\t        value: function sendEx(window, origin, action) {\n\t            var _this2 = this;\n\t\n\t            var value = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t            return new Promise(function (resolve) {\n\t                var requestId = nextRequestId++;\n\t                _this2.__responders.set(requestId, resolve);\n\t                window.postMessage({ action: action, requestId: requestId, value: value }, origin);\n\t            });\n\t        }\n\t\n\t        /**\r\n\t         *\r\n\t         * @param {String} action\r\n\t         * @param {function} callback\r\n\t         */\n\t\n\t    }, {\n\t        key: \"on\",\n\t        value: function on(action, callback) {\n\t            this.__listeners.set(action, callback);\n\t        }\n\t    }]);\n\t\n\t    return Messenger;\n\t}();\n\t\n\texports.default = Messenger;\n\n/***/ },\n\n/***/ 45:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Cell = function () {\n\t    function Cell(value) {\n\t        _classCallCheck(this, Cell);\n\t\n\t        this._value = value;\n\t        this._listeners = new Set();\n\t    }\n\t\n\t    _createClass(Cell, [{\n\t        key: \"poke\",\n\t        value: function poke() {\n\t            var _this = this;\n\t\n\t            this._listeners.forEach(function (l) {\n\t                return l(_this._value);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"onValue\",\n\t        value: function onValue(lst) {\n\t            this._listeners.add(lst);\n\t            lst(this.value);\n\t            return this;\n\t        }\n\t    }, {\n\t        key: \"unListen\",\n\t        value: function unListen(lst) {\n\t            this._listeners.delete(lst);\n\t            return this;\n\t        }\n\t\n\t        /**\r\n\t         * @param {function(Cell, *)} foo\r\n\t         * @param {*} [initial]\r\n\t         * @return {Cell}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"derive\",\n\t        value: function derive(foo, initial) {\n\t            var c = new Cell(initial);\n\t            this.onValue(function (v) {\n\t                return foo(c, v);\n\t            });\n\t            return c;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Array.<Cell>} cells\r\n\t         * @return {Cell}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"map\",\n\t        value: function map(foo) {\n\t            return this.derive(function (c, v) {\n\t                return c.value = foo(v);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"filter\",\n\t        value: function filter(foo) {\n\t            return this.derive(function (c, v) {\n\t                return foo(v) && (c.value = v);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"throttle\",\n\t        value: function throttle(duration) {\n\t            var _this2 = this;\n\t\n\t            var val = undefined,\n\t                timer = null;\n\t\n\t            return this.derive(function (c, v) {\n\t                val = v;\n\t                if (!timer) {\n\t                    timer = setTimeout(function () {\n\t                        if (val !== undefined) {\n\t                            c.value = _this2.value;\n\t                            val = undefined;\n\t                        }\n\t                        timer = null;\n\t                    }, duration);\n\t                }\n\t            }, this.value);\n\t        }\n\t\n\t        /**\r\n\t         * For cell with Promise's values\r\n\t         * @param {*} [initial]\r\n\t         * @return {Cell}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"latestPromise\",\n\t        value: function latestPromise(initial) {\n\t            var lastProm = null;\n\t            return this.derive(function (c, v) {\n\t                var prom = v;\n\t                lastProm = prom;\n\t                prom.then(function (res) {\n\t                    if (prom === lastProm) {\n\t                        c.value = res;\n\t                    }\n\t                });\n\t            }, initial);\n\t        }\n\t    }, {\n\t        key: \"distinct\",\n\t        value: function distinct() {\n\t            var val;\n\t            return this.derive(function (c, v) {\n\t                if (v !== val) {\n\t                    val = v;\n\t                    c.value = v;\n\t                }\n\t            });\n\t        }\n\t    }, {\n\t        key: \"value\",\n\t        get: function get() {\n\t            return this._value;\n\t        },\n\t        set: function set(v) {\n\t            this._value = v;\n\t            this.poke();\n\t        }\n\t    }], [{\n\t        key: \"combine\",\n\t        value: function combine() {\n\t            for (var _len = arguments.length, cells = Array(_len), _key = 0; _key < _len; _key++) {\n\t                cells[_key] = arguments[_key];\n\t            }\n\t\n\t            var cell = new Cell(cells.map(function (c) {\n\t                return c.value;\n\t            }));\n\t            cells.forEach(function (c, i) {\n\t                return c.onValue(function (v) {\n\t                    var vv = cell.value;\n\t                    vv[i] = v;\n\t                    cell.value = vv;\n\t                });\n\t            });\n\t            return cell;\n\t        }\n\t    }, {\n\t        key: \"fromInput\",\n\t        value: function fromInput(input, eventNames, property) {\n\t            if (!input || !(input instanceof HTMLInputElement || input instanceof HTMLTextAreaElement || input instanceof HTMLSelectElement)) {\n\t                return new Cell(null);\n\t            }\n\t\n\t            var defaultProperty = \"value\";\n\t            if (input instanceof HTMLInputElement && (input.type === \"checkbox\" || input.type === \"radio\")) {\n\t                defaultProperty = \"checked\";\n\t            }\n\t\n\t            var events = eventNames ? eventNames.split(\" \") : [\"input\", \"change\"];\n\t            property = property || defaultProperty;\n\t\n\t            var getVal = function getVal() {\n\t                return property === \"self\" ? input : input[property];\n\t            };\n\t\n\t            var cell = new Cell(getVal());\n\t            events.forEach(function (event) {\n\t                return input.addEventListener(event, function () {\n\t                    return cell.value = getVal();\n\t                });\n\t            });\n\t            return cell;\n\t        }\n\t    }, {\n\t        key: \"ticker\",\n\t        value: function ticker(timeout) {\n\t            var ticker = new Cell(true);\n\t            setInterval(function () {\n\t                return ticker.value = true;\n\t            }, timeout);\n\t            return ticker;\n\t        }\n\t    }]);\n\t\n\t    return Cell;\n\t}();\n\t\n\texports.default = Cell;\n\n/***/ }\n\n/******/ });\n\n\n/** WEBPACK FOOTER **\n ** settings.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap e2694544ea0d23d3b734\n **/","import Cell      from \"./utils/cell\";\r\nimport Settings  from \"./base/settings\";\r\nimport Messenger from \"./utils/message-rpc\";\r\nimport forSelect from \"./utils/for-select\";\r\nimport escapeHTML from \"./utils/escape-html\";\r\n\r\n\r\n/** page elements fix **/\r\nconst version = location.pathname.match(/BetterFeed2\\/([^\\/]+)/);\r\nif (version) {\r\n    document.querySelector(\".version\").appendChild(document.createTextNode(version[1]));\r\n}\r\nforSelect(document.body, \".local-link\", link => link.href += location.search);\r\n/** page elements fix **/\r\n\r\nconst sPage = document.querySelector(\".content.settings\");\r\n\r\n// мы на странице настроек\r\nif (sPage) {\r\n    const parentWindow = (window.parent === window) ? window.opener : window.parent;\r\n\r\n    if (!parentWindow || !/[?&]origin=([^&]+)/.exec(location.search)) {\r\n        alert(\"Пожалуйста, откройте эту страницу по ссылке из FreeFeed-а\");\r\n    }\r\n\r\n    const\r\n        parentOrigin = decodeURIComponent(/[?&]origin=([^&]+)/.exec(location.search)[1]),\r\n        saveButton = document.getElementById(\"save-settings\"),\r\n        checkUpdatesButton = document.getElementById(\"check-updates\"),\r\n        checkBoxes = forSelect(sPage, \"input[type='checkbox']\"),\r\n        ccModeInputs = forSelect(sPage, \"input[name='comment-clouds-mode']\"),\r\n        msg = new Messenger(parentWindow, parentOrigin);\r\n\r\n    /** @type {Settings|null} */\r\n    let settings = null;\r\n\r\n    saveButton.addEventListener(\"click\", () => {\r\n        saveButton.disabled = true;\r\n        saveButton.style.width = saveButton.offsetWidth + \"px\";\r\n        saveButton.innerHTML = escapeHTML(\"Сохраняем\\u2026\");\r\n\r\n        checkBoxes.forEach(box => settings.modules.set(box.id, box.checked));\r\n        settings.commentCloudsMode = parseInt(getRadioValue(ccModeInputs));\r\n        msg.send(\"saveSettings\", settings.toJSON());\r\n    });\r\n\r\n    checkUpdatesButton.addEventListener(\"click\", e => {\r\n        const btn = e.target;\r\n        btn.disabled = true;\r\n        msg.send(\"checkUpdates\").then(() => btn.disabled = false);\r\n    });\r\n\r\n    let isChanged = new Cell(false);\r\n    let initialState = new Map;\r\n    let currentState = () => {\r\n        let state = new Map;\r\n        forSelect(sPage, \"input, textarea\", input => {\r\n            if (input.id) {\r\n                state.set(input.id, (input.type === \"checkbox\") ? input.checked : input.value);\r\n            }\r\n        });\r\n        state.set(\"comment-clouds-mode\", getRadioValue(ccModeInputs));\r\n        return state;\r\n    };\r\n    let updateInputs = () => {\r\n        checkBoxes.forEach(box => box.checked = settings.modules.get(box.id));\r\n        setRadioValue(ccModeInputs, settings.commentCloudsMode);\r\n    };\r\n\r\n    msg.send(\"getSettings\").then(sData => {\r\n        settings = new Settings(sData, true);\r\n        updateInputs();\r\n\r\n        // Взаимосвязь между флагами\r\n        forSelect(sPage, \"[data-disabled-if]\", node => {\r\n            let k = node.dataset[\"disabledIf\"],\r\n                c = document.getElementById(k);\r\n            if (c) {\r\n                Cell.fromInput(c).onValue(checked => node.disabled = checked);\r\n            }\r\n        });\r\n\r\n        forSelect(sPage, \"[data-enabled-if]\", node => {\r\n            let k = node.dataset[\"enabledIf\"],\r\n                c = document.getElementById(k);\r\n            if (c) {\r\n                Cell.fromInput(c).onValue(checked => node.disabled = !checked);\r\n            }\r\n        });\r\n\r\n        initialState = currentState();\r\n\r\n        sPage.classList.remove(\"hidden\");\r\n        sPage.previousElementSibling.classList.add(\"hidden\");\r\n    });\r\n\r\n    let changeHandler = () => {\r\n        let st = currentState(), changed = false;\r\n        st.forEach((v, k) => changed = changed || (v !== initialState.get(k)));\r\n        isChanged.value = changed;\r\n    };\r\n\r\n    sPage.addEventListener(\"input\", changeHandler);\r\n    sPage.addEventListener(\"change\", changeHandler);\r\n\r\n    isChanged.distinct().onValue(s => saveButton.disabled = !s);\r\n}\r\n\r\nfunction getRadioValue(radioInputs) {\r\n    return radioInputs.reduce((prevValue, r) => r.checked ? r.value : prevValue, null);\r\n}\r\n\r\nfunction setRadioValue(radioInputs, value) {\r\n    radioInputs.forEach(r => r.checked = (r.value == value));\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/settings.js\n **/","import forSelect from \"../utils/for-select\";\r\n\r\nexport const registeredModules = new Map(); // name → module\r\n\r\nclass Module {\r\n    constructor(name, enabledByDefault = true, alwaysEnabled = false) {\r\n        this.name = name;\r\n        this.alwaysEnabled = alwaysEnabled;\r\n        this.enabledByDefault = enabledByDefault;\r\n        this.requiredModules = [];\r\n        /**\r\n         * Флаг, позволяющий отключить активность модуля, даже если он разрешён в настройках.\r\n         * Например, если фронтенд или браузер не поддерживает необходимые фичи.\r\n         * @type {boolean}\r\n         */\r\n        this.active = true;\r\n        this._watchers = [];\r\n        this._initiators = [];\r\n    }\r\n\r\n    init(callback) {\r\n        this._initiators.push(callback);\r\n    }\r\n\r\n    watch(selector, callback) {\r\n        this._watchers.push({selector, callback});\r\n    }\r\n\r\n    required(name) {\r\n        this.requiredModules.push(name);\r\n    }\r\n\r\n    _initiate(settings) {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n        this._initiators.forEach(c => c(settings));\r\n        this._watchers.forEach(({selector, callback}) => forSelect(document.body, selector, n => callback(n, settings)));\r\n    }\r\n\r\n    _trigger(node) {\r\n        if (!this.active) {\r\n            return;\r\n        }\r\n        this._watchers.forEach(({selector, callback}) => forSelect(node, selector, n => callback(n, settings)));\r\n    }\r\n}\r\n\r\nexport function registerModule(name, enabledByDefault = true, alwaysEnabled = false) {\r\n    const m = new Module(name, enabledByDefault, alwaysEnabled);\r\n    registeredModules.set(name, m);\r\n    return m;\r\n}\r\n\r\nlet settings = null;\r\n/**\r\n *\r\n * @param {Settings} aSettings\r\n */\r\nexport function startObserver(aSettings) {\r\n    if (settings) {\r\n        return;\r\n    }\r\n    settings = aSettings;\r\n\r\n    registeredModules.forEach(m => {\r\n        if (settings.isModuleEnabled(m)) {\r\n            m._initiate(settings);\r\n        }\r\n    });\r\n\r\n    let observer = new MutationObserver(mutations => {\r\n        mutations.forEach(mutation => {\r\n            for (let i = 0, l = mutation.addedNodes.length; i < l; i++) {\r\n                let node = mutation.addedNodes[i];\r\n                if (node.nodeType == Node.ELEMENT_NODE) {\r\n                    registeredModules.forEach(m => {\r\n                        if (settings.isModuleEnabled(m)) {\r\n                            m._trigger(node, settings);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    observer.observe(document.body, {childList: true, subtree: true});\r\n\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/base/modules.js\n **/","import matches from \"./matches\";\r\n\r\n/**\r\n * @param {Document|DocumentFragment|Element} node\r\n * @param {string} selector\r\n * @param {function(Node)} [foo]\r\n */\r\nexport default (node, selector, foo) => {\r\n    if (node === null) return [];\r\n    var nodeList = node.querySelectorAll(selector);\r\n    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\r\n    if (matches(node, selector)) nodes.unshift(node);\r\n    if (foo) {\r\n        for (var i = 0, l = nodes.length; i < l; i++) {\r\n            foo(nodes[i]);\r\n        }\r\n    }\r\n    return nodes;\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/for-select.js\n **/","const matchesMethod = (\"matches\" in HTMLElement.prototype) ? \"matches\" : \"msMatchesSelector\";\r\n\r\n/**\r\n *\r\n * @param {HTMLElement} node\r\n * @param {String} selector\r\n * @return {Boolean}\r\n */\r\nexport default function (node, selector) { return node[matchesMethod](selector); }\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/matches.js\n **/","/**\r\n * @param {string} s\r\n * @return {string}\r\n */\r\nexport default function (s = \"\") {\r\n    return s.replace(/&/g, \"&amp;\")\r\n        .replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")\r\n        .replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/escape-html.js\n **/","import {registeredModules} from \"./modules\";\r\n\r\nexport default class Settings {\r\n\r\n    constructor(o = null, trustedData = false) {\r\n        this.modules = new Map;\r\n        registeredModules.forEach(m => {\r\n            if (!m.alwaysEnabled) {\r\n                this.modules.set(m.name, m.enabledByDefault);\r\n            }\r\n        });\r\n\r\n        this.hideAliens = false;\r\n        this.commentCloudsMode = 2;\r\n\r\n        // инициализация из объекта\r\n        if (o) {\r\n            (o.modules || []).forEach(([k, v]) => {\r\n                if (trustedData || this.modules.has(k)) {\r\n                    this.modules.set(k, !!v);\r\n                }\r\n            });\r\n            this.hideAliens = !!o.hideAliens;\r\n            if (o.commentCloudsMode === 1 || o.commentCloudsMode === 2) {\r\n                this.commentCloudsMode = o.commentCloudsMode;\r\n            }\r\n        }\r\n    }\r\n\r\n    toJSON() {\r\n        const o = {modules: []};\r\n        this.modules.forEach((v, k) => o.modules.push([k, v]));\r\n        o.hideAliens = this.hideAliens;\r\n        o.commentCloudsMode = this.commentCloudsMode;\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * @param {Module} m\r\n     * @return {boolean}\r\n     */\r\n    isModuleEnabled(m) {\r\n        return (\r\n            m\r\n            && (m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name))\r\n            && !m.requiredModules.map(name => registeredModules.get(name)).some(m => !this.isModuleEnabled(m))\r\n        );\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/base/settings.js\n **/","let nextRequestId = 1;\r\n\r\nconst responseAction = \"@response\";\r\n\r\nexport default class Messenger {\r\n\r\n    constructor(parentWindow = null, parentOrigin = \"\") {\r\n        this.__responders = new Map();\r\n        this.__listeners = new Map();\r\n\r\n        this.defaultWindow = parentWindow;\r\n        this.defaultOrigin = parentOrigin;\r\n\r\n        window.addEventListener('message', event => {\r\n            if (typeof event.data !== \"object\") {\r\n                return;\r\n            }\r\n            //noinspection UnnecessaryLocalVariableJS\r\n            const {data:{action, requestId, value}, source, origin} = event;\r\n\r\n            if (action === responseAction && this.__responders.has(requestId)) {\r\n                this.__responders.get(requestId)(value);\r\n                this.__responders.delete(requestId);\r\n\r\n            } else if (this.__listeners.has(action)) {\r\n                let resp = this.__listeners.get(action)(value);\r\n                source.postMessage({action: responseAction, requestId, value: resp}, origin);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} action\r\n     * @param {*} value\r\n     * @return {Promise}\r\n     */\r\n    send(action, value = null) {\r\n        return this.sendEx(this.defaultWindow, this.defaultOrigin, action, value);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {Window} window\r\n     * @param {String} origin\r\n     * @param {String} action\r\n     * @param {*} value\r\n     * @return {Promise}\r\n     */\r\n    sendEx(window, origin, action, value = null) {\r\n        return new Promise(resolve => {\r\n            const requestId = nextRequestId++;\r\n            this.__responders.set(requestId, resolve);\r\n            window.postMessage({action, requestId, value}, origin);\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} action\r\n     * @param {function} callback\r\n     */\r\n    on(action, callback) {\r\n        this.__listeners.set(action, callback);\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/message-rpc.js\n **/","export default class Cell {\r\n\r\n    constructor(value) {\r\n        this._value = value;\r\n        this._listeners = new Set();\r\n    }\r\n\r\n    get value() { return this._value; }\r\n\r\n    set value(v) {\r\n        this._value = v;\r\n        this.poke();\r\n    }\r\n\r\n    poke() {\r\n        this._listeners.forEach(l => l(this._value));\r\n    }\r\n\r\n    onValue(lst) {\r\n        this._listeners.add(lst);\r\n        lst(this.value);\r\n        return this;\r\n    }\r\n\r\n    unListen(lst) {\r\n        this._listeners.delete(lst);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {function(Cell, *)} foo\r\n     * @param {*} [initial]\r\n     * @return {Cell}\r\n     */\r\n    derive(foo, initial) {\r\n        var c = new Cell(initial);\r\n        this.onValue(v => foo(c, v));\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<Cell>} cells\r\n     * @return {Cell}\r\n     */\r\n    static combine(...cells) {\r\n        const cell = new Cell(cells.map(c => c.value));\r\n        cells.forEach((c, i) => c.onValue(v => {\r\n            let vv = cell.value;\r\n            vv[i] = v;\r\n            cell.value = vv;\r\n        }));\r\n        return cell;\r\n    }\r\n\r\n    map(foo) { return this.derive((c, v) => c.value = foo(v)); }\r\n\r\n    filter(foo) { return this.derive((c, v) => foo(v) && (c.value = v)); }\r\n\r\n    throttle(duration) {\r\n        let val = undefined,\r\n            timer = null;\r\n\r\n        return this.derive((c, v) => {\r\n            val = v;\r\n            if (!timer) {\r\n                timer = setTimeout(() => {\r\n                    if (val !== undefined) {\r\n                        c.value = this.value;\r\n                        val = undefined;\r\n                    }\r\n                    timer = null;\r\n                }, duration);\r\n            }\r\n        }, this.value);\r\n    }\r\n\r\n    /**\r\n     * For cell with Promise's values\r\n     * @param {*} [initial]\r\n     * @return {Cell}\r\n     */\r\n    latestPromise(initial) {\r\n        var lastProm = null;\r\n        return this.derive((c, v) => {\r\n            let prom = v;\r\n            lastProm = prom;\r\n            prom.then(res => {\r\n                if (prom === lastProm) {\r\n                    c.value = res;\r\n                }\r\n            });\r\n        }, initial);\r\n    }\r\n\r\n    distinct() {\r\n        var val;\r\n        return this.derive((c, v) => {\r\n            if (v !== val) {\r\n                val = v;\r\n                c.value = v;\r\n            }\r\n        });\r\n    }\r\n\r\n    static fromInput(input, eventNames, property) {\r\n        if (!input || !(input instanceof HTMLInputElement || input instanceof HTMLTextAreaElement || input instanceof HTMLSelectElement)) {\r\n            return new Cell(null);\r\n        }\r\n\r\n        var defaultProperty = \"value\";\r\n        if (input instanceof HTMLInputElement && (input.type === \"checkbox\" || input.type === \"radio\")) {\r\n            defaultProperty = \"checked\";\r\n        }\r\n\r\n        var events = eventNames ? eventNames.split(\" \") : [\"input\", \"change\"];\r\n        property = property || defaultProperty;\r\n\r\n        var getVal = () => (property === \"self\") ? input : input[property];\r\n\r\n        var cell = new Cell(getVal());\r\n        events.forEach(event => input.addEventListener(event, () => cell.value = getVal()));\r\n        return cell;\r\n    }\r\n\r\n    static ticker(timeout) {\r\n        let ticker = new Cell(true);\r\n        setInterval(() => ticker.value = true, timeout);\r\n        return ticker;\r\n    }\r\n\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/cell.js\n **/"],"sourceRoot":""}