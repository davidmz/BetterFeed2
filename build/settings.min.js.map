{"version":3,"sources":["webpack:///settings.min.js","webpack:///webpack/bootstrap 319e8f25f202c0cc5b16?52af","webpack:///./src/js/settings.js","webpack:///./src/js/base/modules.js?9f07","webpack:///./src/js/utils/for-select.js?ebda","webpack:///./src/js/utils/matches.js?d30e","webpack:///./src/js/utils/escape-html.js?b1be","webpack:///./src/js/base/settings.js?d926","webpack:///./src/js/utils/message-rpc.js?2bdd","webpack:///./src/js/utils/cell.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","0","_interopRequireDefault","obj","__esModule","default","_cell","_cell2","_settings","_settings2","_messageRpc","_messageRpc2","_forSelect","_forSelect2","_escapeHtml","_escapeHtml2","version","location","pathname","match","document","querySelector","appendChild","createTextNode","body","link","href","search","sPage","parentWindow","window","parent","opener","exec","alert","parentOrigin","decodeURIComponent","saveButton","getElementById","checkUpdatesButton","checkBoxes","hidePostsFromTA","msg","settings","addEventListener","disabled","style","width","offsetWidth","innerHTML","forEach","box","set","checked","hidePostsFrom","clear","value","toLowerCase","u","add","send","toJSON","e","btn","target","then","isChanged","initialState","Map","currentState","state","input","type","updateInputs","get","s","substr","sData","node","k","dataset","fromInput","onValue","classList","remove","previousElementSibling","changeHandler","st","changed","v","distinct","5","_classCallCheck","instance","Constructor","TypeError","registerModule","name","enabledByDefault","arguments","length","undefined","alwaysEnabled","Module","registeredModules","startObserver","aSettings","isModuleEnabled","_initiate","observer","MutationObserver","mutations","mutation","_loop","i","l","addedNodes","nodeType","Node","ELEMENT_NODE","_trigger","observe","childList","subtree","Object","defineProperty","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","key","protoProps","staticProps","prototype","this","requiredModules","_watchers","_initiators","callback","push","selector","_ref","n","_ref2","6","_matches","_matches2","foo","nodeList","querySelectorAll","nodes","Array","slice","unshift","7","matchesMethod","HTMLElement","16","replace","18","_slicedToArray","sliceIterator","arr","_arr","_n","_d","_e","_s","_i","Symbol","iterator","next","done","err","isArray","_modules","Settings","_this","o","trustedData","Set","hideAliens","has","_this2","map","some","19","_typeof","constructor","nextRequestId","responseAction","Messenger","__responders","__listeners","defaultWindow","defaultOrigin","event","data","_event$data","action","requestId","source","origin","resp","postMessage","sendEx","Promise","resolve","46","Cell","_value","_listeners","lst","initial","derive","duration","val","timer","setTimeout","lastProm","prom","res","poke","_len","cells","_key","cell","vv","eventNames","property","HTMLInputElement","HTMLTextAreaElement","HTMLSelectElement","defaultProperty","events","split","getVal","ticker","timeout","setInterval"],"mappings":"CAAS,SAAUA,GCInB,QAAAC,GAAAC,GAGA,GAAAC,EAAAD,GACA,MAAAC,GAAAD,GAAAE,OAGA,IAAAC,GAAAF,EAAAD,IACAE,WACAE,GAAAJ,EACAK,QAAA,EAUA,OANAP,GAAAE,GAAAM,KAAAH,EAAAD,QAAAC,IAAAD,QAAAH,GAGAI,EAAAE,QAAA,EAGAF,EAAAD,QAvBA,GAAAD,KAqCA,OATAF,GAAAQ,EAAAT,EAGAC,EAAAS,EAAAP,EAGAF,EAAAU,EAAA,GAGAV,EAAA,KDMMW,EACA,SAASP,EAAQD,EAASH,GAE/B,YAsBA,SAASY,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GErExF,GAAAG,GAAAhB,EAAA,IFmDKiB,EAASL,EAAuBI,GElDrCE,EAAAlB,EAAA,IFsDKmB,EAAaP,EAAuBM,GErDzCE,EAAApB,EAAA,IFyDKqB,EAAeT,EAAuBQ,GExD3CE,EAAAtB,EAAA,GF4DKuB,EAAcX,EAAuBU,GE3D1CE,EAAAxB,EAAA,IF+DKyB,EAAeb,EAAuBY,GE3DrCE,EAAUC,SAASC,SAASC,MAAM,wBACpCH,IACAI,SAASC,cAAc,YAAYC,YAAYF,SAASG,eAAeP,EAAQ,MAEnF,EAAAH,cAAUO,SAASI,KAAM,cAAe,SAAAC,GAAA,MAAQA,GAAKC,MAAQT,SAASU,QAGtE,IAAMC,GAAQR,SAASC,cAAc,oBAGjCO,KAAO,WACP,GAAMC,GAAgBC,OAAOC,SAAWD,OAAUA,OAAOE,OAASF,OAAOC,MAEpEF,IAAiB,qBAAqBI,KAAKhB,SAASU,SACrDO,MAAM,4DAGV,IACIC,GAAeC,mBAAmB,qBAAqBH,KAAKhB,SAASU,QAAQ,IAC7EU,EAAajB,SAASkB,eAAe,iBACrCC,EAAqBnB,SAASkB,eAAe,iBAC7CE,GAAa,EAAA3B,cAAUe,EAAO,0BAC9Ba,EAAkBrB,SAASkB,eAAe,yBAC1CI,EAAM,GAAA/B,cAAckB,EAAcM,GAGlCQ,EAAW,IAEfN,GAAWO,iBAAiB,QAAS,WACjCP,EAAWQ,UAAW,EACtBR,EAAWS,MAAMC,MAAQV,EAAWW,YAAc,KAClDX,EAAWY,WAAY,EAAAlC,cAAW,cAElCyB,EAAWU,QAAQ,SAAAC,GAAA,MAAOR,GAAStD,QAAQ+D,IAAID,EAAIxD,GAAIwD,EAAIE,WAEvDV,EAASW,cAAcC,SACtBd,EAAgBe,MAAMC,cAActC,MAAM,aAAe+B,QAAQ,SAAAQ,GAAA,MAAKf,GAASW,cAAcK,IAAID,KAEtGhB,EAAIkB,KAAK,eAAgBjB,EAASkB,YAGtCtB,EAAmBK,iBAAiB,QAAS,SAAAkB,GACzC,GAAMC,GAAMD,EAAEE,MACdD,GAAIlB,UAAW,EACfH,EAAIkB,KAAK,gBAAgBK,KAAK,iBAAMF,GAAIlB,UAAW,KAGvD,IAAIqB,GAAY,GAAA3D,eAAS,GACrB4D,EAAe,GAAIC,KACnBC,EAAe,WACf,GAAIC,GAAQ,GAAIF,IAIhB,QAHA,EAAAvD,cAAUe,EAAO,kBAAmB,SAAA2C,GAChCD,EAAMlB,IAAImB,EAAM5E,GAAoB,aAAf4E,EAAMC,KAAuBD,EAAMlB,QAAUkB,EAAMf,SAErEc,GAEPG,EAAe,WACfjC,EAAWU,QAAQ,SAAAC,GAAA,MAAOA,GAAIE,QAAUV,EAAStD,QAAQqF,IAAIvB,EAAIxD,KAE7D,IAAIgF,GAAI,EACRhC,GAASW,cAAcJ,QAAQ,SAAAQ,GAAA,MAAKiB,IAAA,KAAUjB,IAC9CjB,EAAgBe,MAAQmB,EAAEC,OAAO,GAIzClC,GAAIkB,KAAK,eAAeK,KAAK,SAAAY,GACzBlC,EAAW,GAAAlC,cAAaoE,GAAO,GAC/BJ,KAGA,EAAA5D,cAAUe,EAAO,qBAAsB,SAAAkD,GACnC,GAAIC,GAAID,EAAKE,QAAL,WACJjF,EAAIqB,SAASkB,eAAeyC,EAC5BhF,IACAQ,aAAK0E,UAAUlF,GAAGmF,QAAQ,SAAA7B,GAAA,MAAWyB,GAAKjC,SAAWQ,OAI7D,EAAAxC,cAAUe,EAAO,oBAAqB,SAAAkD,GAClC,GAAIC,GAAID,EAAKE,QAAL,UACJjF,EAAIqB,SAASkB,eAAeyC,EAC5BhF,IACAQ,aAAK0E,UAAUlF,GAAGmF,QAAQ,SAAA7B,GAAA,MAAWyB,GAAKjC,UAAYQ,MAI9Dc,EAAeE,IAEfzC,EAAMuD,UAAUC,OAAO,UACvBxD,EAAMyD,uBAAuBF,UAAUxB,IAAI,WAG/C,IAAI2B,GAAgB,WAChB,GAAIC,GAAKlB,IAAgBmB,GAAU,CACnCD,GAAGrC,QAAQ,SAACuC,EAAGV,GAAJ,MAAUS,GAAUA,GAAYC,IAAMtB,EAAaO,IAAIK,KAClEb,EAAUV,MAAQgC,EAGtB5D,GAAMgB,iBAAiB,QAAS0C,GAChC1D,EAAMgB,iBAAiB,SAAU0C,GAEjCpB,EAAUwB,WAAWR,QAAQ,SAAAP,GAAA,MAAKtC,GAAWQ,UAAY8B,QF2FvDgB,EACA,SAASjG,EAAQD,EAASH,GAE/B,YAgBA,SAASY,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GAEvF,QAASyF,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCGzL1G,QAASC,GAAeC,GAAsD,GAAhDC,GAAgDC,UAAAC,QAAA,GAAAC,SAAAF,UAAA,IAA7B,EAA6BA,UAAA,GAAvBG,EAAuBH,UAAAC,QAAA,GAAAC,SAAAF,UAAA,IAAP,EAAOA,UAAA,GAC3ErG,EAAI,GAAIyG,GAAON,EAAMC,EAAkBI,EAE7C,OADAE,GAAkBpD,IAAI6C,EAAMnG,GACrBA,EAQJ,QAAS2G,GAAcC,GAC1B,IAAI/D,EAAJ,CAGAA,EAAW+D,EAEXF,EAAkBtD,QAAQ,SAAApD,GAClB6C,EAASgE,gBAAgB7G,IACzBA,EAAE8G,UAAUjE,IAIpB,IAAIkE,GAAW,GAAIC,kBAAiB,SAAAC,GAChCA,EAAU7D,QAAQ,SAAA8D,GACd,IAAK,GADqBC,GAAA,SACjBC,EAAOC,GACZ,GAAIrC,GAAOkC,EAASI,WAAWF,EAC3BpC,GAAKuC,UAAYC,KAAKC,cACtBf,EAAkBtD,QAAQ,SAAApD,GAClB6C,EAASgE,gBAAgB7G,IACzBA,EAAE0H,SAAS1C,EAAMnC,MALxBuE,EAAI,EAAGC,EAAIH,EAASI,WAAWhB,OAAYe,EAAJD,EAAOA,IAAKD,EAAnDC,EAAOC,MAaxBN,GAASY,QAAQrG,SAASI,MAAOkG,WAAW,EAAMC,SAAS,KHmI9DC,OAAOC,eAAepI,EAAS,cAC3B+D,OAAO,IAEX/D,EAAQ+G,kBAAoBH,MAE5B,IAAIyB,GAAe,WAAc,QAASC,GAAiB/D,EAAQgE,GAAS,IAAK,GAAId,GAAI,EAAGA,EAAIc,EAAM5B,OAAQc,IAAK,CAAE,GAAIe,GAAaD,EAAMd,EAAIe,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMR,OAAOC,eAAe7D,EAAQiE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUnC,EAAawC,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiBjC,EAAY0C,UAAWF,GAAiBC,GAAaR,EAAiBjC,EAAayC,GAAqBzC,KAEhiBrG,GGhLeuG,iBHiLfvG,EGtKegH,eA/ChB,IAAA7F,GAAAtB,EAAA,GHyNKuB,EAAcX,EAAuBU,GGvN7B4F,EAAA/G,EAAA+G,kBAAoB,GAAIpC,KAE/BmC,EH6NQ,WG5NV,QAAAA,GAAYN,GAAsD,GAAhDC,GAAgDC,UAAAC,QAAA,GAAAC,SAAAF,UAAA,IAA7B,EAA6BA,UAAA,GAAvBG,EAAuBH,UAAAC,QAAA,GAAAC,SAAAF,UAAA,IAAP,EAAOA,UAAA,EAAAP,GAAA6C,KAAAlC,GAC9DkC,KAAKxC,KAAOA,EACZwC,KAAKnC,cAAgBA,EACrBmC,KAAKvC,iBAAmBA,EACxBuC,KAAKC,mBACLD,KAAKE,aACLF,KAAKG,eH+QR,MA1CAd,GAAavB,IACT8B,IAAK,OACL7E,MAAO,SGpOPqF,GACDJ,KAAKG,YAAYE,KAAKD,MHuOrBR,IAAK,QACL7E,MAAO,SGrONuF,EAAUF,GACZJ,KAAKE,UAAUG,MAAMC,WAAUF,gBHwO9BR,IAAK,WACL7E,MAAO,SGtOHyC,GACLwC,KAAKC,gBAAgBI,KAAK7C,MHyOzBoC,IAAK,YACL7E,MAAO,SGvOFb,GACN8F,KAAKG,YAAY1F,QAAQ,SAAAnD,GAAA,MAAKA,GAAE4C,KAChC8F,KAAKE,UAAUzF,QAAQ,SAAA8F,GAAA,GAAED,GAAFC,EAAED,SAAUF,EAAZG,EAAYH,QAAZ,QAA0B,EAAAhI,cAAUO,SAASI,KAAMuH,EAAU,SAAAE,GAAA,MAAKJ,GAASI,EAAGtG,UHkPpG0F,IAAK,WACL7E,MAAO,SGhPHsB,GACL2D,KAAKE,UAAUzF,QAAQ,SAAAgG,GAAA,GAAEH,GAAFG,EAAEH,SAAUF,EAAZK,EAAYL,QAAZ,QAA0B,EAAAhI,cAAUiE,EAAMiE,EAAU,SAAAE,GAAA,MAAKJ,GAASI,EAAGtG,WH0PxF4D,KGhPR5D,EAAW,MHqSTwG,EACA,SAASzJ,EAAQD,EAASH,GAE/B,YAUA,SAASY,GAAuBC,GAAO,MAAOA,IAAOA,EAAIC,WAAaD,GAAQE,UAASF,GARvFyH,OAAOC,eAAepI,EAAS,cAC3B+D,OAAO,GIrVZ,IAAA4F,GAAA9J,EAAA,GJ0VK+J,EAAYnJ,EAAuBkJ,EAUvC3J,cI7Vc,SAACqF,EAAMiE,EAAUO,GAC5B,GAAa,OAATxE,EAAe,QACnB,IAAIyE,GAAWzE,EAAK0E,iBAAiBT,GACjCU,EAAQF,EAAWG,MAAMlB,UAAUmB,MAAM9J,KAAK0J,KAElD,KADI,EAAAF,cAAQvE,EAAMiE,IAAWU,EAAMG,QAAQ9E,GACvCwE,EACA,IAAK,GAAIpC,GAAI,EAAGC,EAAIsC,EAAMrD,OAAYe,EAAJD,EAAOA,IACrCoC,EAAIG,EAAMvC,GAGlB,OAAOuC,KJkWLI,EACA,SAASnK,EAAQD,GAEtB,YAEAmI,QAAOC,eAAepI,EAAS,cAC7B+D,OAAO,IAGT/D,aKpXc,SAAUqF,EAAMiE,GAAY,MAAOjE,GAAKgF,GAAef,GARtE,IAAMe,GAAiB,WAAaC,aAAYvB,UAAa,UAAY,qBL2YnEwB,GACA,SAAStK,EAAQD,GAEtB,YAEAmI,QAAOC,eAAepI,EAAS,cAC7B+D,OAAO,IAGT/D,aMhZc,WAAkB,GAARkF,GAAQwB,UAAAC,QAAA,GAAAC,SAAAF,UAAA,GAAJ,GAAIA,UAAA,EAC7B,OAAOxB,GAAEsF,QAAQ,KAAM,SAClBA,QAAQ,KAAM,QAAQA,QAAQ,KAAM,QACpCA,QAAQ,KAAM,UAAUA,QAAQ,KAAM,YNqZzCC,GACA,SAASxK,EAAQD,EAASH,GAE/B,YAYA,SAASsG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCAVhH6B,OAAOC,eAAepI,EAAS,cAC3B+D,OAAO,GAGX,IAAI2G,GAAiB,WAAc,QAASC,GAAcC,EAAKnD,GAAK,GAAIoD,MAAeC,GAAK,EAAUC,GAAK,EAAWC,EAAKpE,MAAW,KAAM,IAAK,GAAiCqE,GAA7BC,EAAKN,EAAIO,OAAOC,cAAmBN,GAAMG,EAAKC,EAAGG,QAAQC,QAAoBT,EAAKxB,KAAK4B,EAAGlH,QAAY0D,GAAKoD,EAAKlE,SAAWc,GAA3DqD,GAAK,IAAoE,MAAOS,GAAOR,GAAK,EAAMC,EAAKO,EAAO,QAAU,KAAWT,GAAMI,EAAG,WAAWA,EAAG,YAAe,QAAU,GAAIH,EAAI,KAAMC,IAAQ,MAAOH,GAAQ,MAAO,UAAUD,EAAKnD,GAAK,GAAIwC,MAAMuB,QAAQZ,GAAQ,MAAOA,EAAY,IAAIO,OAAOC,WAAYjD,QAAOyC,GAAQ,MAAOD,GAAcC,EAAKnD,EAAa,MAAM,IAAInB,WAAU,4DAEllB+B,EAAe,WAAc,QAASC,GAAiB/D,EAAQgE,GAAS,IAAK,GAAId,GAAI,EAAGA,EAAIc,EAAM5B,OAAQc,IAAK,CAAE,GAAIe,GAAaD,EAAMd,EAAIe,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMR,OAAOC,eAAe7D,EAAQiE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUnC,EAAawC,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiBjC,EAAY0C,UAAWF,GAAiBC,GAAaR,EAAiBjC,EAAayC,GAAqBzC,MOvajiBoF,EAAA5L,EAAA,GAEqB6L,EP2aL,WOzaZ,QAAAA,KAA2C,GAAAC,GAAA3C,KAA/B4C,EAA+BlF,UAAAC,QAAA,GAAAC,SAAAF,UAAA,GAA3B,KAA2BA,UAAA,GAArBmF,EAAqBnF,UAAAC,QAAA,GAAAC,SAAAF,UAAA,IAAP,EAAOA,UAAA,EAAAP,GAAA6C,KAAA0C,GACvC1C,KAAKpJ,QAAU,GAAI+E,KACnB8G,EAAA1E,kBAAkBtD,QAAQ,SAAApD,GACjBA,EAAEwG,eACH8E,EAAK/L,QAAQ+D,IAAItD,EAAEmG,KAAMnG,EAAEoG,oBAInCuC,KAAKnF,cAAgB,GAAIiI,KACzB9C,KAAK+C,YAAa,EAGdH,KACCA,EAAEhM,aAAe6D,QAAQ,SAAA8F,GAAY,GAAAE,GAAAiB,EAAAnB,EAAA,GAAVjE,EAAUmE,EAAA,GAAPzD,EAAOyD,EAAA,IAC9BoC,GAAeF,EAAK/L,QAAQoM,IAAI1G,KAChCqG,EAAK/L,QAAQ+D,IAAI2B,IAAKU,MAG7B4F,EAAE/H,mBAAqBJ,QAAQ,SAAAQ,GAAA,MAAK0H,GAAK9H,cAAcK,IAAID,KAC5D+E,KAAK+C,aAAeH,EAAEG,YP4d7B,MAhCA1D,GAAaqD,IACT9C,IAAK,SACL7E,MAAO,WOzbR,GAAM6H,IAAKhM,WAAaiE,iBAIxB,OAHAmF,MAAKpJ,QAAQ6D,QAAQ,SAACuC,EAAGV,GAAJ,MAAUsG,GAAEhM,QAAQyJ,MAAM/D,EAAGU,MAClDgD,KAAKnF,cAAcJ,QAAQ,SAAAQ,GAAA,MAAK2H,GAAE/H,cAAcwF,KAAKpF,KACrD2H,EAAEG,WAAa/C,KAAK+C,WACbH,KPucNhD,IAAK,kBACL7E,MAAO,SOjcI1D,GAAG,GAAA4L,GAAAjD,IACf,QACK3I,EAAEwG,gBAAkBmC,KAAKpJ,QAAQoM,IAAI3L,EAAEmG,OAASnG,EAAEoG,kBAAoBuC,KAAKpJ,QAAQqF,IAAI5E,EAAEmG,SACtFnG,EAAE4I,gBAAgBiD,IAAI,SAAA1F,GAAA,MAAQiF,GAAA1E,kBAAkB9B,IAAIuB,KAAO2F,KAAK,SAAA9L,GAAA,OAAM4L,EAAK/E,gBAAgB7G,SPyc/FqL,IAGX1L,cOpfoB0L,GPwffU,GACA,SAASnM,EAAQD,GAEtB,YAUA,SAASmG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCARhH6B,OAAOC,eAAepI,EAAS,cAC3B+D,OAAO,GAGX,IAAIsI,GAA4B,kBAAXlB,SAAoD,gBAApBA,QAAOC,SAAwB,SAAU1K,GAAO,aAAcA,IAAS,SAAUA,GAAO,MAAOA,IAAyB,kBAAXyK,SAAyBzK,EAAI4L,cAAgBnB,OAAS,eAAkBzK,IAEtO2H,EAAe,WAAc,QAASC,GAAiB/D,EAAQgE,GAAS,IAAK,GAAId,GAAI,EAAGA,EAAIc,EAAM5B,OAAQc,IAAK,CAAE,GAAIe,GAAaD,EAAMd,EAAIe,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMR,OAAOC,eAAe7D,EAAQiE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUnC,EAAawC,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiBjC,EAAY0C,UAAWF,GAAiBC,GAAaR,EAAiBjC,EAAayC,GAAqBzC,MQrgB7hBkG,EAAgB,EAEdC,EAAiB,YAEFC,ERygBJ,WQvgBb,QAAAA,KAAoD,GAAAd,GAAA3C,KAAxC5G,EAAwCsE,UAAAC,QAAA,GAAAC,SAAAF,UAAA,GAAzB,KAAyBA,UAAA,GAAnBhE,EAAmBgE,UAAAC,QAAA,GAAAC,SAAAF,UAAA,GAAJ,GAAIA,UAAA,EAAAP,GAAA6C,KAAAyD,GAChDzD,KAAK0D,aAAe,GAAI/H,KACxBqE,KAAK2D,YAAc,GAAIhI,KAEvBqE,KAAK4D,cAAgBxK,EACrB4G,KAAK6D,cAAgBnK,EAErBL,OAAOc,iBAAiB,UAAW,SAAA2J,GAC/B,GAA0B,WAAtBT,EAAOS,EAAMC,MAAjB,CADwC,GAAAC,GAKkBF,EAAnDC,KAAME,EAL2BD,EAK3BC,OAAQC,EALmBF,EAKnBE,UAAWnJ,EALQiJ,EAKRjJ,MAAQoJ,EAAkBL,EAAlBK,OAAQC,EAAUN,EAAVM,MAEhD,IAAIH,IAAWT,GAAkBb,EAAKe,aAAaV,IAAIkB,GACnDvB,EAAKe,aAAazH,IAAIiI,GAAWnJ,GACjC4H,EAAKe,aAALf,UAAyBuB,OAEtB,IAAIvB,EAAKgB,YAAYX,IAAIiB,GAAS,CACrC,GAAII,GAAO1B,EAAKgB,YAAY1H,IAAIgI,GAAQlJ,EACxCoJ,GAAOG,aAAaL,OAAQT,EAAgBU,YAAWnJ,MAAOsJ,GAAOD,OR6kBhF,MA5CA/E,GAAaoE,IACT7D,IAAK,OACL7E,MAAO,SQxhBPkJ,GAAsB,GAAdlJ,GAAc2C,UAAAC,QAAA,GAAAC,SAAAF,UAAA,GAAN,KAAMA,UAAA,EACvB,OAAOsC,MAAKuE,OAAOvE,KAAK4D,cAAe5D,KAAK6D,cAAeI,EAAQlJ,MRuiBlE6E,IAAK,SACL7E,MAAO,SQ7hBL1B,EAAQ+K,EAAQH,GAAsB,GAAAhB,GAAAjD,KAAdjF,EAAc2C,UAAAC,QAAA,GAAAC,SAAAF,UAAA,GAAN,KAAMA,UAAA,EACzC,OAAO,IAAI8G,SAAQ,SAAAC,GACf,GAAMP,GAAYX,GAClBN,GAAKS,aAAa/I,IAAIuJ,EAAWO,GACjCpL,EAAOiL,aAAaL,SAAQC,YAAWnJ,SAAQqJ,QR4iBlDxE,IAAK,KACL7E,MAAO,SQpiBTkJ,EAAQ7D,GACPJ,KAAK2D,YAAYhJ,IAAIsJ,EAAQ7D,ORwiBzBqD,IAGXzM,cQtmBoByM,GR0mBfiB,GACA,SAASzN,EAAQD,GAEtB,YAQA,SAASmG,GAAgBC,EAAUC,GAAe,KAAMD,YAAoBC,IAAgB,KAAM,IAAIC,WAAU,qCANhH6B,OAAOC,eAAepI,EAAS,cAC3B+D,OAAO,GAGX,IAAIsE,GAAe,WAAc,QAASC,GAAiB/D,EAAQgE,GAAS,IAAK,GAAId,GAAI,EAAGA,EAAIc,EAAM5B,OAAQc,IAAK,CAAE,GAAIe,GAAaD,EAAMd,EAAIe,GAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,SAAWF,KAAYA,EAAWG,UAAW,GAAMR,OAAOC,eAAe7D,EAAQiE,EAAWI,IAAKJ,IAAiB,MAAO,UAAUnC,EAAawC,EAAYC,GAAiJ,MAA9HD,IAAYP,EAAiBjC,EAAY0C,UAAWF,GAAiBC,GAAaR,EAAiBjC,EAAayC,GAAqBzC,MSvnB5gBsH,ET2nBT,WSznBR,QAAAA,GAAY5J,GAAOoC,EAAA6C,KAAA2E,GACf3E,KAAK4E,OAAS7J,EACdiF,KAAK6E,WAAa,GAAI/B,KTgzBzB,MAjLAzD,GAAasF,IACT/E,IAAK,OACL7E,MAAO,WSvnBL,GAAA4H,GAAA3C,IACHA,MAAK6E,WAAWpK,QAAQ,SAAAiE,GAAA,MAAKA,GAAEiE,EAAKiC,aT8nBnChF,IAAK,UACL7E,MAAO,SS5nBJ+J,GAGJ,MAFA9E,MAAK6E,WAAW3J,IAAI4J,GACpBA,EAAI9E,KAAKjF,OACFiF,QT+nBNJ,IAAK,WACL7E,MAAO,SS7nBH+J,GAEL,MADA9E,MAAK6E,WAAL7E,UAAuB8E,GAChB9E,QTuoBNJ,IAAK,SACL7E,MAAO,SShoBL8F,EAAKkE,GACR,GAAIzN,GAAI,GAAIqN,GAAKI,EAEjB,OADA/E,MAAKvD,QAAQ,SAAAO,GAAA,MAAK6D,GAAIvJ,EAAG0F,KAClB1F,KT2oBNsI,IAAK,MACL7E,MAAO,SS3nBR8F,GAAO,MAAOb,MAAKgF,OAAO,SAAC1N,EAAG0F,GAAJ,MAAU1F,GAAEyD,MAAQ8F,EAAI7D,QTioBjD4C,IAAK,SACL7E,MAAO,SShoBL8F,GAAO,MAAOb,MAAKgF,OAAO,SAAC1N,EAAG0F,GAAJ,MAAU6D,GAAI7D,KAAO1F,EAAEyD,MAAQiC,QTsoB3D4C,IAAK,WACL7E,MAAO,SSroBHkK,GAAU,GAAAhC,GAAAjD,KACXkF,EAAMtH,OACNuH,EAAQ,IAEZ,OAAOnF,MAAKgF,OAAO,SAAC1N,EAAG0F,GACnBkI,EAAMlI,EACDmI,IACDA,EAAQC,WAAW,WACHxH,SAARsH,IACA5N,EAAEyD,MAAQkI,EAAKlI,MACfmK,EAAMtH,QAEVuH,EAAQ,MACTF,KAERjF,KAAKjF,UTipBP6E,IAAK,gBACL7E,MAAO,SS1oBEgK,GACV,GAAIM,GAAW,IACf,OAAOrF,MAAKgF,OAAO,SAAC1N,EAAG0F,GACnB,GAAIsI,GAAOtI,CACXqI,GAAWC,EACXA,EAAK9J,KAAK,SAAA+J,GACFD,IAASD,IACT/N,EAAEyD,MAAQwK,MAGnBR,MT6oBFnF,IAAK,WACL7E,MAAO,WS1oBR,GAAImK,EACJ,OAAOlF,MAAKgF,OAAO,SAAC1N,EAAG0F,GACfA,IAAMkI,IACNA,EAAMlI,EACN1F,EAAEyD,MAAQiC,QTgpBjB4C,IAAK,QACL3D,IAAK,WS7uBI,MAAO+D,MAAK4E,QTgvBrBjK,IAAK,SS9uBAqC,GACNgD,KAAK4E,OAAS5H,EACdgD,KAAKwF,YTivBJ5F,IAAK,UACL7E,MAAO,WSjtBa,OAAA0K,GAAA/H,UAAAC,OAAP+H,EAAOzE,MAAAwE,GAAAE,EAAA,EAAAF,EAAAE,MAAPD,EAAOC,GAAAjI,UAAAiI,EACrB,IAAMC,GAAO,GAAIjB,GAAKe,EAAMxC,IAAI,SAAA5L,GAAA,MAAKA,GAAEyD,QAMvC,OALA2K,GAAMjL,QAAQ,SAACnD,EAAGmH,GAAJ,MAAUnH,GAAEmF,QAAQ,SAAAO,GAC9B,GAAI6I,GAAKD,EAAK7K,KACd8K,GAAGpH,GAAKzB,EACR4I,EAAK7K,MAAQ8K,MAEVD,KT4tBNhG,IAAK,YACL7E,MAAO,SSxqBKe,EAAOgK,EAAYC,GAChC,IAAKjK,KAAWA,YAAiBkK,mBAAoBlK,YAAiBmK,sBAAuBnK,YAAiBoK,oBAC1G,MAAO,IAAIvB,GAAK,KAGpB,IAAIwB,GAAkB,OAClBrK,aAAiBkK,oBAAoC,aAAflK,EAAMC,MAAsC,UAAfD,EAAMC,QACzEoK,EAAkB,UAGtB,IAAIC,GAASN,EAAaA,EAAWO,MAAM,MAAQ,QAAS,SAC5DN,GAAWA,GAAYI,CAEvB,IAAIG,GAAS,iBAAoB,SAAbP,EAAuBjK,EAAQA,EAAMiK,IAErDH,EAAO,GAAIjB,GAAK2B,IAEpB,OADAF,GAAO3L,QAAQ,SAAAqJ,GAAA,MAAShI,GAAM3B,iBAAiB2J,EAAO,iBAAM8B,GAAK7K,MAAQuL,QAClEV,KTirBNhG,IAAK,SACL7E,MAAO,QAASwL,GS/qBPC,GACV,GAAID,GAAS,GAAI5B,IAAK,EAEtB,OADA8B,aAAY,iBAAMF,GAAOxL,OAAQ,GAAMyL,GAChCD,MTqrBH5B,IAGX3N,cSvzBoB2N","file":"settings.min.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 0:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tvar _cell = __webpack_require__(46);\n\t\n\tvar _cell2 = _interopRequireDefault(_cell);\n\t\n\tvar _settings = __webpack_require__(18);\n\t\n\tvar _settings2 = _interopRequireDefault(_settings);\n\t\n\tvar _messageRpc = __webpack_require__(19);\n\t\n\tvar _messageRpc2 = _interopRequireDefault(_messageRpc);\n\t\n\tvar _forSelect = __webpack_require__(6);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tvar _escapeHtml = __webpack_require__(16);\n\t\n\tvar _escapeHtml2 = _interopRequireDefault(_escapeHtml);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/** page elements fix **/\n\tvar version = location.pathname.match(/BetterFeed2\\/([^\\/]+)/);\n\tif (version) {\n\t    document.querySelector(\".version\").appendChild(document.createTextNode(version[1]));\n\t}\n\t(0, _forSelect2.default)(document.body, \".local-link\", function (link) {\n\t    return link.href += location.search;\n\t});\n\t/** page elements fix **/\n\t\n\tvar sPage = document.querySelector(\".content.settings\");\n\t\n\t// мы на странице настроек\n\tif (sPage) {\n\t    (function () {\n\t        var parentWindow = window.parent === window ? window.opener : window.parent;\n\t\n\t        if (!parentWindow || !/[?&]origin=([^&]+)/.exec(location.search)) {\n\t            alert(\"Пожалуйста, откройте эту страницу по ссылке из FreeFeed-а\");\n\t        }\n\t\n\t        var parentOrigin = decodeURIComponent(/[?&]origin=([^&]+)/.exec(location.search)[1]),\n\t            saveButton = document.getElementById(\"save-settings\"),\n\t            checkUpdatesButton = document.getElementById(\"check-updates\"),\n\t            checkBoxes = (0, _forSelect2.default)(sPage, \"input[type='checkbox']\"),\n\t            hidePostsFromTA = document.getElementById(\"hide-posts-from-users\"),\n\t            msg = new _messageRpc2.default(parentWindow, parentOrigin);\n\t\n\t        /** @type {Settings|null} */\n\t        var settings = null;\n\t\n\t        saveButton.addEventListener(\"click\", function () {\n\t            saveButton.disabled = true;\n\t            saveButton.style.width = saveButton.offsetWidth + \"px\";\n\t            saveButton.innerHTML = (0, _escapeHtml2.default)(\"Сохраняем…\");\n\t\n\t            checkBoxes.forEach(function (box) {\n\t                return settings.modules.set(box.id, box.checked);\n\t            });\n\t            {\n\t                settings.hidePostsFrom.clear();\n\t                (hidePostsFromTA.value.toLowerCase().match(/\\w+/g) || []).forEach(function (u) {\n\t                    return settings.hidePostsFrom.add(u);\n\t                });\n\t            }\n\t            msg.send(\"saveSettings\", settings.toJSON());\n\t        });\n\t\n\t        checkUpdatesButton.addEventListener(\"click\", function (e) {\n\t            var btn = e.target;\n\t            btn.disabled = true;\n\t            msg.send(\"checkUpdates\").then(function () {\n\t                return btn.disabled = false;\n\t            });\n\t        });\n\t\n\t        var isChanged = new _cell2.default(false);\n\t        var initialState = new Map();\n\t        var currentState = function currentState() {\n\t            var state = new Map();\n\t            (0, _forSelect2.default)(sPage, \"input, textarea\", function (input) {\n\t                state.set(input.id, input.type === \"checkbox\" ? input.checked : input.value);\n\t            });\n\t            return state;\n\t        };\n\t        var updateInputs = function updateInputs() {\n\t            checkBoxes.forEach(function (box) {\n\t                return box.checked = settings.modules.get(box.id);\n\t            });\n\t            {\n\t                var s = \"\";\n\t                settings.hidePostsFrom.forEach(function (u) {\n\t                    return s += \", \" + u;\n\t                });\n\t                hidePostsFromTA.value = s.substr(2);\n\t            }\n\t        };\n\t\n\t        msg.send(\"getSettings\").then(function (sData) {\n\t            settings = new _settings2.default(sData, true);\n\t            updateInputs();\n\t\n\t            // Взаимосвязь между флагами\n\t            (0, _forSelect2.default)(sPage, \"[data-disabled-if]\", function (node) {\n\t                var k = node.dataset[\"disabledIf\"],\n\t                    c = document.getElementById(k);\n\t                if (c) {\n\t                    _cell2.default.fromInput(c).onValue(function (checked) {\n\t                        return node.disabled = checked;\n\t                    });\n\t                }\n\t            });\n\t\n\t            (0, _forSelect2.default)(sPage, \"[data-enabled-if]\", function (node) {\n\t                var k = node.dataset[\"enabledIf\"],\n\t                    c = document.getElementById(k);\n\t                if (c) {\n\t                    _cell2.default.fromInput(c).onValue(function (checked) {\n\t                        return node.disabled = !checked;\n\t                    });\n\t                }\n\t            });\n\t\n\t            initialState = currentState();\n\t\n\t            sPage.classList.remove(\"hidden\");\n\t            sPage.previousElementSibling.classList.add(\"hidden\");\n\t        });\n\t\n\t        var changeHandler = function changeHandler() {\n\t            var st = currentState(),\n\t                changed = false;\n\t            st.forEach(function (v, k) {\n\t                return changed = changed || v !== initialState.get(k);\n\t            });\n\t            isChanged.value = changed;\n\t        };\n\t\n\t        sPage.addEventListener(\"input\", changeHandler);\n\t        sPage.addEventListener(\"change\", changeHandler);\n\t\n\t        isChanged.distinct().onValue(function (s) {\n\t            return saveButton.disabled = !s;\n\t        });\n\t    })();\n\t}\n\n/***/ },\n\n/***/ 5:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\texports.registeredModules = undefined;\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\texports.registerModule = registerModule;\n\texports.startObserver = startObserver;\n\t\n\tvar _forSelect = __webpack_require__(6);\n\t\n\tvar _forSelect2 = _interopRequireDefault(_forSelect);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar registeredModules = exports.registeredModules = new Map(); // name → module\n\t\n\tvar Module = function () {\n\t    function Module(name) {\n\t        var enabledByDefault = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\t        var alwaysEnabled = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t        _classCallCheck(this, Module);\n\t\n\t        this.name = name;\n\t        this.alwaysEnabled = alwaysEnabled;\n\t        this.enabledByDefault = enabledByDefault;\n\t        this.requiredModules = [];\n\t        this._watchers = [];\n\t        this._initiators = [];\n\t    }\n\t\n\t    _createClass(Module, [{\n\t        key: \"init\",\n\t        value: function init(callback) {\n\t            this._initiators.push(callback);\n\t        }\n\t    }, {\n\t        key: \"watch\",\n\t        value: function watch(selector, callback) {\n\t            this._watchers.push({ selector: selector, callback: callback });\n\t        }\n\t    }, {\n\t        key: \"required\",\n\t        value: function required(name) {\n\t            this.requiredModules.push(name);\n\t        }\n\t    }, {\n\t        key: \"_initiate\",\n\t        value: function _initiate(settings) {\n\t            this._initiators.forEach(function (c) {\n\t                return c(settings);\n\t            });\n\t            this._watchers.forEach(function (_ref) {\n\t                var selector = _ref.selector;\n\t                var callback = _ref.callback;\n\t                return (0, _forSelect2.default)(document.body, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }, {\n\t        key: \"_trigger\",\n\t        value: function _trigger(node) {\n\t            this._watchers.forEach(function (_ref2) {\n\t                var selector = _ref2.selector;\n\t                var callback = _ref2.callback;\n\t                return (0, _forSelect2.default)(node, selector, function (n) {\n\t                    return callback(n, settings);\n\t                });\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Module;\n\t}();\n\t\n\tfunction registerModule(name) {\n\t    var enabledByDefault = arguments.length <= 1 || arguments[1] === undefined ? true : arguments[1];\n\t    var alwaysEnabled = arguments.length <= 2 || arguments[2] === undefined ? false : arguments[2];\n\t\n\t    var m = new Module(name, enabledByDefault, alwaysEnabled);\n\t    registeredModules.set(name, m);\n\t    return m;\n\t}\n\t\n\tvar settings = null;\n\t/**\r\n\t *\r\n\t * @param {Settings} aSettings\r\n\t */\n\tfunction startObserver(aSettings) {\n\t    if (settings) {\n\t        return;\n\t    }\n\t    settings = aSettings;\n\t\n\t    registeredModules.forEach(function (m) {\n\t        if (settings.isModuleEnabled(m)) {\n\t            m._initiate(settings);\n\t        }\n\t    });\n\t\n\t    var observer = new MutationObserver(function (mutations) {\n\t        mutations.forEach(function (mutation) {\n\t            var _loop = function _loop(i, l) {\n\t                var node = mutation.addedNodes[i];\n\t                if (node.nodeType == Node.ELEMENT_NODE) {\n\t                    registeredModules.forEach(function (m) {\n\t                        if (settings.isModuleEnabled(m)) {\n\t                            m._trigger(node, settings);\n\t                        }\n\t                    });\n\t                }\n\t            };\n\t\n\t            for (var i = 0, l = mutation.addedNodes.length; i < l; i++) {\n\t                _loop(i, l);\n\t            }\n\t        });\n\t    });\n\t\n\t    observer.observe(document.body, { childList: true, subtree: true });\n\t}\n\n/***/ },\n\n/***/ 6:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _matches = __webpack_require__(7);\n\t\n\tvar _matches2 = _interopRequireDefault(_matches);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t/**\r\n\t * @param {Document|DocumentFragment|Element} node\r\n\t * @param {string} selector\r\n\t * @param {function(Node)} [foo]\r\n\t */\n\t\n\texports.default = function (node, selector, foo) {\n\t    if (node === null) return [];\n\t    var nodeList = node.querySelectorAll(selector);\n\t    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\n\t    if ((0, _matches2.default)(node, selector)) nodes.unshift(node);\n\t    if (foo) {\n\t        for (var i = 0, l = nodes.length; i < l; i++) {\n\t            foo(nodes[i]);\n\t        }\n\t    }\n\t    return nodes;\n\t};\n\n/***/ },\n\n/***/ 7:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function (node, selector) {\n\t  return node[matchesMethod](selector);\n\t};\n\t\n\tvar matchesMethod = \"matches\" in HTMLElement.prototype ? \"matches\" : \"msMatchesSelector\";\n\t\n\t/**\r\n\t *\r\n\t * @param {HTMLElement} node\r\n\t * @param {String} selector\r\n\t * @return {Boolean}\r\n\t */\n\n/***/ },\n\n/***/ 16:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t  value: true\n\t});\n\t\n\texports.default = function () {\n\t  var s = arguments.length <= 0 || arguments[0] === undefined ? \"\" : arguments[0];\n\t\n\t  return s.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\n\t};\n\n/***/ },\n\n/***/ 18:\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tvar _modules = __webpack_require__(5);\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Settings = function () {\n\t    function Settings() {\n\t        var _this = this;\n\t\n\t        var o = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n\t        var trustedData = arguments.length <= 1 || arguments[1] === undefined ? false : arguments[1];\n\t\n\t        _classCallCheck(this, Settings);\n\t\n\t        this.modules = new Map();\n\t        _modules.registeredModules.forEach(function (m) {\n\t            if (!m.alwaysEnabled) {\n\t                _this.modules.set(m.name, m.enabledByDefault);\n\t            }\n\t        });\n\t\n\t        this.hidePostsFrom = new Set();\n\t        this.hideAliens = false;\n\t\n\t        // инициализация из объекта\n\t        if (o) {\n\t            (o.modules || []).forEach(function (_ref) {\n\t                var _ref2 = _slicedToArray(_ref, 2);\n\t\n\t                var k = _ref2[0];\n\t                var v = _ref2[1];\n\t\n\t                if (trustedData || _this.modules.has(k)) {\n\t                    _this.modules.set(k, !!v);\n\t                }\n\t            });\n\t            (o.hidePostsFrom || []).forEach(function (u) {\n\t                return _this.hidePostsFrom.add(u);\n\t            });\n\t            this.hideAliens = !!o.hideAliens;\n\t        }\n\t    }\n\t\n\t    _createClass(Settings, [{\n\t        key: \"toJSON\",\n\t        value: function toJSON() {\n\t            var o = { modules: [], hidePostsFrom: [] };\n\t            this.modules.forEach(function (v, k) {\n\t                return o.modules.push([k, v]);\n\t            });\n\t            this.hidePostsFrom.forEach(function (u) {\n\t                return o.hidePostsFrom.push(u);\n\t            });\n\t            o.hideAliens = this.hideAliens;\n\t            return o;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Module} m\r\n\t         * @return {boolean}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"isModuleEnabled\",\n\t        value: function isModuleEnabled(m) {\n\t            var _this2 = this;\n\t\n\t            return (m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name)) && !m.requiredModules.map(function (name) {\n\t                return _modules.registeredModules.get(name);\n\t            }).some(function (m) {\n\t                return !_this2.isModuleEnabled(m);\n\t            });\n\t        }\n\t    }]);\n\t\n\t    return Settings;\n\t}();\n\t\n\texports.default = Settings;\n\n/***/ },\n\n/***/ 19:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol ? \"symbol\" : typeof obj; };\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar nextRequestId = 1;\n\t\n\tvar responseAction = \"@response\";\n\t\n\tvar Messenger = function () {\n\t    function Messenger() {\n\t        var _this = this;\n\t\n\t        var parentWindow = arguments.length <= 0 || arguments[0] === undefined ? null : arguments[0];\n\t        var parentOrigin = arguments.length <= 1 || arguments[1] === undefined ? \"\" : arguments[1];\n\t\n\t        _classCallCheck(this, Messenger);\n\t\n\t        this.__responders = new Map();\n\t        this.__listeners = new Map();\n\t\n\t        this.defaultWindow = parentWindow;\n\t        this.defaultOrigin = parentOrigin;\n\t\n\t        window.addEventListener('message', function (event) {\n\t            if (_typeof(event.data) !== \"object\") {\n\t                return;\n\t            }\n\t            //noinspection UnnecessaryLocalVariableJS\n\t            var _event$data = event.data;\n\t            var action = _event$data.action;\n\t            var requestId = _event$data.requestId;\n\t            var value = _event$data.value;\n\t            var source = event.source;\n\t            var origin = event.origin;\n\t\n\t\n\t            if (action === responseAction && _this.__responders.has(requestId)) {\n\t                _this.__responders.get(requestId)(value);\n\t                _this.__responders.delete(requestId);\n\t            } else if (_this.__listeners.has(action)) {\n\t                var resp = _this.__listeners.get(action)(value);\n\t                source.postMessage({ action: responseAction, requestId: requestId, value: resp }, origin);\n\t            }\n\t        });\n\t    }\n\t\n\t    /**\r\n\t     *\r\n\t     * @param {String} action\r\n\t     * @param {*} value\r\n\t     * @return {Promise}\r\n\t     */\n\t\n\t\n\t    _createClass(Messenger, [{\n\t        key: \"send\",\n\t        value: function send(action) {\n\t            var value = arguments.length <= 1 || arguments[1] === undefined ? null : arguments[1];\n\t\n\t            return this.sendEx(this.defaultWindow, this.defaultOrigin, action, value);\n\t        }\n\t\n\t        /**\r\n\t         *\r\n\t         * @param {Window} window\r\n\t         * @param {String} origin\r\n\t         * @param {String} action\r\n\t         * @param {*} value\r\n\t         * @return {Promise}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"sendEx\",\n\t        value: function sendEx(window, origin, action) {\n\t            var _this2 = this;\n\t\n\t            var value = arguments.length <= 3 || arguments[3] === undefined ? null : arguments[3];\n\t\n\t            return new Promise(function (resolve) {\n\t                var requestId = nextRequestId++;\n\t                _this2.__responders.set(requestId, resolve);\n\t                window.postMessage({ action: action, requestId: requestId, value: value }, origin);\n\t            });\n\t        }\n\t\n\t        /**\r\n\t         *\r\n\t         * @param {String} action\r\n\t         * @param {function} callback\r\n\t         */\n\t\n\t    }, {\n\t        key: \"on\",\n\t        value: function on(action, callback) {\n\t            this.__listeners.set(action, callback);\n\t        }\n\t    }]);\n\t\n\t    return Messenger;\n\t}();\n\t\n\texports.default = Messenger;\n\n/***/ },\n\n/***/ 46:\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\t\n\tObject.defineProperty(exports, \"__esModule\", {\n\t    value: true\n\t});\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Cell = function () {\n\t    function Cell(value) {\n\t        _classCallCheck(this, Cell);\n\t\n\t        this._value = value;\n\t        this._listeners = new Set();\n\t    }\n\t\n\t    _createClass(Cell, [{\n\t        key: \"poke\",\n\t        value: function poke() {\n\t            var _this = this;\n\t\n\t            this._listeners.forEach(function (l) {\n\t                return l(_this._value);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"onValue\",\n\t        value: function onValue(lst) {\n\t            this._listeners.add(lst);\n\t            lst(this.value);\n\t            return this;\n\t        }\n\t    }, {\n\t        key: \"unListen\",\n\t        value: function unListen(lst) {\n\t            this._listeners.delete(lst);\n\t            return this;\n\t        }\n\t\n\t        /**\r\n\t         * @param {function(Cell, *)} foo\r\n\t         * @param {*} [initial]\r\n\t         * @return {Cell}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"derive\",\n\t        value: function derive(foo, initial) {\n\t            var c = new Cell(initial);\n\t            this.onValue(function (v) {\n\t                return foo(c, v);\n\t            });\n\t            return c;\n\t        }\n\t\n\t        /**\r\n\t         * @param {Array.<Cell>} cells\r\n\t         * @return {Cell}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"map\",\n\t        value: function map(foo) {\n\t            return this.derive(function (c, v) {\n\t                return c.value = foo(v);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"filter\",\n\t        value: function filter(foo) {\n\t            return this.derive(function (c, v) {\n\t                return foo(v) && (c.value = v);\n\t            });\n\t        }\n\t    }, {\n\t        key: \"throttle\",\n\t        value: function throttle(duration) {\n\t            var _this2 = this;\n\t\n\t            var val = undefined,\n\t                timer = null;\n\t\n\t            return this.derive(function (c, v) {\n\t                val = v;\n\t                if (!timer) {\n\t                    timer = setTimeout(function () {\n\t                        if (val !== undefined) {\n\t                            c.value = _this2.value;\n\t                            val = undefined;\n\t                        }\n\t                        timer = null;\n\t                    }, duration);\n\t                }\n\t            }, this.value);\n\t        }\n\t\n\t        /**\r\n\t         * For cell with Promise's values\r\n\t         * @param {*} [initial]\r\n\t         * @return {Cell}\r\n\t         */\n\t\n\t    }, {\n\t        key: \"latestPromise\",\n\t        value: function latestPromise(initial) {\n\t            var lastProm = null;\n\t            return this.derive(function (c, v) {\n\t                var prom = v;\n\t                lastProm = prom;\n\t                prom.then(function (res) {\n\t                    if (prom === lastProm) {\n\t                        c.value = res;\n\t                    }\n\t                });\n\t            }, initial);\n\t        }\n\t    }, {\n\t        key: \"distinct\",\n\t        value: function distinct() {\n\t            var val;\n\t            return this.derive(function (c, v) {\n\t                if (v !== val) {\n\t                    val = v;\n\t                    c.value = v;\n\t                }\n\t            });\n\t        }\n\t    }, {\n\t        key: \"value\",\n\t        get: function get() {\n\t            return this._value;\n\t        },\n\t        set: function set(v) {\n\t            this._value = v;\n\t            this.poke();\n\t        }\n\t    }], [{\n\t        key: \"combine\",\n\t        value: function combine() {\n\t            for (var _len = arguments.length, cells = Array(_len), _key = 0; _key < _len; _key++) {\n\t                cells[_key] = arguments[_key];\n\t            }\n\t\n\t            var cell = new Cell(cells.map(function (c) {\n\t                return c.value;\n\t            }));\n\t            cells.forEach(function (c, i) {\n\t                return c.onValue(function (v) {\n\t                    var vv = cell.value;\n\t                    vv[i] = v;\n\t                    cell.value = vv;\n\t                });\n\t            });\n\t            return cell;\n\t        }\n\t    }, {\n\t        key: \"fromInput\",\n\t        value: function fromInput(input, eventNames, property) {\n\t            if (!input || !(input instanceof HTMLInputElement || input instanceof HTMLTextAreaElement || input instanceof HTMLSelectElement)) {\n\t                return new Cell(null);\n\t            }\n\t\n\t            var defaultProperty = \"value\";\n\t            if (input instanceof HTMLInputElement && (input.type === \"checkbox\" || input.type === \"radio\")) {\n\t                defaultProperty = \"checked\";\n\t            }\n\t\n\t            var events = eventNames ? eventNames.split(\" \") : [\"input\", \"change\"];\n\t            property = property || defaultProperty;\n\t\n\t            var getVal = function getVal() {\n\t                return property === \"self\" ? input : input[property];\n\t            };\n\t\n\t            var cell = new Cell(getVal());\n\t            events.forEach(function (event) {\n\t                return input.addEventListener(event, function () {\n\t                    return cell.value = getVal();\n\t                });\n\t            });\n\t            return cell;\n\t        }\n\t    }, {\n\t        key: \"ticker\",\n\t        value: function ticker(timeout) {\n\t            var ticker = new Cell(true);\n\t            setInterval(function () {\n\t                return ticker.value = true;\n\t            }, timeout);\n\t            return ticker;\n\t        }\n\t    }]);\n\t\n\t    return Cell;\n\t}();\n\t\n\texports.default = Cell;\n\n/***/ }\n\n/******/ });\n\n\n/** WEBPACK FOOTER **\n ** settings.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 319e8f25f202c0cc5b16\n **/","import Cell      from \"./utils/cell\";\r\nimport Settings  from \"./base/settings\";\r\nimport Messenger from \"./utils/message-rpc\";\r\nimport forSelect from \"./utils/for-select\";\r\nimport escapeHTML from \"./utils/escape-html\";\r\n\r\n\r\n/** page elements fix **/\r\nconst version = location.pathname.match(/BetterFeed2\\/([^\\/]+)/);\r\nif (version) {\r\n    document.querySelector(\".version\").appendChild(document.createTextNode(version[1]));\r\n}\r\nforSelect(document.body, \".local-link\", link => link.href += location.search);\r\n/** page elements fix **/\r\n\r\nconst sPage = document.querySelector(\".content.settings\");\r\n\r\n// мы на странице настроек\r\nif (sPage) {\r\n    const parentWindow = (window.parent === window) ? window.opener : window.parent;\r\n\r\n    if (!parentWindow || !/[?&]origin=([^&]+)/.exec(location.search)) {\r\n        alert(\"Пожалуйста, откройте эту страницу по ссылке из FreeFeed-а\");\r\n    }\r\n\r\n    const\r\n        parentOrigin = decodeURIComponent(/[?&]origin=([^&]+)/.exec(location.search)[1]),\r\n        saveButton = document.getElementById(\"save-settings\"),\r\n        checkUpdatesButton = document.getElementById(\"check-updates\"),\r\n        checkBoxes = forSelect(sPage, \"input[type='checkbox']\"),\r\n        hidePostsFromTA = document.getElementById(\"hide-posts-from-users\"),\r\n        msg = new Messenger(parentWindow, parentOrigin);\r\n\r\n    /** @type {Settings|null} */\r\n    let settings = null;\r\n\r\n    saveButton.addEventListener(\"click\", () => {\r\n        saveButton.disabled = true;\r\n        saveButton.style.width = saveButton.offsetWidth + \"px\";\r\n        saveButton.innerHTML = escapeHTML(\"Сохраняем\\u2026\");\r\n\r\n        checkBoxes.forEach(box => settings.modules.set(box.id, box.checked));\r\n        {\r\n            settings.hidePostsFrom.clear();\r\n            (hidePostsFromTA.value.toLowerCase().match(/\\w+/g) || []).forEach(u => settings.hidePostsFrom.add(u));\r\n        }\r\n        msg.send(\"saveSettings\", settings.toJSON());\r\n    });\r\n\r\n    checkUpdatesButton.addEventListener(\"click\", e => {\r\n        const btn = e.target;\r\n        btn.disabled = true;\r\n        msg.send(\"checkUpdates\").then(() => btn.disabled = false);\r\n    });\r\n\r\n    let isChanged = new Cell(false);\r\n    let initialState = new Map;\r\n    let currentState = () => {\r\n        let state = new Map;\r\n        forSelect(sPage, \"input, textarea\", input => {\r\n            state.set(input.id, (input.type === \"checkbox\") ? input.checked : input.value);\r\n        });\r\n        return state;\r\n    };\r\n    let updateInputs = () => {\r\n        checkBoxes.forEach(box => box.checked = settings.modules.get(box.id));\r\n        {\r\n            let s = \"\";\r\n            settings.hidePostsFrom.forEach(u => s += `, ${u}`);\r\n            hidePostsFromTA.value = s.substr(2);\r\n        }\r\n    };\r\n\r\n    msg.send(\"getSettings\").then(sData => {\r\n        settings = new Settings(sData, true);\r\n        updateInputs();\r\n\r\n        // Взаимосвязь между флагами\r\n        forSelect(sPage, \"[data-disabled-if]\", node => {\r\n            let k = node.dataset[\"disabledIf\"],\r\n                c = document.getElementById(k);\r\n            if (c) {\r\n                Cell.fromInput(c).onValue(checked => node.disabled = checked);\r\n            }\r\n        });\r\n\r\n        forSelect(sPage, \"[data-enabled-if]\", node => {\r\n            let k = node.dataset[\"enabledIf\"],\r\n                c = document.getElementById(k);\r\n            if (c) {\r\n                Cell.fromInput(c).onValue(checked => node.disabled = !checked);\r\n            }\r\n        });\r\n\r\n        initialState = currentState();\r\n\r\n        sPage.classList.remove(\"hidden\");\r\n        sPage.previousElementSibling.classList.add(\"hidden\");\r\n    });\r\n\r\n    let changeHandler = () => {\r\n        let st = currentState(), changed = false;\r\n        st.forEach((v, k) => changed = changed || (v !== initialState.get(k)));\r\n        isChanged.value = changed;\r\n    };\r\n\r\n    sPage.addEventListener(\"input\", changeHandler);\r\n    sPage.addEventListener(\"change\", changeHandler);\r\n\r\n    isChanged.distinct().onValue(s => saveButton.disabled = !s);\r\n}\r\n\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/settings.js\n **/","import forSelect from \"../utils/for-select\";\r\n\r\nexport const registeredModules = new Map(); // name → module\r\n\r\nclass Module {\r\n    constructor(name, enabledByDefault = true, alwaysEnabled = false) {\r\n        this.name = name;\r\n        this.alwaysEnabled = alwaysEnabled;\r\n        this.enabledByDefault = enabledByDefault;\r\n        this.requiredModules = [];\r\n        this._watchers = [];\r\n        this._initiators = [];\r\n    }\r\n\r\n    init(callback) {\r\n        this._initiators.push(callback);\r\n    }\r\n\r\n    watch(selector, callback) {\r\n        this._watchers.push({selector, callback});\r\n    }\r\n\r\n    required(name) {\r\n        this.requiredModules.push(name);\r\n    }\r\n\r\n    _initiate(settings) {\r\n        this._initiators.forEach(c => c(settings));\r\n        this._watchers.forEach(({selector, callback}) => forSelect(document.body, selector, n => callback(n, settings)));\r\n    }\r\n\r\n    _trigger(node) {\r\n        this._watchers.forEach(({selector, callback}) => forSelect(node, selector, n => callback(n, settings)));\r\n    }\r\n}\r\n\r\nexport function registerModule(name, enabledByDefault = true, alwaysEnabled = false) {\r\n    const m = new Module(name, enabledByDefault, alwaysEnabled);\r\n    registeredModules.set(name, m);\r\n    return m;\r\n}\r\n\r\nlet settings = null;\r\n/**\r\n *\r\n * @param {Settings} aSettings\r\n */\r\nexport function startObserver(aSettings) {\r\n    if (settings) {\r\n        return;\r\n    }\r\n    settings = aSettings;\r\n\r\n    registeredModules.forEach(m => {\r\n        if (settings.isModuleEnabled(m)) {\r\n            m._initiate(settings);\r\n        }\r\n    });\r\n\r\n    let observer = new MutationObserver(mutations => {\r\n        mutations.forEach(mutation => {\r\n            for (let i = 0, l = mutation.addedNodes.length; i < l; i++) {\r\n                let node = mutation.addedNodes[i];\r\n                if (node.nodeType == Node.ELEMENT_NODE) {\r\n                    registeredModules.forEach(m => {\r\n                        if (settings.isModuleEnabled(m)) {\r\n                            m._trigger(node, settings);\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    });\r\n\r\n    observer.observe(document.body, {childList: true, subtree: true});\r\n\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/base/modules.js\n **/","import matches from \"./matches\";\r\n\r\n/**\r\n * @param {Document|DocumentFragment|Element} node\r\n * @param {string} selector\r\n * @param {function(Node)} [foo]\r\n */\r\nexport default (node, selector, foo) => {\r\n    if (node === null) return [];\r\n    var nodeList = node.querySelectorAll(selector);\r\n    var nodes = nodeList ? Array.prototype.slice.call(nodeList) : [];\r\n    if (matches(node, selector)) nodes.unshift(node);\r\n    if (foo) {\r\n        for (var i = 0, l = nodes.length; i < l; i++) {\r\n            foo(nodes[i]);\r\n        }\r\n    }\r\n    return nodes;\r\n};\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/for-select.js\n **/","const matchesMethod = (\"matches\" in HTMLElement.prototype) ? \"matches\" : \"msMatchesSelector\";\r\n\r\n/**\r\n *\r\n * @param {HTMLElement} node\r\n * @param {String} selector\r\n * @return {Boolean}\r\n */\r\nexport default function (node, selector) { return node[matchesMethod](selector); }\r\n\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/matches.js\n **/","/**\r\n * @param {string} s\r\n * @return {string}\r\n */\r\nexport default function (s = \"\") {\r\n    return s.replace(/&/g, \"&amp;\")\r\n        .replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\")\r\n        .replace(/\"/g, \"&quot;\").replace(/'/g, \"&#x27;\");\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/escape-html.js\n **/","import {registeredModules} from \"./modules\";\r\n\r\nexport default class Settings {\r\n\r\n    constructor(o = null, trustedData = false) {\r\n        this.modules = new Map;\r\n        registeredModules.forEach(m => {\r\n            if (!m.alwaysEnabled) {\r\n                this.modules.set(m.name, m.enabledByDefault);\r\n            }\r\n        });\r\n\r\n        this.hidePostsFrom = new Set;\r\n        this.hideAliens = false;\r\n\r\n        // инициализация из объекта\r\n        if (o) {\r\n            (o.modules || []).forEach(([k, v]) => {\r\n                if (trustedData || this.modules.has(k)) {\r\n                    this.modules.set(k, !!v);\r\n                }\r\n            });\r\n            (o.hidePostsFrom || []).forEach(u => this.hidePostsFrom.add(u));\r\n            this.hideAliens = !!o.hideAliens;\r\n        }\r\n    }\r\n\r\n    toJSON() {\r\n        const o = {modules: [], hidePostsFrom: []};\r\n        this.modules.forEach((v, k) => o.modules.push([k, v]));\r\n        this.hidePostsFrom.forEach(u => o.hidePostsFrom.push(u));\r\n        o.hideAliens = this.hideAliens;\r\n        return o;\r\n    }\r\n\r\n    /**\r\n     * @param {Module} m\r\n     * @return {boolean}\r\n     */\r\n    isModuleEnabled(m) {\r\n        return (\r\n            (m.alwaysEnabled || !this.modules.has(m.name) && m.enabledByDefault || this.modules.get(m.name))\r\n            && !m.requiredModules.map(name => registeredModules.get(name)).some(m => !this.isModuleEnabled(m))\r\n        );\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/base/settings.js\n **/","let nextRequestId = 1;\r\n\r\nconst responseAction = \"@response\";\r\n\r\nexport default class Messenger {\r\n\r\n    constructor(parentWindow = null, parentOrigin = \"\") {\r\n        this.__responders = new Map();\r\n        this.__listeners = new Map();\r\n\r\n        this.defaultWindow = parentWindow;\r\n        this.defaultOrigin = parentOrigin;\r\n\r\n        window.addEventListener('message', event => {\r\n            if (typeof event.data !== \"object\") {\r\n                return;\r\n            }\r\n            //noinspection UnnecessaryLocalVariableJS\r\n            const {data:{action, requestId, value}, source, origin} = event;\r\n\r\n            if (action === responseAction && this.__responders.has(requestId)) {\r\n                this.__responders.get(requestId)(value);\r\n                this.__responders.delete(requestId);\r\n\r\n            } else if (this.__listeners.has(action)) {\r\n                let resp = this.__listeners.get(action)(value);\r\n                source.postMessage({action: responseAction, requestId, value: resp}, origin);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} action\r\n     * @param {*} value\r\n     * @return {Promise}\r\n     */\r\n    send(action, value = null) {\r\n        return this.sendEx(this.defaultWindow, this.defaultOrigin, action, value);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {Window} window\r\n     * @param {String} origin\r\n     * @param {String} action\r\n     * @param {*} value\r\n     * @return {Promise}\r\n     */\r\n    sendEx(window, origin, action, value = null) {\r\n        return new Promise(resolve => {\r\n            const requestId = nextRequestId++;\r\n            this.__responders.set(requestId, resolve);\r\n            window.postMessage({action, requestId, value}, origin);\r\n        });\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param {String} action\r\n     * @param {function} callback\r\n     */\r\n    on(action, callback) {\r\n        this.__listeners.set(action, callback);\r\n    }\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/message-rpc.js\n **/","export default class Cell {\r\n\r\n    constructor(value) {\r\n        this._value = value;\r\n        this._listeners = new Set();\r\n    }\r\n\r\n    get value() { return this._value; }\r\n\r\n    set value(v) {\r\n        this._value = v;\r\n        this.poke();\r\n    }\r\n\r\n    poke() {\r\n        this._listeners.forEach(l => l(this._value));\r\n    }\r\n\r\n    onValue(lst) {\r\n        this._listeners.add(lst);\r\n        lst(this.value);\r\n        return this;\r\n    }\r\n\r\n    unListen(lst) {\r\n        this._listeners.delete(lst);\r\n        return this;\r\n    }\r\n\r\n    /**\r\n     * @param {function(Cell, *)} foo\r\n     * @param {*} [initial]\r\n     * @return {Cell}\r\n     */\r\n    derive(foo, initial) {\r\n        var c = new Cell(initial);\r\n        this.onValue(v => foo(c, v));\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * @param {Array.<Cell>} cells\r\n     * @return {Cell}\r\n     */\r\n    static combine(...cells) {\r\n        const cell = new Cell(cells.map(c => c.value));\r\n        cells.forEach((c, i) => c.onValue(v => {\r\n            let vv = cell.value;\r\n            vv[i] = v;\r\n            cell.value = vv;\r\n        }));\r\n        return cell;\r\n    }\r\n\r\n    map(foo) { return this.derive((c, v) => c.value = foo(v)); }\r\n\r\n    filter(foo) { return this.derive((c, v) => foo(v) && (c.value = v)); }\r\n\r\n    throttle(duration) {\r\n        let val = undefined,\r\n            timer = null;\r\n\r\n        return this.derive((c, v) => {\r\n            val = v;\r\n            if (!timer) {\r\n                timer = setTimeout(() => {\r\n                    if (val !== undefined) {\r\n                        c.value = this.value;\r\n                        val = undefined;\r\n                    }\r\n                    timer = null;\r\n                }, duration);\r\n            }\r\n        }, this.value);\r\n    }\r\n\r\n    /**\r\n     * For cell with Promise's values\r\n     * @param {*} [initial]\r\n     * @return {Cell}\r\n     */\r\n    latestPromise(initial) {\r\n        var lastProm = null;\r\n        return this.derive((c, v) => {\r\n            let prom = v;\r\n            lastProm = prom;\r\n            prom.then(res => {\r\n                if (prom === lastProm) {\r\n                    c.value = res;\r\n                }\r\n            });\r\n        }, initial);\r\n    }\r\n\r\n    distinct() {\r\n        var val;\r\n        return this.derive((c, v) => {\r\n            if (v !== val) {\r\n                val = v;\r\n                c.value = v;\r\n            }\r\n        });\r\n    }\r\n\r\n    static fromInput(input, eventNames, property) {\r\n        if (!input || !(input instanceof HTMLInputElement || input instanceof HTMLTextAreaElement || input instanceof HTMLSelectElement)) {\r\n            return new Cell(null);\r\n        }\r\n\r\n        var defaultProperty = \"value\";\r\n        if (input instanceof HTMLInputElement && (input.type === \"checkbox\" || input.type === \"radio\")) {\r\n            defaultProperty = \"checked\";\r\n        }\r\n\r\n        var events = eventNames ? eventNames.split(\" \") : [\"input\", \"change\"];\r\n        property = property || defaultProperty;\r\n\r\n        var getVal = () => (property === \"self\") ? input : input[property];\r\n\r\n        var cell = new Cell(getVal());\r\n        events.forEach(event => input.addEventListener(event, () => cell.value = getVal()));\r\n        return cell;\r\n    }\r\n\r\n    static ticker(timeout) {\r\n        let ticker = new Cell(true);\r\n        setInterval(() => ticker.value = true, timeout);\r\n        return ticker;\r\n    }\r\n\r\n}\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/utils/cell.js\n **/"],"sourceRoot":""}